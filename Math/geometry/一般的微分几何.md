# 速查

## 切空间和协变矢量

起初我们只有一个$d$维流形上的坐标系$\{x^i\}$，其上每一点自然地有一个$d$维向量空间，称为**切空间**。
向量空间中的成员是所谓**协变矢量**。
某一点上的某个协变矢量一定可以看成通过这一点的某条曲线的切矢量，反之，通过某一点的某条曲线的切矢量一定是这一点上的一个协变矢量，因此有“切空间”这个名字。

协变矢量形如$\boldsymbol{v} = v^i \boldsymbol{e}_i$，其中$\boldsymbol{e}_i$可以使用$\partial_i = \frac{\partial}{\partial x^i}$表示。
这种从坐标直接得到的基底称为**协变基**。这里的直觉是，每一个协变矢量实际上对应沿着这个协变矢量的方向导数算符。
不同点上的$\boldsymbol{e}_i$不同，构成一个矢量场。
分量可以通过
$$
v^i = \boldsymbol{v}(x^i)
$$
得到。

通过这种方式定义的协变基不是归一化的。

## 余切空间和逆变矢量

设$V$是向量空间，则全体函数$V \to \reals$记作$V^*$，为所谓**对偶空间**。$V^{**} \simeq V$。
这就意味着
$$
(V^{*} \to \reals) \simeq V, \quad (V \to \reals) \simeq V^*.
$$
此外$V$和$V^*$维数相同。

在每一点可以定义切空间的对偶空间。我们只需要构造$\boldsymbol{e}_i$的对偶矢量场即可。
定义
$$
\mathrm{d}f|_{p} (\boldsymbol{v}) = \boldsymbol{v} (f), \quad \boldsymbol{v} \in V_{p},
$$
就得到这样的一个对偶矢量场。可以得到
$$
\mathrm{d}x^i (\partial_j) = \delta^i_j,
$$
我们于是将$\{\mathrm{d} x^i |_{p} \}$看成某一点$p$的切空间的对偶空间（称为**余切空间**）的基底，并且将“逆变矢量和协变矢量的点乘”定义为将逆变矢量作用在协变矢量上，最后得到的结果一定是实数。
到现在为止我们还没有引入任何内积结构，因为没有办法将逆变矢量转化为协变矢量或者相反；因此以上“点乘”更好的说法是缩并。

准确地说，这里的$\mathrm{d}f$和通常的“小增量”之间还是有区别的，因为需要把小增量出现时坐标的变化传给$\mathrm{d}f$之后才能够得到$\Delta f$，即
$$
\begin{aligned}
    \mathrm{d}f|_{p} (\Delta p) &= \Delta p (f)|_{p} \\
    &= (\Delta p)^\mu \partial_\mu f |_{p} \\
    &= f(p+\Delta p) - f(p).
\end{aligned}
$$
我们应该注意$\mathrm{d}f$是矢量这一事实：向它输入不同的方向它会给出不同的结果。因此，如果我们（容易引起混淆，但是非常方便）地设$\mathrm{d} p$为以坐标的小变化为分量的协变矢量，$\mathrm{d} f$为$f$的小变化，那么就有乍一看非常奇怪的等式：
$$
\mathrm{d}f|_p (\mathrm{d} p) = \mathrm{d} f.
$$

$$
\mathrm{d}f|_p = (\partial_\mu f)|_p \  \mathrm{d} x^\mu |_p.
$$
这可以看成$\mathrm{d} f = \nabla f \cdot \mathrm{d} \boldsymbol{x}$的微分几何版本。

## 一般的张量

一个$(k, l)$型张量$T$是一个线性映射
$$
T: \underbrace{V^* \times \cdots \times V^*}_{k} \times \underbrace{V \times \cdots \times V}_{l} \to \reals,
$$
有$k$个协变指标和$l$个逆变指标。

通过指标记号可以很好地理解各种同构关系：例如，张量可以看成协变矢量到协变矢量的线性变换，也可以理解成逆变矢量到逆变矢量的线性变换，也可以理解成协变矢量-逆变矢量对到实数的线性变换。

判断张量是否对称时，两个指标应该同时是上标或者同时是下标，或者用$T_{\rho}^{\ \ \mu} = T^\mu_{\ \ \rho}$。

可以使用所谓**抽象指标**记号。之后将用$a, b, c$表示抽象指标，希腊字母和$i, j, k$表示具体指标。
在同时有抽象指标和具体指标时抽象指标写在外面，如$(v^\mu)^a$表示有一组用具体指标$\mu$标记的数$\{v^\mu\}$，抽象指标$a$表示这组数是协变矢量的分量。
需要注意的是不是所有时候具体指标和抽象指标都同时是指标或者同时是脚标。例如，$x^\mu$给出了一条曲线，其上就可以定义切矢量$\partial_\mu$，而切矢量是协变矢量。
那么，我们就要写出看起来非常奇怪的$(\partial_\mu)^a$。
这实际上没有造成任何矛盾，因为设$T^a = (\partial_\mu)^a$，则$T^\nu = \delta_\mu^\nu$，即$a$是上标意味着$T$的分量的具体指标是上标。
在缩并时具体指标和抽象指标的位置是一样的。

关于$\partial_\mu$还需要一些额外的注记。它可以用于表示协变矢量空间的基底，此时记作$(\partial_\mu)^a$。
我们也可以
看起来这很奇怪：我们就是用$\partial_\mu$定义协变空间的，为什么用$\partial_\mu$表示协变空间基底时记号比用$\partial_a$表示（是逆变矢量的）求导算符还要复杂？原因就在于“协变空间基底”是坐标系相关的概念，而求导算符则容易推广为一般的$\nabla_a$。

表示实际的$\partial_\mu(\ldots)$之类的计算的时候通常都需要具体指标。
带有抽象指标的对象写在一起表示张量积，不会真的作用到一个标量场上而给出其导数。
例如，$v^a u_b$并不代表$v^\mu \partial_\mu ( u_\nu \mathrm{d} x^\nu (\text{some scalar}) )$。
但是$\partial_a$确实会作用在它后面的表达式上。
除此以外，代表张量的字母带着自己的指标可以交换。

## 度规

引入度规之后指标升降规则和坐标变换规则成立。

实际上一个逆变矢量升指标之后得到的是新的一个协变矢量，它和原来的逆变矢量都不在一个矢量空间中。只有在特殊的空间——比如说欧氏空间——中我们才能够不区分这两者。

$$
\langle e_\mu, e_\nu \rangle = g_{\mu \nu}.
$$

## 联络

到现在为止我们还不能计算矢量场的导数，因为不同点的切空间里面的矢量可以毫无关系，所以要引入某种方法把一点的矢量平移到另外一点，即需要引入一个**联络**。
引入一个导数算符就得到了一个这样的联络。
所谓的**导数算符**$\nabla$是指满足线性性、莱布尼茨律、和缩并可以交换（这点很重要，否则抽象指标记号就没有意义了，因为如果我们看到一上一下的一对指标只能确认“它们缩并了”，但并不确定是求导数之前缩并了还是求完导数之后缩并了）、对标量场满足$\partial_a f = \nabla_a f$（这是正确的，因为标量场不存在“没法平移”的问题；此外请注意导数算符作用在标量场上会得到一个逆变矢量）的算符。

导数算符是**无挠的**，当且仅当，$\nabla_a \nabla_b f = \nabla_b \nabla_a f$，其中$f$是任意矢量场。
一个导数算符是无挠的，当且仅当对任意矢量场$f$，$\nabla \nabla f$是对称的(0, 2)型张量。
大部分物理中会用到的导数算符都是无挠的。

当然，很容易看出，$\partial_a$就是一个导数算符，它定义为
$$
\partial_a = (\mathrm{d} x^\mu)_a \partial_\mu 
$$

然后对标量场实际上就有$\nabla_a f = (\mathrm{d} f)_a$。

### 导数算符和克氏符

设$\omega_b, \omega_b'$是两个逆变矢量场，它们在$p$点的值是一样的。则可以证明，设有两个导数算符$\nabla_a$和$\nabla'_a$，有
$$
((\nabla_a - \nabla'_a) \omega_b)|_p = ((\nabla_a - \nabla'_a) \omega'_b)|_p,
$$
因此$((\nabla_a - \nabla'_a) \omega_b)|_p$仅仅由$\omega_b$在$p$点的值确定，而这两者之间的关系当然是线性的，那么就存在张量场$C^c_{\ \ ab}$使得
$$
\nabla_a \omega_b = \tilde{\nabla}_a \omega_b - \omega_c C^c_{\ \ ab}.
$$
对无挠导数算符，
$$
C^c_{\ \ ab} = C^c_{\ \ ba}.
$$

任何两个导数算符之间都可以定义$C^c_{\ \ ab}$；另一方面，得到了一个导数算符和$C^c_{\ \ ab}$之后，其实也就得到了另一个导数算符。
这是因为我们有公式
$$
\begin{aligned}
    \nabla_a T^{b_1 \cdots b_k}_{\qquad c_1 \cdots c_l} &= \tilde{\nabla}_a T^{b_1 \cdots b_k}_{\qquad c_1 \cdots c_l} \\
    &+ \sum_i C^{b_i}_{\ \ ad} T^{b_1 \cdots d \cdots b_k}_{\qquad \quad c_1 \cdots c_l} \\
    &- \sum_j C^{d}_{\ \ ac_j} T^{b_1 \cdots b_k}_{\qquad c_1 \cdots d \cdots c_l},
\end{aligned}
$$
于是，给定一个导数算符，只需要通过定义$C^c_{\ \ ab}$就可以得到所有的导数算符。
最自然的选择是
$$
\begin{aligned}
    \nabla_a T^{b_1 \cdots b_k}_{\qquad c_1 \cdots c_l} &= \partial_a T^{b_1 \cdots b_k}_{\qquad c_1 \cdots c_l} \\
    &+ \sum_i \Gamma^{b_i}_{\ \ ad} T^{b_1 \cdots d \cdots b_k}_{\qquad \quad c_1 \cdots c_l} \\
    &- \sum_j \Gamma^{d}_{\ \ ac_j} T^{b_1 \cdots b_k}_{\qquad c_1 \cdots d \cdots c_l},
\end{aligned}
$$
其中$\Gamma^c_{\ \ ab}$称为**克氏符**。特别的，有
$$
\nabla_b v^a = \partial_b v^a + \Gamma^a_{\ \ bc} v^c, \quad \nabla_b v_a = \partial_b v_a - \Gamma^c_{\ \ b a} v_c.
$$

需要注意的是，虽然以上推导中$C^c_{\ \ ab}$——从而$\Gamma^c_{\ \ ab}$——是通过两个量之间的线性变换定义的，即它们是张量，$\Gamma^c_{\ \ ab}$并不服从张量分量的坐标变换关系。
这是因为$C^c_{\ \ ab}$和$\Gamma^c_{\ \ ab}$实际上是*坐标系相关的张量*。
如果我们将张量看成一种线性变换，$C^c_{\ \ ab}$和$\Gamma^c_{\ \ ab}$就是张量，但是是坐标系相关的张量；如果我们将张量看成某种坐标系无关的抽象实体，那么$C^c_{\ \ ab}$和$\Gamma^c_{\ \ ab}$就不是张量。

### 矢量平移

设$C(t)$是一个曲线，$v^a$是定义在其上的矢量场。设流形上有坐标$x^{\mu}$。沿着曲线当然有导数$\partial_t$，由于它对应协变矢量，记它为$T^a=(\partial_t)^a$。

我们有
$$
T^b \nabla_b v^a = (\partial_\mu)^a \left( \partial_t v^\mu + \Gamma^\mu_{\ \ \nu \sigma} T^\nu v^\sigma \right).
$$
注意$(\partial_\mu)^a$并没有作用到它后面的式子上；它放在这里是充当协变基的。
$v^\alpha$是一个矢量**平移而成的**，当且仅当$T^b \nabla_b v^a=0$，其中$T^b$是$C(t)$的切矢量，也即
$$
\partial_t v^\mu + \Gamma^\mu_{\ \ \nu \sigma} T^\nu v^\sigma,
$$
或者，等价地说，$v^a$沿着$T^b$的导数始终为零。
实际上$v^a$沿着$T^b$的导数就是沿着$C(t)$将$v^a(t+\Delta t)$平移到$t$处，得到$v'^a$，两者作差除以$\Delta t$的结果，即
$$
T^b \nabla_b v^a = \lim_{\Delta t \to 0} \frac{v'^a - v^a}{\Delta t}.
$$
非常合理的，只需要一条曲线和其上任意一点的一个矢量，就可以定义一个由一个矢量平移而成的矢量场。
在两点之间画出不同曲线，将同一个矢量从一点平移到另一点，得到的结果可能不同。

在定义了度规的情况下，如果要求两个矢量平移时内积不变，则有$\nabla_a g_{bc}=0$。
给定一个度规，满足这个条件的导数算符是唯一的，称为**和度规适配的导数算符**。
在给定度规之后，可以用下面的克氏符
$$
\Gamma^\sigma_{\ \ \mu \nu} = \frac{1}{2} g^{\sigma \rho} (\partial_\nu g_{\rho \mu} + \partial_\mu g_{\nu \rho} - \partial_\rho g_{\mu \nu})
$$
计算出正确的导数算符$\nabla_a$，它是不依赖于坐标系的。
我们有以下坐标变换公式
$$
\Gamma ^{\prime\tau }_{\mu \gamma }=\Gamma ^{\rho }_{\alpha \sigma }\frac{\partial x^{\alpha }}{\partial x^{\prime\mu }} \frac{\partial x^{\sigma }}{\partial x^{\prime\gamma }}\frac{\partial x^{\prime\tau }}{\partial x^{\rho }} +\frac{\partial^{2} x^{\rho }}{\partial x^{\prime\mu }x^{\prime\gamma }} \frac{\partial x^{\prime\tau }}{\partial x^{\rho }},
$$
容易看出克氏符的确不是张量，或者说是坐标系依赖的张量。

### 测地线

切矢量满足
$$
T^b \nabla_b T^a = 0
$$
的曲线称为**测地线**。于是就有
$$
\partial_t^2 x^\mu + \Gamma^\mu_{\ \ \nu \sigma} \partial_t x^\nu \partial_t x^\sigma = 0.
$$
将测地线重参数化之后有
$$
T^b \nabla_b T^a = \alpha(t') T^a.
$$
如果一条曲线满足以上方程，将它重参数化，设原本的参数为$t'$，重参数化之后的参数为$t$，要求
$$
\alpha = - \left( \frac{\mathrm{d} t}{\mathrm{d} t'} \right)^2 \frac{\mathrm{d}^2 t'}{\mathrm{d} t^2}
$$
即可。$t$称为**仿射参数**。每个测地线的参数都是仿射参数。所有的仿射参数之间差一个$t' = at +b$的函数。

知道起点、终点坐标和终点切矢量就足以确定一条测地线。

测地线是局部最短的，但是全局未必最短；实际上可以根本没有全局最短曲线。

### 内蕴曲率

$$
(\nabla_a \nabla_b - \nabla_b \nabla_a) \omega_c = R_{abc}^{\quad d} \omega_c
$$
定义了**黎曼曲率张量**$R_{abc}^{\quad d}$，其性质包括
- 交换$a,b$差一个负号
- 将$abc$对称化后为零
- $R_{[abc]}^{\quad d} = 0$
- $\nabla_{[a} R_{bc]d}^{\quad e} = 0$，即所谓**比安基恒等式**
- 在有度规的情况下，$R_{abcd} = - R_{abdc}$
- 同上，$R_{abcd} = R_{cdab}$

导数算符不对易（即$R_{abc}^{\quad d}$不为零）、平移和曲线有关、存在初始平行后来不平行的测地线、度规张量的分量不是常数是等价的说法。
此时我们说空间是弯曲的。

### 一些具体计算

$$
\Gamma^\mu_{\ \ \mu \sigma} = \frac{1}{\sqrt{|g|}} \partial_{\sigma} \sqrt{|g|}
$$
其中$g$为$g_{\mu \nu}$的行列式。则
$$
\nabla_a v^a = \frac{1}{\sqrt{|g|}} \partial_\sigma (\sqrt{|g|} v^\sigma).
$$

## 微分形式、体积元、积分

$l$次**微分形式**是一个$(0, l)$张量场，当且仅当将它反对称化之后和没反对称化完全一样；或者说它就是反对称的。

定义$\wedge$为
$$
(\omega \wedge \mu)_{a_1 \cdots a_l b_1 \cdots b_m} = \frac{(l+m)!}{l! m!} \omega_{[a_1 \cdots a_l} \mu_{b_1 \cdots b_m]},
$$
于是
$$
\omega \wedge \mu = (-1)^{l m} \mu \wedge \omega.
$$
$$
(\mathrm{d} \omega)_{b a_1 \cdots a_l} = (l+1) \nabla_{[b} \omega_{a_1 \cdots a_l ]}
$$
$$
\mathrm{d}(\omega \wedge \mu) = \mathrm{d} \omega \wedge \mu + (-1)^{l} \omega \wedge \mathrm{d} \mu.
$$
这里的$\mathrm{d}$其实是一种新定义出来的“微分”，称为**外微分**。但是这种外微分作用在$x^\mu$之类的东西上面得到的就是通常的微分形式。

与度规匹配的体元$\epsilon_{a_1 \cdots a_n}$服从条件：
$$
\epsilon_{a_1 \cdots a_n} \epsilon^{a_1 \cdots a_n} = (-1)^s n!,
$$
其中$s$是度规的标准型中负的元素的个数。

右手度规：
$$
\epsilon_{a_1 \cdots a_n} = \sqrt{|g|} (e^1)_{a_1} \wedge \cdots \wedge (e^n)_{a_n}, \quad \epsilon^{a_1 \cdots a_n} = \frac{1}{\sqrt{|g|}} (e_1)^{a_1} \wedge \cdots \wedge (e_n)^{a_n}
$$

由于体积元的反对称性可以尝试用它定义旋度：
$$
\epsilon^{a_1 a_2 \cdots a_n} \nabla_{a_1} T_{a_1 \cdots}
$$

TODO：关于恰当微分形式什么的，似乎从$\nabla \times \boldsymbol{A}=0$得到$\boldsymbol{A} = \nabla \phi$也是类似的。另外这个结论成立的前提是空间中不能有洞。直观地看，这是因为洞中可以有“载荷”使得全局地看$\nabla \times \boldsymbol{A}$并非处处为零；如果强行定义一个$\phi$，会发现$\phi$是多值的。似乎这个还和什么上同调有关系。