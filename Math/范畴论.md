# 定义

虽然范畴论是抽象代数中提炼出来的概念，它实际上可以被当成一个独立的数学基础，诸如“$a$是$A$的成员”这种集合论概念实际上也可以只使用范畴论的语言定义出来。
我们不走得那么远，姑且在加入了排中律的归纳构造演算的框架下讨论范畴论。
这主要是因为范畴论作为数学基础的地位仍然受到很多质疑。范畴论的定义是“结构性”的，描述object和morphism的相互关系，而不是“断言性”的，断言什么存在什么不存在。
一个好的数学基础应该能够适当地编码各种结构，来保证它们的存在性，但是似乎很难在不引入集合的概念的情况下在范畴论中引入可以判断什么存在什么不存在的公理，那么我们甚至无法确定我们构造出来的范畴真的存在。

记$T$是一个$u$阶类型，`category T`定义为这样的一个结构：它的成员包括

- `Hom : T -> T -> Type v`
- `id : \Pi x : T, Hom T T`
- 

$\mathrm{Ob}(\mathcal{C})$给出$T$对应的集合（这里的“集合”一词的意义是构造演算中的类型对应的可以做并、交、差的那种结构，包括但不限于ZFC定义的集合；很多时候——如在讨论所谓“集合范畴”，即以集合为对象以映射为态射的范畴时——$\mathrm{Ob}(\mathcal{C})$对于一般的集合论来说是太“大”了，它们也许更加应该称为class而不是set），其中的诸元素称为**对象**；设$A, B$是两个对象，$\mathrm{Hom}_{\mathcal{C}}(A, B)$（或者有时$\mathrm{Mor}_{\mathcal{C}}(A, B)$，虽然本文用$\mathrm{Mor}(\mathcal{C})$表示范畴$\mathcal{C}$中的所有态射）给出`Hom(A, B)`对应的集合，其中的诸元素称为**态射**。
一般$\mathcal{C}$是$\mathrm{Hom}_{\mathcal{C}}(A, B)$的隐藏参数，通常从上下文推断出来。
通常，除非$A=A'$，$B=B'$，我们认为$\mathrm{Hom}(A, B)$和$\mathrm{Hom}(A', B')$不相交。实际上，如果它们相交，我们总是可以将$A$和$B$的信息添加到每个态射上，从而让$\mathrm{Hom}(A, B)$和$\mathrm{Hom}(A', B')$不相交。
若$f \in \mathrm{Hom}(A, B)$，设$\mathrm{src}(f) = A$，$\mathrm{tar}(f) = B$。

$\mathrm{id}_A$为$A$到其自身的单位元态射。单位元——满足$i \circ f = f, f \circ i = f$的$i$——是唯一的。

`category T`的阶数为$\max(u, v + 1)$。一个范畴是**small**的当且仅当对象和态射在同一阶宇宙中；否则这个范畴就是**large**的。
范畴大小的概念可以进一步细化，如指出他们在哪个宇宙上。

范畴可以容易地画成图：对象就是点，态射就是线。作为一个例子，我们有所谓**集合范畴**Set，其中每个对象看成一个集合而将态射看成集合之间的映射。
但是需要注意的是态射也可以不是映射：如我们也可以建立另一个范畴，其中对象是集合，但是从$A$到$B$的态射未必在$A$的每一个成员上都有定义。只需要满足结合律、单位元存在等性质，就可以。

# 态射

## 态射和等价关系

- retraction: 有右逆的态射，即设$f:X \to Y$，当且仅当$\exists g : Y \to X, f \circ g = \mathrm{id}_Y$时$f$是retraction；也可以说，retraction是某个态射的左逆；又称split epimorphism
- section: 有左逆的态射，即设$f:X \to Y$，当且仅当$\exists g : Y \to X, g \circ f = \mathrm{id}_X$时$f$是section；也可以说，section是某个态射的右逆；又称split monomorphism
- isomorphism: 同时有左逆和右逆的态射，即同时是retraction和section的态射
- monomorphism: 可以左消去的态射，单射的范畴论推广；section都是monomorphism，但是反之不然；原因也是很明显的，因为对范畴$\mathcal{C}$中的section$f$，我们总是可以将它的左逆从态射中移除，同时移除一些别的态射来保证移除后仍然可以得到一个范畴，在新范畴中$\mathcal{C}'$中$f$仍然是一个monomorphism（因为新范畴中的态射只是原范畴的一个子集，既然$f$在$\mathrm{Mor}(\mathcal{C})$中是可以左消去的，它在$\mathrm{Mor}(\mathcal{C}')$中当然也是可以左消去的），但是已经没有左逆了
- epimorphism: 可以右消去的态射，满射的范畴论推广；retraction都是epimorphism，但是反之不然，原因同上
- bimorphism: 同时是monomorphism和epimorphism的态射；一个isomorphism一定是bimorphism，但是反之不然，原因同样是“逆总是可以被移除”。一个bimorphism$f$不是isomorphism意味着$f$没有保持在$\mathcal{C}$中我们希望保留的结构，即$f$可能的逆出于某些原因，不能出现在$\mathcal{C}$中。在$\mathcal{C}$中的态射太少（bimorphism的逆被直接排除在$\mathcal{C}$外了）或者太多（新加入的biomorphism找不到逆）时都会出现bimorphism不是isomorphism的现象，因此如果每个bimorphism都是isomorphism，这意味着$\mathcal{C}$中的态射不多也不少，此时我们称$\mathcal{C}$为**平衡范畴**

我们很少真的去讨论两个对象是不是相等，但是我们的确有时会讨论$\mathrm{Hom}(X, Y)$中的两个态射是不是相等。
虽然等价关系是抽象代数中占据支配地位的概念，“相等”还是有必要出现的，因为有时我们需要讨论唯一性。
实际上这暗示了一点，就是范畴论中我们实际上根本没法具体地讨论对象的内部结构，从而也无法比较两个对象，等等；我们能够具体操作的其实是态射。

## “元素”

从0-object到各个object的态射给出了各个object的“内容”。乍一看这会产生疑难，因为没有什么规定态射一定是集合到集合的映射，那么我们将所有态射的箭头方向反过来，似乎也可以定义各个object的“内容”；但是实际上这并没有产生疑难，因为将态射箭头反过来这个操作要有意义通常是在做范畴的对偶，那么此时的0-object已经变成了1-object。

# 高阶性质

## 函子

**协变函子 functor**$F:\mathcal{C} \to \mathcal{C}'$是这样一个结构，它包含：

- 从$\mathrm{Ob}(\mathcal{C})$到$\mathrm{Ob}(\mathcal{C}')$的映射$F_{\mathcal{C}}^\text{ob}$，设$X \in \mathrm{Ob}(\mathcal{C})$，将$F_{\mathcal{C}}^\text{ob}(\mathcal{C})$简记为$F(X)$
- 对$X, Y \in \mathrm{Ob}(\mathcal{C})$，从$\mathrm{Hom}(X, Y)$到$\mathrm{Hom}(F_{\mathcal{C}}^\text{ob}(X), F_{\mathcal{C}}^\text{ob}(Y))$的一个映射$F^\text{mor}_{\mathcal{C}, X, Y}$；设$f$是一个态射，$F^\text{mor}_{\mathcal{C}, X, Y}(f)$简记为$F(f)$
- 保持单位元不变，即$F(\mathrm{id}_X) = \mathrm{id}_{F(X)}$
- 保持态射结构，即$F(g \circ f) = F(g) \circ F(f)$

“协变”的名称很好理解：函子没有改变态射的方向。有时有些从范畴到范畴的映射将态射的方向全部反过来了，此时的函子称为**逆变函子**。

函子作用下，一个交换图被映射为另一个交换图，一个isomorphism被映射为另一个isomorphism。

最简单的协变函子是$\mathrm{Id}$，它将一个范畴映射到其自身。最简单的逆变函子是**对偶运算**，记作$\mathcal{C}^\text{op}$，它保持所有对象不变，但是将所有函子的方向反过来，即：

$$
\mathrm{Ob}(\mathcal{C}^\text{op}) = \mathrm{Ob}(\mathrm{C}), \quad (f \circ g)^\text{op} = g^\text{op} \circ f^\text{op}.
$$
很容易看出，如果将一个范畴论定理中所有的东西——范畴，对象，态射——都换成其对偶，那么得到的命题仍然成立。
$\mathcal{C} \to \mathcal{D}$的逆变函子就是$\mathcal{C}^\text{op} \to \mathcal{D}$的协变函子；一个范畴的对偶的对偶就是它本身。

函子$F:\mathcal{C} \to \mathcal{D}$是**满函子**，当且仅达对任意$X, Y \in \mathrm{Ob}(\mathcal{C})$，$F^\text{mor}_{\mathcal{C}, X, Y}$是满射。
满函子不会向$\mathcal{D}$中加入任何新的结构，但是可能破坏$\mathcal{C}$中已有的结构。
反之，函子$F:\mathcal{C} \to \mathcal{D}$是**忠实函子**，当且仅达对任意$X, Y \in \mathrm{Ob}(\mathcal{C})$，$F^\text{mor}_{\mathcal{C}, X, Y}$是单射，忠实函子将$\mathcal{C}$中用$\mathcal{D}$中的对象能够表示的全部的结构保留到了$\mathcal{D}$中，但是可能增加新的结构。
既满又忠实的函子就是**全忠实函子**。

## 自然变换

## 高阶范畴

可以看到范畴和高阶范畴具有一系列特征：

- 结合律始终成立，从而“沿着态射从一个点走到另一个点”的图像总是适用的
- 分层，即用自然数标记一个范畴的等级来避免罗素悖论
- 对象总是放在范畴中讨论的，很少讨论不同范畴中的对象是否相等

另一方面，现代的**类型论**通常是

- 无副作用，自然演绎风格
- 分层，即使用自然数标记类型宇宙来避免罗素悖论
- term总是有类型标签的

于是可以看到范畴论是类型论的语义。

