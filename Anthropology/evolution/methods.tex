\documentclass[hyperref, UTF8, a4paper, oneside]{ctexart}

\usepackage{geometry}
\usepackage{titling}
\usepackage{titlesec}
\usepackage{paralist}
\usepackage{footnote}
\usepackage{enumerate}
\usepackage{autobreak}
\usepackage{amsmath, amssymb, amsthm}
\usepackage{mathtools}
\usepackage{bbm}
\usepackage{cite}
\usepackage{graphicx}
\usepackage{subcaption}
\usepackage{physics}
\usepackage{siunitx}
\usepackage{tikz}
\usepackage[compat=1.1.0]{tikz-feynhand}
\usepackage[ruled, vlined, linesnumbered, noend]{algorithm2e}
\usepackage[colorlinks, linkcolor=black, anchorcolor=black, citecolor=black]{hyperref}
\usepackage[most]{tcolorbox}
\usepackage{caption}
\usepackage{prettyref}

\geometry{left=3.18cm,right=3.18cm,top=2.54cm,bottom=2.54cm}
\titlespacing{\paragraph}{0pt}{1pt}{10pt}[20pt]
\setlength{\droptitle}{-5em}
\preauthor{\vspace{-10pt}\begin{center}}
\postauthor{\par\end{center}}

\DeclareMathOperator{\timeorder}{\mathcal{T}}
\DeclareMathOperator{\diag}{diag}
\DeclareMathOperator{\legpoly}{P}
\DeclareMathOperator{\primevalue}{P}
\DeclareMathOperator{\sgn}{sgn}
\newcommand*{\ii}{\mathrm{i}}
\newcommand*{\ee}{\mathrm{e}}
\newcommand*{\const}{\mathrm{const}}
\newcommand*{\suchthat}{\quad \text{s.t.} \quad}
\newcommand*{\argmin}{\arg\min}
\newcommand*{\argmax}{\arg\max}
\newcommand*{\normalorder}[1]{: #1 :}
\newcommand*{\pair}[1]{\langle #1 \rangle}
\newcommand*{\fd}[1]{\mathcal{D} #1}

\newrefformat{chap}{第\ref{#1}章}
\newrefformat{sec}{第\ref{#1}节}
\newrefformat{note}{注\ref{#1}}
\newrefformat{fig}{图\ref{#1}}
\newrefformat{alg}{算法\ref{#1}}
\newrefformat{back}{背景知识\ref{#1}}
\newrefformat{info}{资料框\ref{#1}}
\newrefformat{warn}{注意事项\ref{#1}}
\renewcommand{\autoref}{\prettyref}

\usetikzlibrary{arrows,shapes,positioning}
\usetikzlibrary{arrows.meta}
\usetikzlibrary{decorations.markings}
\tikzstyle arrowstyle=[scale=1]
\tikzstyle directed=[postaction={decorate,decoration={markings,
    mark=at position .5 with {\arrow[arrowstyle]{stealth}}}}]
\tikzstyle ray=[directed, thick]
\tikzstyle dot=[anchor=base,fill,circle,inner sep=1pt]

% Algorithm setting
\renewcommand{\algorithmcfname}{算法}
% Python-style code
\SetKwIF{If}{ElseIf}{Else}{if}{:}{elif:}{else:}{}
\SetKwFor{For}{for}{:}{}
\SetKwFor{While}{while}{:}{}
\SetKwInput{KwData}{输入}
\SetKwInput{KwResult}{输出}
\SetArgSty{textnormal}

\tcbuselibrary{skins, breakable, theorems}

\newtcbtheorem[number within=section]{back}{背景知识}%
  {colback=blue!5,colframe=blue!65,fonttitle=\bfseries, breakable}{back}
\newtcbtheorem[number within=section]{info}{资料框}%
  {colback=blue!5,colframe=blue!65,fonttitle=\bfseries, breakable}{info}
\newtcbtheorem[number within=section]{warning}{注意事项}%
  {colback=orange!5,colframe=orange!65,fonttitle=\bfseries, breakable}{warn}

\renewcommand{\emph}[1]{\textbf{#1}}
\newcommand*{\concept}[1]{\underline{\textbf{#1}}}

\numberwithin{equation}{section}

\newcommand{\hmn}[1]{% Hermann-Maguin notation
  \ensuremath{\begingroup\setupHMN #1\endgroup}%
}

\newcommand{\setupHMN}{%
  \doHMN{-}{\HMNoverline}%
  \doHMN{*}{\HMNminverse}%
  \doHMN{i}{\infty}
}

\newcommand{\doHMN}[2]{%
  \begingroup\lccode`~=`#1
  \lowercase{\endgroup\let~}#2%
  \mathcode`#1="8000
}

\newcommand{\HMNminverse}[1]{\frac{#1}{m}}
\newcommand{\HMNoverline}[1]{\mkern1mu\overline{\mkern-1mu#1\mkern-1mu}\mkern1mu}

\newcommand{\Ztwo}{$\mathbb{Z}_2$}

\newcommand{\bigO}[1]{\mathcal{O}(#1)}

\title{分子人类学中的统计方法}
\author{吴晋渊}

\begin{document}

\maketitle

\section{关于动物遗传的一些事实}

\begin{figure}
    \centering
    \input{generation.tex}
    \caption{染色体的传代：我们用颜色深浅来代表一个个体的祖先的染色体对某个后代个体的贡献，可以看到随着我们往上追溯族谱，大部分祖先的染色体的颜色都是很淡的}
    \label{fig:generation-passing}
\end{figure}

较高等的动物有减数分裂。一个个体携带的一对同源染色体中，有一条来自父亲而另一条来自母亲。
父亲和母亲在产生精子和卵子的时候是通过减数分裂，即来自他们每个人的父母的两条染色体又只有一条进入了配子中。
这样表面上看，似乎在遗传信息的代际传递中，实际上只有两条染色体是重要的：一个个体的两条同源染色体是从$N$代祖父母的该种染色体中取了两条，或者说对该个体的该种染色体有贡献的每一代祖父母中都只有两个个体。
不过，应当注意，减数分裂中会出现同源区段重组，从而，实际上，每一代祖父母中，对一个个体的某种染色体有贡献的个体数目要多于$2$。
虽然如此，由于同源区段重组发生几率是不大的，对某一个体的某种染色体的贡献超过某一阈值的祖父母的个数随着代际数目的增加只是线性增加。
这件事在\prettyref{fig:generation-passing}中展示得很清楚。
另一方面，祖先的数目随着代际数目上升是指数增长的。
因此，一个家族中，大部分的祖先对某个后代都几乎没有遗传信息的贡献。
一个直接的结果就是，使用系统发育方法得到的族谱和（往往是记录父系血统的）族谱会非常不同，因为显然没有什么规定了主要的遗传物质贡献都来自每一代人的父系。

虽然每个个体继承的祖先的遗传信息都只是很少一部分，但是如果种群不断扩张，每一代的后代个体都足够多，每个祖先的遗传物质都应该被一部分现存后代继承了（当然，可能有各种突变）。
实际上种群当然不可能不断扩张，总会有几支血脉灭绝的，于是一个种群的现存后代的遗传信息就只来自其祖先的一小部分。

以上我们都只是在讨论个体，不过其实我们可以更加细粒度一点，由于一条染色体上不同的部分可以来自不同的祖先，实际上可以讨论一个\emph{区段}的祖先等等。

如果不考虑基因突变，那么通过已知同源的区段的DNA序列比对，我们可以粗略地确定现存个体的祖先：一些个体肯定有一个共同的祖先，另一些个体肯定具有另一个祖先，等等。
基因突变让辨认族谱的工作稍微麻烦了一些，但是它带来的好处远远大于坏处：它能够让我们确定族谱的具体结构甚至分支时间。
这是因为基因突变的速率是可以确定的，那么我们就能够通过类似于版本学的方法辨认出。

在只讨论单一区段时，可以使用

\end{document}