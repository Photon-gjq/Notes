\documentclass[hyperref, UTF8, a4paper]{ctexart}

\usepackage{geometry}
\usepackage{titling}
\usepackage{titlesec}
\usepackage{paralist}
\usepackage{footnote}
\usepackage{enumerate}
\usepackage{amsmath, amssymb, amsthm}
\usepackage{simplewick}
\usepackage{cite}
\usepackage{graphicx}
\usepackage{subfigure}
\usepackage{physics}
\usepackage{slashed}
\usepackage{centernot}
\usepackage{tikz}
\usepackage{tikz-feynhand}
\usepackage[colorlinks, linkcolor=black, anchorcolor=black, citecolor=black]{hyperref}
\usepackage{prettyref}

\geometry{left=3.18cm,right=3.18cm,top=2.54cm,bottom=2.54cm}
\titlespacing{\paragraph}{0pt}{1pt}{10pt}[20pt]
\setlength{\droptitle}{-5em}
\preauthor{\vspace{-10pt}\begin{center}}
\postauthor{\par\end{center}}

\DeclareMathOperator{\timeorder}{T}
\DeclareMathOperator{\diag}{diag}
\newcommand*{\ii}{\mathrm{i}}
\newcommand*{\ee}{\mathrm{e}}
\newcommand*{\const}{\mathrm{const}}
\newcommand*{\comment}{\paragraph{注记}}
\newcommand{\fsl}[1]{{\centernot{#1}}}
\newcommand*{\reals}{\mathbb{R}}
\newcommand*{\complexes}{\mathbb{C}}

\newrefformat{sec}{第\ref{#1}节}
\newrefformat{note}{注\ref{#1}}
\renewcommand{\autoref}{\prettyref}

\newenvironment{bigcase}{\left\{\quad\begin{aligned}}{\end{aligned}\right.}

\newcommand{\concept}[1]{\underline{\textbf{#1}}}
\renewcommand{\emph}{\textbf}

\allowdisplaybreaks[4]

\title{量子电动力学的具体计算}
\author{吴晋渊}

\begin{document}

\maketitle

\section{非相对论极限}

\subsection{电子，光子和电场}

光子无法做非相对论近似，因为无论如何，麦克斯韦方程都应该成立，而这个方程就是洛伦兹协变的。
需要做非相对论近似的只有电子。在非相对论近似下，一切有质量的场都退化为薛定谔场，电子也不例外。
因此在QED的非相对论极限下，基本的粒子包括电子和光子，光子无任何变化，电子场则是动能为$\vb*{k}^2 / 2m$，不再满足相对论协变性，由动量和自旋标记的场。

\subsubsection{电子的薛定谔-泡利方程}

我们现在推导非相对论性电子场遵循的方程，然后得到非相对论极限下的电子哈密顿量。对称性告诉我们这个方程和狄拉克方程和电磁场耦合后取非相对论性近似的结果肯定是一样的。
但是，应该注意，前者中的电磁场都是算符场，而后者中的电磁场是一个经典外场，即后者忽略了电磁场的量子涨落。
电磁场的量子涨落会产生可观测的效应（即所谓\concept{辐射修正}）。实际上，这是量子场论的理论框架适用于电动力学的实验证据：一个相对论性的关于电子和光的理论未必要采取量子场论的形式，将电磁场量子化之后，圈图修正就会预言一些经典的电磁场不会产生的现象。
如果这些现象实际上没有观测到，那么量子场论的理论框架就是没有用的或者说错误的，但是实际上我们观测到了这些现象，那么量子场论很可能就是对的。

QED中，电子的狄拉克方程为
\[
    (\ii \gamma^\mu \partial_\mu - e \gamma^\mu A_\mu - m) \psi = 0.
\]
使用狄拉克表象以区分电子和正电子，设旋量场为
\[
    \psi = \pmqty{\phi \\ \chi},
\]
我们将要分析$\phi$遵循的运动方程。为此，根据
\[
    \gamma^0 = \pmqty{1 & 0 \\ 0 & -1}, \quad \gamma^i = \pmqty{0 & \sigma^i \\ - \sigma^i & 0},
\]
写出狄拉克方程的分量表达式：
\[
    \begin{aligned}
        (\ii \partial_t - e \varphi - m) \phi + (e (\vb*{\sigma} \cdot \vb*{A}) + \ii (\vb*{\sigma} \cdot \grad)) \chi &= 0, \\
        (\ii \partial_t - e \varphi + m) \chi + (e (\vb*{\sigma} \cdot \vb*{A}) + \ii (\vb*{\sigma} \cdot \grad)) \phi &= 0,
    \end{aligned}
\]
这里我们需要指出一个容易弄混的地方：正确的分量是
\[
    \partial_\mu = (\partial_t, \grad), \quad A_\mu = (\varphi, - \vb*{A}),
\]
而贸贸然地很容易认为前者是$(\partial_t, -\grad)$而后者是$(\varphi, \vb*{A})$。
我们消去$\chi$，就得到
\begin{equation}
    (\ii \partial_t - e \varphi - m) \phi - (e (\vb*{\sigma} \cdot \vb*{A}) + \ii (\vb*{\sigma} \cdot \grad)) \frac{1}{\ii \partial_t - e \varphi + m} (e (\vb*{\sigma} \cdot \vb*{A}) + \ii (\vb*{\sigma} \cdot \grad)) = 0.
    \label{eq:electron-only}
\end{equation}

到目前为止我们没有做任何近似。现在我们做最强的非相对论近似。我们按照通常的从克莱因-高登方程获得薛定谔方程的方法，设
\[
    \phi = \psi \ee^{-\ii m t}.
\]
这里我们重复使用了符号$\psi$，用它表示一个旋量场，以及从这个旋量场得到的一个薛定谔场；通常这不会导致混淆，因为前者只出现在高能物理中而后者只出现在凝聚态物理中。
我们发现
\[
    (\ii \partial_t - e \varphi - m) \phi = \ee^{-\ii m t} \partial_t \psi - e \varphi \psi \ee^{-\ii m t},
\]
而
\[
    (\ii \partial_t - e \varphi + m) \phi = \ee^{-\ii m t} \partial_t \psi - e \varphi \psi \ee^{-\ii m t} + 2 m \ee^{-\ii m t} \psi.
\]
在非相对论极限下粒子的动能相较于其静能（请注意这里都是自然单位制，$c=1$，$m$就是静能）是非常低的，于是
\[
    \partial_t \psi \ll 2m \psi,
\]
因此我们有
\[
    \ii \partial_t \psi - e \varphi \psi - \vb*{\sigma} \cdot (e\vb*{A} + \ii \grad) \frac{1}{2m - e\varphi} \vb*{\sigma} \cdot (e\vb*{A} + \ii \grad) \psi = 0.
\]
进一步，认为电场不很强（否则电子会轻易被加速到很高的速度，非相对论极限不正确），从而
\[
    e \varphi \ll m,
\]
那么就得到
\begin{equation}
    \ii \partial_t \psi - e \varphi \psi - \frac{(\vb*{\sigma} \cdot (e\vb*{A} + \ii \grad))^2}{2m} \psi = 0.
\end{equation}
做了如此的近似之后，我们相当于忽略了所有涉及正电子的辐射修正。
这个方程可以化成更加清晰的一个形式。我们知道
\[
    (\vb*{\sigma} \cdot \vb*{a}) (\vb*{\sigma} \cdot \vb*{b}) = \vb*{a} \cdot \vb*{b} + \ii \vb*{\sigma} \cdot (\vb*{a} \times \vb*{b}),
\]
而由于$(e\vb*{A} - \ii \grad)$是算符，它自乘并不是零，而是
\[
    (e\vb*{A} + \ii \grad) \times (e\vb*{A} + \ii \grad) \psi = \ii e \vb*{A} \times (\grad{\psi}) + \ii e \curl{(\vb*{A} \psi)} = \ii e  (\curl{\vb*{A}}) \psi = \ii e \vb*{B} \psi,
\]
于是我们就有
\begin{equation}
    \ii \partial_t \psi = \frac{(e \vb*{A} + \ii \grad)^2}{2m} \psi + e \varphi \psi - \frac{e \vb*{\sigma} \cdot \vb*{B}}{2m} \psi.
\end{equation}
场论哈密顿量为
\begin{equation}
    \begin{aligned}
        H &= \int \dd[3]{\vb*{x}} \psi^\dagger \left( \frac{(- \ii \grad - e \vb*{A})^2}{2m} + e \varphi \psi - \frac{e \vb*{\sigma} \cdot \vb*{B}}{2m} \right) \psi \\
        &= \int \dd[3]{\vb*{x}} \psi^\dagger \left( - \frac{(\grad - \ii e \vb*{A})^2}{2m} + e \varphi \psi - \frac{e \vb*{\sigma} \cdot \vb*{B}}{2m} \right) \psi ,
    \end{aligned}
    \label{eq:minimal-coupling}
\end{equation}
其中
\begin{equation}
    \int \dd[3]{\vb*{x}} \psi^\dagger \frac{(- \ii \grad - e \vb*{A})^2}{2m} \psi = \sum_\sigma \int \frac{\dd[3]{\vb*{p}}}{(2\pi)^3} a^\dagger_{\vb*{p} \sigma} \frac{(\vb*{p} - e \vb*{A})^2}{2m} a_{\vb*{p} \sigma}.
\end{equation}
$\psi$是电子的湮灭算符，其运动方程就是薛定谔绘景下单电子波函数的运动方程。
于是，坐标表象下单电子的波函数（当然，此时已经隐含地认为电磁场是经典场，否则会有等效电子-电子相互作用，单电子图像不再适用）满足的方程就是
\begin{equation}
    \ii \partial_t \psi = \frac{(e \vb*{A} + \ii \grad)^2}{2m} \psi - \frac{e \vb*{\sigma} \cdot \vb*{B}}{2m} \psi + e \varphi \psi = \frac{(\vb*{p} - e \vb*{A})^2}{2m} \psi - \frac{e \vb*{\sigma} \cdot \vb*{B}}{2m} \psi + e \varphi \psi.
\end{equation}
这个方程的形式和自由电子薛定谔方程很像，但是哈密顿量为
\begin{equation}
    H = \frac{(\vb*{p} - e \vb*{A})^2}{2m} - \frac{e \vb*{\sigma} \cdot \vb*{B}}{2m} + e \varphi = \frac{(\vb*{p} - e \vb*{A})^2}{2m} - \vb*{\mu} \cdot \vb*{B} + e \varphi.
    \label{eq:pauli-eq}
\end{equation}
我们称此方程为\concept{泡利方程}或是\concept{薛定谔-泡利方程}。
这里的$\vb*{p}$的意义实际上尚不明确，它的定义是“在坐标表象下是$-\ii \grad$的那个算符”。
大体上它是“动量”，但是实际上它不是$m \vb*{v}$的那个机械动量。
如果我们计算\eqref{eq:pauli-eq}作为经典哈密顿量给出的运动方程，会得到
\begin{equation}
    \dv{\vb*{r}}{t} = \frac{\vb*{p} - e \vb*{A}}{m}, \quad \dv{\vb*{p}}{t} = - \grad_{\vb*{r}}{H},
\end{equation}
展开计算，并注意到
\[
    \dv{\vb*{A}}{t} = \pdv{\vb*{A}}{t} + \vb*{v} \cdot \grad{\vb*{A}},
\]
最终可以计算得到
\begin{equation}
    \begin{aligned}
        m \dv{\vb*{v}}{t} &= \dv{(\vb*{p} - e \vb*{A})}{t} = - e \grad{\varphi} - e \pdv{\vb*{A}}{t} + e \vb*{v} \times (\curl{\vb*{A}}) + \grad(\vb*{\mu} \cdot \vb*{B}) \\
        &= e \vb*{E} + e \vb*{v} \times \vb*{E} + \grad(\vb*{\mu} \cdot \vb*{B}).
    \end{aligned}
    \label{eq:non-rel-electron-motion}
\end{equation}
因此这里的$\vb*{p}$不是机械动量。

无论电磁场是经典场还是考虑量子涨落，\eqref{eq:minimal-coupling}都是成立的。
这些式子可以看成对\eqref{eq:pauli-eq}中的电子做二次量子化得到的；这些式子也意味着，如果我们要将相对论性的、量子化的电磁场和非相对论性的电子耦合起来，只需要量子化自由电磁场即可，因为电磁场和非相对论性的电子耦合的哈密顿量总是\eqref{eq:minimal-coupling}，无论电磁场是经典的还是量子的。
\eqref{eq:minimal-coupling}也可以看成对非相对论性自由电子做$U(1)$最小耦合得到的结果。

\eqref{eq:minimal-coupling}中，$\vb*{A}$出现二阶项这件事值得分析，因为在QED中不存在这个情况：电磁场和电子旋量场之间的耦合中电磁场是一阶的。
回顾以上求解过程，这个$\vb*{A}^2$项实际上来自积掉$\chi$场的过程：我们只希望保留电子模式$\phi$而不想保留正电子模式$\chi$，于是就有\eqref{eq:electron-only}，实际上就是积掉了$\chi$场。
分析$\ii \bar{\psi} \gamma^\mu D_\mu \psi$项的形式可以知道，与$\chi$场相关的过程包括：$\chi$模式吸收一个$\varphi$光子；$\chi$模式和$\phi$模式互换，这个顶角的耦合常数含有动量的一次方；$\chi$模式和$\phi$模式互换，吸收一个$\vb*{A}$光子。
因此，积掉$\chi$场引入了这样一个等效过程：$\phi$模式或是吸收一个$\vb*{A}$光子或是不吸收，变成$\chi$模式，然后吸收若干个$\varphi$光子，最后或是吸收一个$\vb*{A}$光子或是不吸收而重新变成$\phi$模式。
这个过程涉及$\vb*{A}$的零次方、一次方和平方，以及任意阶次的$\varphi$。
然而，$\varphi$光子实际上是在给$\chi$场提供自能修正：
\[
    \frac{1}{\ii \partial_t + m} + \frac{1}{\ii \partial_t + m} e \varphi \frac{1}{\ii \partial_t + m} + \cdots = \frac{1}{\ii \partial_t + m - e \varphi},
\]
而在非相对论极限下$e \varphi$相比于$m$肯定是很小的，从而可以忽略。
另一方面，$\vb*{A}$的大小和$\vb*{p}$的大小却不好比较：两者都不能太大。
因此在\eqref{eq:minimal-coupling}中出现了非线性的$\vb*{A}$耦合，但是没有出现非线性的$\varphi$耦合。

应当指出这个非线性的$\vb*{A}$耦合并不意味着以机械动量标记的电子与光子的耦合中，电磁场就是非线性的，因为\eqref{eq:pauli-eq}中的$\vb*{p}$是正则动量而不是机械动量。
\eqref{eq:pauli-eq}中的$\vb*{p}$不是实际可以直接观察到的机械动量，并且存在$\vb*{A}^2$项，这两者彼此抵消，正好导致了关于机械动量，并且电磁场耦合项完全线性的\eqref{eq:non-rel-electron-motion}。
回顾\eqref{eq:non-rel-electron-motion}的推导，会发现其中$\vb*{A}^2$项在运动方程中产生一些类似于$\vb*{A} \times (\curl{\vb*{A}})$的项，而$\vb*{p} \cdot \vb*{A}$项产生了一些类似于$\vb*{p} \times (\curl{\vb*{A}})$的项，由于在\eqref{eq:pauli-eq}中$\vb*{p}$是正则动量，这两项彼此抵消，正好产生了$\vb*{v} \times (\curl{\vb*{A}})$这样的项。
可以使用与\eqref{eq:pauli-eq}等价的拉氏量
\begin{equation}
    L = \frac{1}{2} m \vb*{v}^2 - e \varphi + e \vb*{v} \cdot \vb*{A} + \vb*{\mu} \cdot \vb*{B}
\end{equation}
来更加清楚地看到这一点。我们不可能只使用机械动量就得到完整的非相对论性粒子在电磁场中的运动，因为这相当于做了一个规范变换让$\vb*{A}=0$，而这是不可能的——能够产生磁场的那部分$\vb*{A}$无法转化为$\varphi$。

\subsubsection{相对论修正}

% TODO：自旋轨道耦合之类？
相对论修正指的是当电子的能量仍然不是特别高（从而没有必要使用完整的狄拉克方程）但是已经比较高时，相对论效应造成的修正。
它和量子涨落造成的修正是基本上无关的，因为即使不考虑量子涨落，狄拉克方程仍然会导致偏离\eqref{eq:pauli-eq}的结果。

\subsubsection{腔体中的光场}

\subsection{有效相互作用}

原则上\eqref{eq:minimal-coupling}和量子化后的电磁场给出了非相对论性电子和电磁辐射的全部理论，包括了全部电子和光的相互作用。
然而，实际上我们还可以做进一步的近似，将一些过程用等效相互作用替代。
做完这种近似之后需要特别小心，以避免将同样的过程重复计数。

一种在凝聚态物理中特别常见的做法是，将那些不满足横波条件的光子积掉，因为凝聚态物理中的光子基本上能够直接对应为能够长距离传播的经典电磁波，它能够长距离地“逃出”介质。
能够通过大片真空的电磁波模式只能是满足横波条件的电磁波——不满足横波条件的电磁波模式只能出现在电荷附近。
因此，不满足横波条件的光子应当被积掉，因为它们代表“介质内部发生的、无法直接观察的事情”，而满足横波条件的光子应该被保留，介质的光学性质就是在描述介质和它们的相互作用。
这样不会有重复计数。

还有一些时候，不满足横波条件的光子实际上是我们讨论的那部分系统和一个非常“重”的系统（它基本上不会受到我们讨论的那部分系统的影响，可以看成一个背景）交换的，即是外场的一部分。

积掉光子的过程实际上就是计算所有外线都是电子的散射振幅的过程。
我们下面要做的计算都是在高能场论中完成的；\eqref{eq:pauli-eq}只是关于电子旋量场的一部分分量的，从而，我们下面获得的等效相互作用在加入\eqref{eq:pauli-eq}时可能需要适当地作用投影算符。
凝聚态物理能标下基本上只需要计算树图，我们将圈图计算留到\autoref{sec:radiation-correction}。

\subsubsection{库伦相互作用}

在非相对论情况下，光子的能量不足以激发出电子-正电子对，真空极化并不重要。
因此，光子虽然是无能隙的，仍然可以积掉光子而得到电子-电子等效相互作用。
我们将其它场看成背景场，因为QED中没有光子-光子相互作用顶角，这个等效相互作用背后的实际的QED过程只包含树图。

我们首先直接在QED中计算电子-电子等效相互作用，即使用旋量场$\psi$做计算，这相当于将所有的“电子发出一个光子，这个光子被另一个电子吸收”的子图用一个电子-电子等效相互作用替代，而不去碰“电子发出一个光子，这个光子被一个不是电子的东西吸收”，或是“一个不知道哪儿来的光子被电子吸收”的过程（这些过程可能又被做了别的近似，比如说如果系统中充满了“不知道哪儿来的光子”，那就可以把电磁场当成经典场，等等）。%
\footnote{
    这里说的“电子”指的都是我们的理论考虑的\emph{那部分}电子。
    “无穷远处射来一束光，被电子吸收”这个过程显然在我们的理论中不是电子-电子相互作用，但是把视角调远一些，很可能这个“无穷远处射来的光”本身是另一些电子辐射产生的，例如它可能来自原子能级跃迁产生的辐射，但是能级跃迁产生的辐射说到底还是电子产生的。
    然而，也许在我们讨论的问题的能标下，原子可以看成一个整体，那么，这个过程在我们的低能有效理论中就不是电子-电子相互作用。
}%
这么做了之后，不计入电子-电子等效相互作用的那些过程仍然是电子与电磁场耦合的过程，从而仍然可以得到\eqref{eq:minimal-coupling}。
于是最终我们就得到一个由\eqref{eq:minimal-coupling}，一个电子-电子相互作用，和电磁场自身的哈密顿量三部分拼在一起的模型，其中\eqref{eq:minimal-coupling}中的$\varphi$和$\vb*{A}$由电子激发出来的部分不能作用在电子上（从而避免了重复计数）。
这实际上就是凝聚态场论涉及电子和光子的部分（涉及声子的部分还未加入，因为此时尚无晶格）。

我们也可以换一个等价的思路，首先直接做非相对论极限得到\eqref{eq:minimal-coupling}，其中的$\vb*{A}$和$\varphi$由电子激发出来的部分可以作用在电子上。
然后我们假定电子运动速度非常慢，从而将所有的“电子发出一个光子，这个光子被另一个电子吸收”的子图用一个电子-电子等效相互作用替代，而不去碰“电子发出一个光子，这个光子被一个不是电子的东西吸收”，或是“一个不知道哪儿来的光子被电子吸收”的过程。

这两种思路会得到一样的理论，在其中一方面光子场仍然是实际存在的场而没有被真的积掉，一方面纯粹的电子-光子-电子相互作用（即光子只是内线）却又不用考虑，因为它们已经被等效的库仑相互作用考虑进去了。
这看起来很不自然，但在很多情况下——例如，在凝聚态物理，包括量子光学中——光子可以分成截然不同的两部分，一部分是物质之间交换的、基本上导致一个库伦相互作用的光子，一部分是遥远处的光源产生的“入射光”；前者是有源无旋的，后者是无源有旋的。
这是两种光子模式，彼此没有任何相互作用（能标足够低，不会有QED的四光子等效相互作用），并且前者从来不会出现在外线中。
这种情况下使用等效的电子-电子库伦相互作用就是非常合理的：我们马上要做的计算表明电子之间由光子传递的相互作用的头阶项是$\varphi$或者说$A^0$传递的库仑相互作用，这已经将有源无旋的光子产生的相互作用完全囊括了；然后我们就可以假定，在我们的模型中显式出现的光子都是无源有旋的、和我们通常对“电磁波”的想象一致的那部分光子。
当然我们也总是可以从头做计算，不引入等效的电子-电子库伦相互作用，计算每个电子受外场驱动而产生的辐射（包括近场和远场）。
等效电子-电子库伦相互作用实际上就是这里的近场辐射的无推迟时间近似而已。

给出等效电子-电子相互作用的图有两张：
\[
    \begin{tikzpicture}
        \begin{feynhand}
            \vertex (a) at (-1.5, 0.8);
            \vertex (b) at (-1.5, -0.8);
            \vertex (c) at (-1, 0);
            \vertex (d) at (0, 0);
            \vertex (e) at (0.5, 0.8);
            \vertex (f) at (0.5, -0.8);

            \propag[anti fermion] (a) to (c);
            \propag[fermion] (b) to (c);
            \propag[photon] (c) to (d);
            \propag[fermion] (d) to (e);
            \propag[anti fermion] (d) to (f);
        \end{feynhand}
    \end{tikzpicture}, \quad \quad 
    \begin{tikzpicture}
        \begin{feynhand}
            \vertex (a) at (-1.5, 0.8);
            \vertex (b) at (-1.5, -0.8);
            \vertex (c) at (-1, 0);
            \vertex (d) at (0, 0);
            \vertex (e) at (0.5, 0.8);
            \vertex (f) at (0.5, -0.8);

            \propag[anti fermion] (e) to (c);
            \propag[fermion] (b) to (c);
            \propag[photon] (c) to (d);
            \propag[fermion] (d) to (a);
            \propag[anti fermion] (d) to (f);
        \end{feynhand}
    \end{tikzpicture}
\]
如果参与散射的两个粒子是可以分辨的（即除了动量和自旋以外还有别的标签可以区分它们），那么第二张图和第一张图不在一个相互作用通道中。
低能过程由于动量低，相应的特征尺度很大，即粒子不会离得很近，这种情况下粒子的“位置”近似起到了区分两个粒子的标签的作用。这意味着第二张图可以忽略。

于是我们计算第一张图，它给出
\[
    \begin{gathered}
        \begin{tikzpicture}
            \begin{feynhand}
                \vertex (a) at (-1.5, 0.8);
                \vertex (b) at (-1.5, -0.8);
                \vertex (c) at (-1, 0);
                \vertex (d) at (0, 0);
                \vertex (e) at (0.5, 0.8);
                \vertex (f) at (0.5, -0.8);
    
                \propag[fermion] (c) to [edge label={$p'$}] (a);
                \propag[fermion] (b) to [edge label={$p$}] (c);
                \propag[photon] (c) to (d);
                \propag[fermion] (d) to [edge label={$k'$}] (e);
                \propag[fermion] (f) to [edge label={$k$}] (d);
            \end{feynhand}
        \end{tikzpicture}
    \end{gathered} = (-\ii e)^2 \bar{u}(p') \gamma^\mu u(p) \frac{-\ii \eta_{\mu \nu}}{(p' - p)^2 + \ii 0^+} \bar{u}(k') \gamma^\nu u(k).
\]
我们考虑$p, p', k, k'$都几乎是零的情况，并且只对$\mu=\nu=0, 3$的情况求和——其实我们会看到，$\mu = \nu = 1, 2$两种情况并不会有贡献。
此时计算会发现
\[
    \bar{u}(p') \gamma^0 u(p) = u^\dagger(p') u(p) \approx m \pmqty{\xi^\dagger & \xi^\dagger} \pmqty{\xi \\ \xi} = 2m \sigma^0,
\]
而
\[
    \bar{u}(p') \gamma^i u(p) = u^\dagger(p') \pmqty{\dmat{- \sigma^i, \sigma^i}} u(p) \approx m \pmqty{\xi^\dagger & \xi^\dagger} \pmqty{\dmat{- \sigma^i, \sigma^i}} \pmqty{\xi \\ \xi} = 0.
\]
于是我们就得到
\[
    \begin{aligned}
        \begin{gathered}
            \begin{tikzpicture}
                \begin{feynhand}
                    \vertex (a) at (-1.5, 0.8);
                    \vertex (b) at (-1.5, -0.8);
                    \vertex (c) at (-1, 0);
                    \vertex (d) at (0, 0);
                    \vertex (e) at (0.5, 0.8);
                    \vertex (f) at (0.5, -0.8);
        
                    \propag[fermion] (c) to [edge label={$p'$}] (a);
                    \propag[fermion] (b) to [edge label={$p$}] (c);
                    \propag[photon] (c) to (d);
                    \propag[fermion] (d) to [edge label={$k'$}] (e);
                    \propag[fermion] (f) to [edge label={$k$}] (d);
                \end{feynhand}
            \end{tikzpicture}
        \end{gathered} &= (-\ii e)^2 \bar{u}(p') \gamma^\mu u(p) \frac{-\ii \eta_{\mu \nu}}{(p' - p)^2 + \ii 0^+} \bar{u}(k') \gamma^\nu u(k) \\
        &= \ii e^2 2 m (\sigma^0)_p \frac{1}{(p' - p)^2 + \ii 0^+} 2m (\sigma^0)_k \\
        &= - \frac{\ii e^2 (2m)^2 \sigma^0}{\abs*{\vb*{p}' - \vb*{p}}^2 - \ii 0^+}.
    \end{aligned}
\]
这里由于我们取了非相对论极限，有
\[
    p^\mu = (m, \vb*{p}),
\]
于是
\[
    (p' - p)^2 = - \abs*{\vb*{p} - \vb*{p}'}^2.
\]
上式给出的是$S$矩阵的矩阵元，考虑到外线全部是电子，它是$\{\ket*{p}\}$表象下的等效相互作用哈密顿量矩阵元；下标$p$和$k$用于区分作用在不同单粒子态上的矩阵。
矩阵$\sigma^0$给出了自旋的变化情况，可以看到以上相互作用通道不挑选入射自旋，也不改变入射自旋。
我们要做非相对论近似，所以要转换到非洛伦兹协变的、在单粒子量子力学中使用的$\{\ket*{\vb*{p}}\}$表象下，由于有四条外线，要除以因子$(\sqrt{2m})^{4}$。
于是非相对论极限下，我们获得相互作用顶角
\begin{equation}
    \begin{gathered}
        \begin{tikzpicture}
            \begin{feynhand}
                \vertex (a) at (-1.5, 0.8);
                \vertex (b) at (-1.5, -0.8);
                \vertex (c) at (-1, 0);
                \vertex (d) at (0, 0);
                \vertex (e) at (0.5, 0.8);
                \vertex (f) at (0.5, -0.8);
    
                \propag[fermion] (c) to [edge label={$p', \alpha$}] (a);
                \propag[fermion] (b) to [edge label={$p, \alpha$}] (c);
                \propag[photon] (c) to (d);
                \propag[fermion] (d) to [edge label={$k', \beta$}] (e);
                \propag[fermion] (f) to [edge label={$k, \beta$}] (d);
            \end{feynhand}
        \end{tikzpicture}
    \end{gathered} = -\ii \frac{e^2}{\abs*{\vb*{p} - \vb*{p}'}^2} (2\pi)^4 \delta^4(k' + p' - p - k).
\end{equation}
这个相互作用顶角的形式实际上正是动量空间中的库伦定律。
为了更加清晰地看出库伦定律，我们将上式切换回实空间，做傅里叶变换
\[
    \begin{aligned}
        \int \frac{\dd[4]{p'}}{(2\pi)^4} \ee^{\ii p' \cdot x_1} \int \frac{\dd[4]{k'}}{(2\pi)^4} \ee^{\ii k' \cdot x_2} \int \frac{\dd[4]{p}}{(2\pi)^4} \ee^{- \ii p \cdot x_3} \int \frac{\dd[4]{p}}{(2\pi)^4} \ee^{- \ii p \cdot x_4},
    \end{aligned}
\]
计算发现
\begin{equation}
    \begin{aligned}
        \begin{gathered}
            \begin{tikzpicture}
                \begin{feynhand}
                    \vertex (a) at (-1.7, 1) {$x_1, \alpha$};
                    \vertex (b) at (-1.7, -1) {$x_3, \alpha$};
                    \vertex (c) at (-1, 0);
                    \vertex (d) at (0, 0);
                    \vertex (e) at (0.7, 1) {$x_2, \beta$};
                    \vertex (f) at (0.7, -1) {$x_4, \beta$};
        
                    \propag[fermion] (c) to (a);
                    \propag[fermion] (b) to (c);
                    \propag[photon] (c) to (d);
                    \propag[fermion] (d) to (e);
                    \propag[fermion] (f) to (d);
                \end{feynhand}
            \end{tikzpicture}
        \end{gathered} &= -\ii e^2 \delta(t_4 - t_1) \delta^4(x_1 - x_3) \delta^4(x_2 - x_4) \int \frac{\dd[3]{\vb*{q}}}{(2\pi)^3} \frac{\ee^{-\ii \vb*{q} \cdot (\vb*{x}_4 - \vb*{x}_1)}}{\abs*{\vb*{q}}^2 - \ii 0^+} \\
        &= -\ii \delta(t_4 - t_1) \delta^4(x_1 - x_3) \delta^4(x_2 - x_4) \frac{e^2}{4\pi \abs*{\vb*{x}_4 - \vb*{x}_1}}.
    \end{aligned}
    \label{eq:coulomb-interaction}
\end{equation}
因此我们的确得到了库伦相互作用。在计算时有一个细节：计算\eqref{eq:coulomb-interaction}的第一个等号右边的积分时，我们有
\[
    \begin{aligned}
        \int \frac{\dd[3]{\vb*{q}}}{(2\pi)^3} \frac{\ee^{-\ii \vb*{q} \cdot (\vb*{x}_4 - \vb*{x}_1)}}{\abs*{\vb*{q}}^2 - \ii 0^+} &= \frac{2\pi}{(2\pi)^3} \int_0^{\pi} \sin \theta \dd{\theta} \int_0^\infty q^2 \dd{q} \frac{\ee^{- \ii q \abs*{\vb*{x}_4 - \vb*{x}_1} \cos \theta}}{\abs*{\vb*{q}}^2 - \ii 0^+} \\
        &= \frac{1}{4\pi^2} \int_0^\infty \frac{q^2}{q^2 - \ii 0^+} \dd{q} \frac{\ee^{- \ii q \abs*{\vb*{x}_4 - \vb*{x}_1}} - \ee^{\ii q \abs*{\vb*{x}_4 - \vb*{x}_1}}}{- \ii q \abs*{\vb*{x}_4 - \vb*{x}_1}} \\
        &= \frac{1}{4\pi^2 \ii} \int_{-\infty}^\infty \frac{q^2}{q^2 - \ii 0^+} \dd{q} \frac{\ee^{\ii q \abs*{\vb*{x}_4 - \vb*{x}_1}}}{q \abs*{\vb*{x}_4 - \vb*{x}_1}}.
    \end{aligned}
\]
如果我们将因子$q^2/(q^2 - \ii 0^+)$直接当成$1$，上式就没有确定的值了，因为极点直接出现在了积分路径上。
不过，我们有
\[
    \frac{q^2}{q^2 - \ii \epsilon} = \frac{1}{1 - \frac{\ii \epsilon}{q^2}} \to 0 \ \ \text{as $q \to 0$},
\]
因此我们应该取积分主值，即取
\[
    \int \frac{\dd[3]{\vb*{q}}}{(2\pi)^3} \frac{\ee^{-\ii \vb*{q} \cdot (\vb*{x}_4 - \vb*{x}_1)}}{\abs*{\vb*{q}}^2 - \ii 0^+} = \frac{1}{4\pi^2 \ii} \text{P} \int_{-\infty}^\infty \dd{q} \frac{\ee^{\ii q \abs*{\vb*{x}_4 - \vb*{x}_1}}}{q \abs*{\vb*{x}_4 - \vb*{x}_1}} = \frac{1}{4\pi^2 \ii} \frac{\pi \ii}{\abs*{\vb*{x}_4 - \vb*{x}_1}} = \frac{1}{4\pi \abs*{\vb*{x}_4 - \vb*{x}_1}}. 
\]

单粒子量子力学中的散射理论相当于梯形图近似。

\subsubsection{自旋磁矩}\label{sec:spin-magnetic-moment}

在\eqref{eq:pauli-eq}和\eqref{eq:minimal-coupling}中我们看到，由于算符不对易这一特点，哈密顿量中除了经典的机械动能项（正则动量$\vb*{p}$减去电磁动量$e \vb*{A}$得到机械动量）以外还多出来一项。
电子自旋算符为
\[
    \vb*{S} = \frac{\vb*{\sigma}}{2},
\]
于是这一项就是
\begin{equation}
    H_\text{spin} = - \vb*{\mu} \cdot \vb*{B}, 
\end{equation}
其中
\begin{equation}
    \vb*{\mu} = \frac{e \vb*{\sigma}}{2m} = \frac{e}{m} \vb*{S} = - \frac{\abs*{e}}{m} \vb*{S} = - g \frac{\abs*{e}}{2m} \vb*{S}.
\end{equation}
这意味着电子即使在静止时也有磁矩，这个磁矩是来自其自旋而不是轨道运动的。$g=2$是自旋磁矩的朗德$g$因子。

% TODO：电子磁矩之间的相互作用
上面的推导实际上是将$\vb*{B}$当成了一个完全确定的外场；然而，电磁场存在量子涨落。
电子磁矩是实验可测的。粗略的实验确实指出$g=2$，更加精确的实验（基本上远远超过了凝聚态场论的能标）则显示$g$其实比$2$稍微大一些，并且计算QED圈图修正之后能够得到和实验测量结果非常接近的值，这是一个证明QED可靠性的有力论据。

\section{散射实验}

积掉光子还意味着电子自己需要做自能修正，让质量什么的发生变化，即由于电子和光子的相互作用，电子带上了“电磁质量”。
这是在经典电动力学中也已经知道的一个现象，但是在经典电动力学中不足以处理自能导致的发散。

\section{辐射修正}\label{sec:radiation-correction}

\subsection{顶角函数}



\subsection{反常磁矩}

QED会导致的一个能够观测的效应是\concept{反常磁矩}，即自旋磁矩实际上不严格是$2$。
我们此处先给出计算自旋磁矩的大致步骤。我们是要计算如下的图：
\[
    \begin{tikzpicture}
        \begin{feynhand}
            \vertex (a) at (-1.2, 0);
            \vertex[grayblob] (b) at (0, 0) {};
            \vertex (c) at (1.2, 0);
            \vertex[crossdot] (d) at (0, 1.2) {};
            
            \propag[fermion] (a) to (b);
            \propag[fermion] (b) to (c);
            \propag[photon] (d) to (b);
            \end{feynhand}
    \end{tikzpicture},
\]
其中光子线代表一个比较强的、大小基本上确定的外场；这不代表不会有量子涨落。
在上图中所有的量子涨落可以归结入顶角函数中；电子线由于amputating，无需自能修正，而光子线代表的外场也可以默认已经是amputated的。
因此，严格计算电子自旋磁矩就归结为计算顶角函数。

$S$矩阵矩阵元
\[
    \ii \mathcal{M}^\mu = \begin{gathered}
        \begin{tikzpicture}
            \begin{feynhand}
                \vertex (a) at (-1.2, 0);
                \vertex[grayblob] (b) at (0, 0) {};
                \vertex (c) at (1.2, 0);
                \vertex[crossdot] (d) at (0, 1.2) {};
                
                \propag[fermion] (a) to[edge label={$q_1$}] (b);
                \propag[fermion] (b) to[edge label={$q_2$}] (c);
                \propag[photon] (d) to[edge label={$p, \mu$}] (b);
                \end{feynhand}
        \end{tikzpicture}
    \end{gathered}
\]
是一个矢量，并且费曼图的形式显示它具有$\bar{u} \times \cdots \times u$的形式，而系统中出现的矢量指标只有$\gamma^\mu$以及三个动量，于是我们设
\[
    \ii \mathcal{M}^\mu = \begin{gathered}
        \begin{tikzpicture}
            \begin{feynhand}
                \vertex (a) at (-1.2, 0);
                \vertex[grayblob] (b) at (0, 0) {};
                \vertex (c) at (1.2, 0);
                \vertex[crossdot] (d) at (0, 1.2) {};
                
                \propag[fermion] (a) to[edge label={$q_1$}] (b);
                \propag[fermion] (b) to[edge label={$q_2$}] (c);
                \propag[photon] (d) to[edge label={$p, \mu$}] (b);
                \end{feynhand}
        \end{tikzpicture}
    \end{gathered}
    = \bar{u}(q_2) (f_1 \gamma^\mu + f_2 p^\mu + f_3 q_1^\mu + f_4 q_2^\mu) u(q_1),
\]
其中四个$f_i$因子是可以依赖于动量的复标量，此处复标量包括多分量对象$\slashed{a}$。
这些因子必须是标量或是$\slashed{a}$，因为$\bar{u}$和$u$能够组合成的双线性形式的数目是有限的，以上四种情况穷尽了所有的$\bar{u}$和$u$能够组合成的双线性矢量）。
动量守恒意味着$f_2, f_3, f_4$不完全独立；不失一般性地我们不妨让$f_2=0$。
$f_i$中仅有的多分量对象就是$\slashed{q}_1$和$\slashed{q}_2$，这两者都作用在$u(q_1)$或是$\bar{u}(q_2)$上，通过狄拉克方程
\[
    \slashed{q}_1 u(q_1) = m u(q_1), \quad \bar{u}(q_2) \slashed{q}_2 = m \bar{u}(q_2)
\]
可以消去它们。因此$f_1, f_3, f_4$中只显含$q_1^2, q_2^2, q_1 \cdot q_2$和$m$。
前两者根据自由粒子的色散关系都是$m^2$，因此最终$f_1, f_3, f_4$中只显含$m$和$q_1 \cdot q_2$，或者等价地说$m$和$p^2$；而量纲分析又告诉我们在这里真正重要的是$p^2/m^2$。
使用Ward恒等式，我们有
\[
    \begin{aligned}
        0 &= \ii p_\mu \mathcal{M}^\mu \\
        &= \bar{u}(q_2) (f_1 p_\mu \gamma^\mu + f_3 p_\mu q_1^\mu + f_4 p_\mu q_2^\mu) u(q_1) \\
        &= f_1 \bar{u}(q_2) \slashed{p} u(q_1) + f_3 \bar{u}(q_2) p \cdot q_1 {u}(q_1) + f_4 \bar{u}(q_2) p \cdot q_2 u(q_1),
    \end{aligned}
\]
而
\[
    \begin{aligned}
        \bar{u}(q_2) \slashed{p} u(q_1) &= \bar{u}(q_2) \slashed{q}_2 u(q_1) - \bar{u}(q_2) \slashed{q}_1 u(q_1) \\
        &= m \bar{u}(q_2) u(q_1) - m \bar{u}(q_2) u(q_1) = 0,
    \end{aligned}
\]
且
\[
    \begin{aligned}
        p \cdot q_1 &= (q_2 - q_1) \cdot q_1 = q_2 \cdot q_1 - m^2, \\
        p \cdot q_2 &= (q_2 - q_1) \cdot q_2 = m^2 - q_1 \cdot q_2,
    \end{aligned}
\]
于是就能够证明$f_3=f_4$。因此独立的$f_i$只有两个。这样我们就有
\[
    \begin{aligned}
        \ii \mathcal{M}^\mu &= \bar{u}(q_2) (f_1 \gamma^\mu + f_3 q_1^\mu + f_3 q_2^\mu) u(q_1) \\
        &= (f_1 + 2m f_3) \bar{u}(q_2) \gamma^\mu u(q_1) + \ii f_3 \bar{u}(q_2) \sigma^{\mu \nu} (q_1^\nu - q_2^\nu) u(q_1), 
    \end{aligned}
\]
第二个等号用到了Gordon恒等式
\[
    \bar{u}(q_2) (q_1^\mu + q_2^\mu) u(q_1) = 2m \bar{u}(q_2) \gamma^\mu u(q_1) + \ii \bar{u}(q_2) \sigma^{\mu \nu} (q_1^\nu - q_2^\nu) u(q_1).
\]
这样我们可以形式地写出
\begin{equation}
    \ii \mathcal{M}^\mu = -\ii e \bar{u}(q_2) \left( F_1\left(\frac{p^2}{m^2}\right) \gamma^\mu + \frac{\ii \sigma^{\mu \nu}}{2m} p_\nu F_2\left(\frac{p^2}{m^2}\right) \right) u(q_1),
    \label{eq:form-factor-vertex}
\end{equation}
其中$F_1$和$F_2$被称为\concept{形状因子}。通常将$F_2$限制为\emph{圈图贡献的修正}。本节暂时将树图也纳入它们之中以便说明，最后再恢复正确的记号。

这个散射振幅提供了完整的外场和电子发生单次相互作用的方式。

对自旋磁矩涉及的相互作用，我们考虑外场的$\mu=1, 2, 3$分量，因为$\vb*{B}$和电势无关。
\eqref{eq:form-factor-vertex}的第一项和自旋无关，因此我们将要考虑第二项。
此外，在非相对论极限下，$q_1^0=q_2^0=m$，因此在这个极限下$p_0=0$。
因此我们只需要计算
\[
    \ii (\mathcal{M}^\text{spin})^i = - \ii e \bar{u}(q_2) \frac{\ii \sigma^{ij}}{2m} p_j F_2\left(\frac{p^2}{m^2}\right).
\]
由于$\vb*{B} = \curl{\vb*{A}}$，在动量空间中$\vb*{B}=\ii \vb*{p} \times \vb*{A}$，即
\[
    B^i = \ii \epsilon^{ijk} p^j A^k,
\]
因此我们有
\[
    \begin{aligned}
        \ii (\mathcal{M}^\text{spin})^i A_i &= - \ii e \bar{u}(q_2) \frac{\ii \sigma^{ij}}{2m} p_j F_2\left(\frac{p^2}{m^2}\right) u(q_1) A_i \\
        &= - \ii e \bar{u}(q_2) \frac{\ii \sigma^{ij}}{2m} p^j A^i u(q_1) F_2\left(\frac{p^2}{m^2}\right) \\
        &= -\ii e \bar{u}(q_2) \frac{\ii}{2m}  \epsilon^{ijk} \pmqty{\dmat{\sigma^k, \sigma^k}} p_j A_i u(q_1) F_2\left(\frac{p^2}{m^2}\right) \\
        &= - \frac{\ii e}{m} \bar{u}(q_2) \epsilon^{ijk} (\ii p^j) A^i S^k u(q_1) F_2\left(\frac{p^2}{m^2}\right) \\
        &= - \frac{\ii e}{m} ((- \ii \vb*{p} \times \vb*{A}) \cdot \vb*{S}) \bar{u}(q_2) u(q_1) F_2\left(\frac{p^2}{m^2}\right) \\
        &= - \frac{\ii e}{m} (- \vb*{B} \times \vb*{S}) \bar{u}(q_2) u(q_1) F_2\left(\frac{p^2}{m^2}\right).
    \end{aligned}
\]
然后，在非相对论极限下$u(q_1)$和$\bar{u}(q_2)$可以写成$(\xi \ \ \xi)_{\vb*{p}=0}$及其转置，如同在库伦相互作用中那样，我们有
\[
    \bar{u}(q_2) u(q_1) = 2m \sigma^0,
\]
于是
\[
    \ii (\mathcal{M}^\text{spin})^i A_i = - \frac{\ii e}{m} (- \vb*{B} \times \vb*{S}) 2m \sigma^0 F_2(0).
\]
这里我们已经将$F_2$的括号中的$p$取为零，因为是非相对论极限。
最后与推导库伦相互作用时类似，切换到$\ket*{\vb*{p}}$表象下，由于有两条电子外线，除以因子$(\sqrt{2m})^2$，就得到非相对论量子力学中的等效相互作用顶角
\begin{equation}
    \begin{gathered}
        \begin{tikzpicture}
            \begin{feynhand}
                \vertex (a) at (-1.2, 0);
                \vertex[grayblob] (b) at (0, 0) {};
                \vertex (c) at (1.2, 0);
                \vertex[crossdot] (d) at (0, 1.2) {};
                
                \propag[fermion] (a) to[edge label={$q_1$}] (b);
                \propag[fermion] (b) to[edge label={$q_2$}] (c);
                \propag[photon] (d) to[edge label={$p, \mu$}] (b);
                \end{feynhand}
        \end{tikzpicture}
    \end{gathered} = - \ii \left( - F_2(0) \frac{e}{m} \vb*{S} \cdot \vb*{B} \right),
\end{equation}
即，电子的自旋和外磁场的相互作用哈密顿量为
\begin{equation}
    H_\text{spin} = - \vb*{\mu} \cdot \vb*{B}, \quad \vb*{\mu} = \frac{e}{m} F_2(0) \vb*{S}.
\end{equation}
$F_2(0)$中树图阶的贡献我们已经在\autoref{sec:spin-magnetic-moment}中看到了，就是$1$，所以现在我们恢复惯常的记号，得到
\begin{equation}
    H_\text{spin} = - \vb*{\mu} \cdot \vb*{B}, \quad \vb*{\mu} = \frac{e}{m} (1 + F_2(0)) \vb*{S},
\end{equation}
或者用朗德$g$因子表示，为
\begin{equation}
    g = 2 + 2 F(0),
\end{equation}
其中$F_2(0)$给出顶角函数圈图修正带来的修正。

然后$F_2(0)$本身是没有发散的。% TODO

\section{重整化群分析}

通过重整化常数，抽取$\beta$函数和反常量纲来分析物理参数随着能量标度的变化。

\end{document}