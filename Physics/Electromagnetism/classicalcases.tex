\documentclass[UTF8, a4paper]{ctexart}

\usepackage{geometry}
\usepackage{titling}
\usepackage{titlesec}
\usepackage{paralist}
\usepackage{footnote}
\usepackage{enumerate}
\usepackage{amsmath, amssymb, amsthm}
\usepackage{cite}
\usepackage{graphicx}
\usepackage{subfigure}
\usepackage{physics}
\usepackage{slashed}
\usepackage[colorlinks, linkcolor=black, anchorcolor=black, citecolor=black]{hyperref}
\usepackage{prettyref}

\geometry{left=3.28cm,right=3.28cm,top=2.54cm,bottom=2.54cm}
\titlespacing{\paragraph}{0pt}{1pt}{10pt}[20pt]
\setlength{\droptitle}{-5em}
\preauthor{\vspace{-10pt}\begin{center}}
\postauthor{\par\end{center}}

\newcommand*{\ee}{\mathrm{e}}
\newcommand*{\ii}{\mathrm{i}}
\newcommand*{\st}{\quad \text{s.t.} \quad}
\newcommand*{\const}{\mathrm{const}}
\newcommand*{\natnums}{\mathbb{N}}
\newcommand*{\reals}{\mathbb{R}}
\newcommand*{\complexes}{\mathbb{C}}
\DeclareMathOperator{\timeorder}{T}
\newcommand*{\ogroup}[1]{\mathrm{O}(#1)}
\newcommand*{\sogroup}[1]{\mathrm{SO}(#1)}
\DeclareMathOperator{\legpoly}{P}
\DeclareMathOperator{\diag}{diag}

\renewcommand{\emph}[1]{\textbf{#1}}
\newcommand*{\concept}[1]{\underline{\textbf{#1}}}

\newrefformat{sec}{第\ref{#1}节}
\newrefformat{note}{注\ref{#1}}
\newrefformat{fig}{图\ref{#1}}
\renewcommand{\autoref}{\prettyref}

\newenvironment{bigcase}{\left\{\quad\begin{aligned}}{\end{aligned}\right.}

\title{经典电动力学常见问题}
\author{吴何友}

\begin{document}

\maketitle

以下如无特殊说明，源点坐标用$\vb*{r}'$表示，场点坐标用$\vb*{r}$表示；从源点指向场点的矢量记作$\vb*{R} = \vb*{r} - \vb*{r}'$。规定$\vb*{r}_{12} = \vb*{r}_1 - \vb*{r}_2$，为从2指向1的矢量。

\section{麦克斯韦方程及其推论}

\subsection{不同单位制下的麦克斯韦方程}

自然单位制下，麦克斯韦方程为
\begin{equation}
    \left\{
        \begin{aligned}
            \div{\vb*{E}} &= \rho, \\
            \curl{\vb*{E}} &= - \pdv{\vb*{B}}{t}, \\
            \div{\vb*{B}} &= 0, \\
            \curl{\vb*{B}} &= \pdv{\vb*{E}}{t} + \vb*{j}.
        \end{aligned}
    \right.
    \label{eq:maxwell-eq}
\end{equation}
在\concept{国际单位制}下，我们有
\begin{equation}
    \left\{
        \begin{aligned}
            \div{\vb*{E}} &= \frac{\rho}{\epsilon_0}, \\
            \curl{\vb*{E}} &= - \pdv{\vb*{B}}{t}, \\
            \div{\vb*{B}} &= 0, \\
            \curl{\vb*{B}} &= \mu_0 \epsilon_0 \pdv{\vb*{E}}{t} + \mu_0 \vb*{j}.
        \end{aligned}
    \right.
    \label{eq:maxwell-eq-si}
\end{equation}
以下如无特殊说明，均使用国际单位制。

从以上方程可以推导出电荷输运方程
\begin{equation}
    \pdv{\rho}{t} + \div{\vb*{j}} = 0,
    \label{eq:charge-transportation}
\end{equation}
以及场满足的波动方程
\begin{equation}
    \frac{1}{c^2} \pdv[2]{\vb*{E}}{t} - \laplacian{\vb*{E}} = - \frac{1}{\epsilon_0} \grad{\rho} - \mu_0 \pdv{\vb*{j}}{t} , \quad \frac{1}{c^2} \pdv[2]{\vb*{B}}{t} - \laplacian{\vb*{B}} = \mu_0 \curl{\vb*{j}},
    \label{eq:wave-eq-general}
\end{equation}
其中
\begin{equation}
    \frac{1}{c^2} = \epsilon_0 \mu_0
\end{equation}
为\concept{光速}，实际上就是电磁波传播的速度。
麦克斯韦方程本身没有给出电荷的动力学，但是它确实给出了一个守恒荷。

本文讨论的都是经典电动力学，在其中，电场和磁场既是物理量又标记了系统的状态，因此有时候它们看起来像量子理论中的算符，有时候看起来像某种波函数，这都是合理的。

\subsection{常见规范}

库伦规范、洛伦兹规范、辐射规范

库伦规范一般用于分析静磁学问题。

\subsection{能量和动量}

电磁场中的粒子的运动方程为
\begin{equation}
    \dv{\vb*{p}}{t} = q \vb*{E} + q \vb*{v} \times \vb*{B},
\end{equation}

一个区域内部所有粒子的能量的变化为
\begin{equation}
    \dv{E}{t} = \sum q \vb*{v} \cdot \vb*{E} = \int \dd[3]{\vb*{r}} \vb*{j} \cdot \vb*{E},
\end{equation}
而
\[
    \begin{aligned}
        \vb*{j} \cdot \vb*{E} &= \left( \frac{1}{\mu_0} \curl{\vb*{B}} - \epsilon_0 \pdv{\vb*{E}}{t} \right) \cdot \vb*{E} \\
        &= \frac{1}{\mu_0} \div{(\vb*{B} \times \vb*{E})} - \frac{\epsilon_0}{2} \pdv{\vb*{E}^2}{t} + \frac{1}{\mu_0} (\curl{\vb*{E}}) \cdot \vb*{B} \\
        &= \frac{1}{\mu_0} \div{(\vb*{B} \times \vb*{E})} - \frac{\epsilon_0}{2} \pdv{\vb*{E}^2}{t} - \frac{1}{\mu_0} \pdv{\vb*{B}}{t} \cdot \vb*{B} \\
        &= \frac{1}{\mu_0} \div{(\vb*{B} \times \vb*{E})} - \pdv{t} \left( \frac{\epsilon_0}{2} \vb*{E}^2 + \frac{1}{2 \mu_0} \vb*{B}^2 \right),
    \end{aligned}
\]
因此
\[
    \dv{E}{t} = - \int \dd[3]{\vb*{r}} \left( \frac{\epsilon_0}{2} \vb*{E}^2 + \frac{1}{2 \mu_0} \vb*{B}^2 \right) - \frac{1}{\mu_0} \int \dd{\vb*{S}} \cdot (\vb*{E} \times \vb*{B}).
\]
设电磁场能量密度为$u$，能流密度为$\vb*{S}$，则
\[
    \dv{E}{t} + \int \dd[3]{\vb*{r}} u = - \int \dd{\vb*{S}} \cdot \vb*{S},
\]
于是
\begin{equation}
    \int \dd[3]{\vb*{r}} u + \int \dd{\vb*{S}} \cdot \vb*{S} = \int \dd[3]{\vb*{r}} \left( \frac{1}{2} \epsilon_0 \vb*{E}^2 + \frac{1}{2\mu_0} \vb*{B}^2 \right) + \int \dd{\vb*{S}} \cdot \frac{1}{\mu_0} \vb*{E} \times \vb*{B},
    \label{eq:energy-flow-original}
\end{equation}
从而可以取
\begin{equation}
    u = \frac{1}{2} \epsilon_0 \vb*{E}^2 + \frac{1}{2\mu_0} \vb*{B}^2, \quad \vb*{S} = \frac{1}{\mu_0} \vb*{E} \times \vb*{B}.
    \label{eq:energy-flow}
\end{equation}
当然，实际上从\eqref{eq:energy-flow-original}不能唯一地确定能量密度和能流，因为在变换
\[
    \rho' = \rho + \div{\vb*{c}}, \quad \vb*{j}' = \vb*{j} - \pdv{\vb*{c}}{t}
\]
下输运方程保持成立。这也是可以预期的，因为可以看出\eqref{eq:energy-flow-original}是麦克斯韦方程能够给出的关于能量的全部结论，而通常从运动学方程出发并不能唯一地定义能量。
使用\eqref{eq:energy-flow}定义的$\vb*{S}$称为\concept{坡印廷矢量}。

使用类似的方法，设$\vb*{P}$为一个区域内的粒子总能量，则
\[
    \dv{\vb*{P}}{t} = \sum (q \vb*{E} + q \vb*{v} \times \vb*{B}) = \int \dd[3]{\vb*{r}} \left( \rho \vb*{E} + \vb*{j} \times \vb*{B} \right),
\]
代入$\rho$和$\vb*{j}$，得到
\[
    \begin{aligned}
        \dv{\vb*{P}}{t} &= \int \dd[3]{\vb*{r}} \left(\epsilon_0 (\div{\vb*{E}}) \vb*{E} + \left( \frac{1}{\mu_0} \curl{\vb*{B}} - \epsilon_0 \pdv{\vb*{E}}{t} \right) \times \vb*{B} \right) \\
        &= \int \dd[3]{\vb*{r}} \epsilon_0 (\div{\vb*{E}}) \vb*{E} + \int \dd[3]{\vb*{r}} \frac{1}{\mu_0} (\curl{\vb*{B}}) \times \vb*{B} - \epsilon_0 \int \dd[3]{\vb*{r}} \pdv{t} (\vb*{E} \times \vb*{B}) + \epsilon_0 \int \dd[3]{\vb*{r}} \vb*{E} \times \pdv{\vb*{B}}{t} \\
        &= \epsilon_0 \int \dd[3]{\vb*{r}} ((\div{\vb*{E}}) \vb*{E} + (\curl{\vb*{E}}) \times \vb*{E}) + \frac{1}{\mu_0} \int \dd[3]{\vb*{r}} (\curl{\vb*{B}}) \times \vb*{B} - \epsilon_0 \int \dd[3]{\vb*{r}} \pdv{t} (\vb*{E} \times \vb*{B}),
    \end{aligned}
\]
而注意到
\[
    \begin{aligned}
        (\div{\vb*{E}}) \vb*{E} + (\curl{\vb*{E}}) \times \vb*{E}) &= \div{(\vb*{E} \vb*{E})} - (\vb*{E} \cdot \grad) \vb*{E} - \vb*{E} \times (\curl{\vb*{E}}) \\
        &= \div{(\vb*{E} \vb*{E})} - \frac{1}{2} \grad{\vb*{E}^2} \\
        &= \div{(\vb*{E} \vb*{E})} - \frac{1}{2} \div{(\vb*{E}^2 \vb*{I})},
    \end{aligned}
\]
且类似的可以得到
\[
    \begin{aligned}
        \underbrace{(\div{\vb*{B}}) \vb*{B}}_{=0} + (\curl{\vb*{B}}) \times \vb*{B}) &= \div{(\vb*{B} \vb*{B})} - (\vb*{B} \cdot \grad) \vb*{B} - \vb*{B} \times (\curl{\vb*{B}}) \\
        &= \div{(\vb*{B} \vb*{B})} - \frac{1}{2} \grad{\vb*{B}^2} \\
        &= \div{(\vb*{B} \vb*{B})} - \frac{1}{2} \div{(\vb*{B}^2 \vb*{I})},
    \end{aligned}
\]
于是就有
\[
    \begin{aligned}
        \dv{\vb*{P}}{t} &= - \epsilon_0 \int \dd[3]{\vb*{r}} \pdv{t} (\vb*{E} \times \vb*{B}) - \int \dd{\vb*{S}} \cdot \left( \frac{1}{2} \left( \epsilon_0 \vb*{E}^2 + \frac{1}{\mu_0} \vb*{B}^2 \right) \vb*{I} - \epsilon_0 \vb*{E} \vb*{E} - \frac{1}{\mu_0} \vb*{B} \vb*{B} \right) \\
        &= - \int \dd[3]{\vb*{r}} \vb*{g} - \int \dd{S_i} T_{ij},
    \end{aligned}
\]
其中$\vb*{g}$是动量密度而$T_{ij}$是动量流密度（一个二阶张量）。同样，只是知道上式不能够唯一确定动量密度和动量流密度，但是以下的选择是最简单的：
\begin{equation}
    T_{ij} = u \delta_{ij} - \epsilon_0 E_i E_j - \frac{1}{\mu_0} B_i B_j, \quad \vb*{g} = \frac{1}{c^2} \vb*{S}.
\end{equation}
张量$T_{ij}$称为\concept{麦克斯韦张量}，它可以看成电磁场提供的应力。

\subsection{非相对论性粒子}

\begin{equation}
    \vb*{p} = m \vb*{v} + q \vb*{A}
\end{equation}
如果粒子始终处于

\section{真空中的解}

\subsection{稳恒问题}

\subsubsection{静电学}

首先考虑\concept{静电}的情况。所谓“静电”指的是系统中没有任何电流的情况，此时我们有$\div{\vb*{j}}=0$，从而电荷密度分布没有变化。
注意我们没有使用“电荷密度没有变化”作为定义，因为恒稳电路也具有这样的性质，但是与此同时的确有电荷流动。
在静电的条件下我们有
\[
    \curl{\vb*{E}} = - \pdv{\vb*{B}}{t}, \quad \curl{\vb*{B}} = \mu_0 \epsilon_0 \pdv{\vb*{E}}{t},
\]
然后我们会发现磁场$\vb*{B}$满足一个波动方程。看起来这非常奇怪，因为在根本没有电流的时候磁场怎么会存在呢？
这实际上是来自边界条件的不清晰。在处理电磁波时我们并不要求无穷远处场强衰减至零，因为我们实际上是认为电磁波由非常远的地方的一个源产生的，没完没了地传播到其它地方，从而处理电磁波时“无穷远处”有源是完全可以的。
在静电学中我们要求电荷约束在一个有限的范围内，从而无穷远处场强快速衰减，那么磁场满足的波动方程如果要有非平凡解，只能取类似球面波的形式，但是这样一来$\div{\vb*{B}}$会不为零，和磁场无源的条件违背。
总之，在静电学情况下$\vb*{B}=0$。于是我们就有静电学方程
\begin{equation}
    \div{\vb*{E}} = \frac{\rho}{\epsilon_0}, \quad \curl{\vb*{E}} = 0,
    \label{eq:static-e-field}
\end{equation}
或者
\begin{equation}
    \vb*{E} = - \grad{\phi}, \quad \laplacian{\phi} = - \frac{\rho_0}{\epsilon_0}.
    \label{eq:static-phi-field}
\end{equation}
这是拉普拉斯方程，有现成的解法，即
\begin{equation}
    \phi(\vb*{r}) = \int \dd[3]{\vb*{r}'} \frac{1}{4\pi \epsilon_0} \frac{\rho(\vb*{r}')}{\abs*{\vb*{r} - \vb*{r}'}}.
    \label{eq:from-q-to-phi}
\end{equation}

静电学中能量可以看成是电荷携带的而不是电场携带的。这是因为一个区域内的能量为
\[
    E = \int \dd[3]{\vb*{r}} \frac{1}{2} \epsilon_0 \vb*{E}^2 = \frac{1}{2} \epsilon_0 \int \dd[3]{\vb*{r}} (\grad{\phi})^2,
\]
做分部积分
\[
    \int \dd[3]{\vb*{r}} (\grad{\phi})^2 = 
\]

\subsubsection{静磁学}

和静电学类似，我们可以考虑恒定电流的情况，即虽然有电流但是没有任何电荷变化，电流强度也不变的情况，则由输运方程有$\div{\vb*{j}}=0$。
我们可以直接引用\eqref{eq:wave-eq-general}，得到
\[
    \frac{1}{c^2} \pdv[2]{\vb*{E}}{t} - \laplacian{\vb*{E}} = - \frac{1}{\epsilon_0} \grad{\rho} , \quad \frac{1}{c^2} \pdv[2]{\vb*{B}}{t} - \laplacian{\vb*{B}} = \mu_0 \curl{\vb*{j}},
\]
由于$\rho$和$\vb*{j}$都不随时间变化，如果我们像在静电学中一样，要求无穷远处场强衰减足够快，那么以上两式可以直接化为静态的拉普拉斯方程
\[
    \laplacian{\vb*{E}} = \frac{1}{\epsilon_0} \grad{\rho}, \quad \laplacian{\vb*{B}} = - \mu_0 \curl{\vb*{j}}.
\]
由于$\vb*{B}$不会变化，我们直接得到\eqref{eq:static-e-field}，于是就可以求解出电场。
至于$\vb*{B}$，引入磁矢势，就得到
\[
    \curl{\laplacian{\vb*{B}}} = - \mu_0 \curl{\vb*{j}},
\]
那么只需要取库伦规范$\div{A}=0$就可以有
\[
    \div{\laplacian{\vb*{B}}} = - \mu_0 \div{\vb*{j}}
\],
于是就得到
\begin{equation}
    \vb*{B} = \curl{\vb*{A}}, \quad \laplacian{\vb*{A}} = - \mu_0 \vb*{j}.
\end{equation}
这个方程的形式和\eqref{eq:static-phi-field}非常相似，也是拉普拉斯方程，从而直接可以写出
\begin{equation}
    \vb*{A}(\vb*{r}) = \int \dd[3]{\vb*{r}'} \frac{\mu_0}{4\pi} \frac{\vb*{j}(\vb*{r}')}{\abs*{\vb*{r} - \vb*{r}'}}.
    \label{eq:from-j-to-a}
\end{equation}

总之，在电荷分布不变、电流分布不变的情况下，电场可以用$\rho$表示出来，并且是无旋场；磁场可以用$\vb*{j}$表示出来。这分别称为静电学和静磁学。

\subsection{李纳-维谢尔势}

\subsection{电磁波}

\section{介质和边界条件}

\subsection{介质作用}

\eqref{eq:maxwell-eq-si}常常被称为“真空中的麦克斯韦方程”，但是实际上它当然是什么地方都适用的。
介质起作用的方式是，其内部已经有一个电荷分布，当外加电场的时候电荷重新排列、发生运动，在此过程中产生额外的电流、电场、磁场。
于是假定电荷和电流可以做以下分解：
\[
    \left\{
        \begin{aligned}
            &\vb*{j} = \vb*{j}_\text{f} + \vb*{j}_\text{r}, \quad \rho = \rho_\text{f} + \rho_\text{r}, \\
            &\pdv{\rho_\text{f}}{t} + \div{\vb*{j}_\text{f}} = 0, \\
            &\pdv{\rho_\text{r}}{t} + \div{\vb*{j}_\text{r}} = 0
        \end{aligned}
    \right.
\]
其中$\vb*{j}_\text{f}$是所谓的自由电流，而$\vb*{j}_\text{r}$是介质的响应。但是这种二分法实际上很大程度上是任意的。
例如，金属能导电，因为其内部含有大量几乎是自由的电子——那么，外加电场产生的金属中的电流就应该是自由电流了；
但是分析金属的光学属性的时候，这些由于外加电场产生的电流又无疑是介质的响应。
因此$\vb*{j}_\text{f}$和$\vb*{j}_\text{r}$只是辅助量，没有特殊的物理含义。
为了能够将$\vb*{j}_\text{f}$和$\vb*{j}_\text{r}$整合进两个形式上和电场和磁感应强度很像的辅助量，
从而在形式上让\eqref{eq:maxwell-eq-si}变成一个只和自由电荷和自由电流有关的方程组，我们进一步做下面的分解：
\[
    \vb*{j}_\text{r} = \vb*{j}_\text{s} + \vb*{j}_\text{c}
\]
且$\vb*{j}_\text{c}$是一个有旋无源场。光有这个条件不足以在给定$\vb*{j}_\text{r}$时唯一地确定下$\vb*{j}_\text{s}$和$\vb*{j}_\text{c}$，
因此还可以引入一个假设而不至于让$\vb*{j}_\text{s}$和$\vb*{j}_\text{c}$无解。
为了让\eqref{eq:maxwell-eq-si}中第一式的右边只剩下自由电荷，做以下假定，引入\concept{极化强度}$\vb*{P}$：
\[
    \rho_\textbf{r} = - \div{\vb*{P}}
\]
这个假设\emph{没有}缩小$\vb*{j}_\text{s}$和$\vb*{j}_\text{c}$的选择范围，因为任意给定性质足够良好的$\rho_\text{r}$，相对应的$\vb*{P}$总是存在的（而且显然不唯一）。
同时由于$\vb*{j}_\text{c}$是一个有旋无源场，可以再引进一个辅助量$\vb*{M}$（称为\concept{磁化强度}）使
\[
    \vb*{j}_\text{c} = \curl{\vb*{M}}
\]
此时$\rho_\text{r}$的输运方程成为
\[
    \pdv{\rho_\text{r}}{t} + \div{\vb*{j}_\text{s}} = 0
\]
因为$\curl{\vb*{j}_\text{c}}$的散度为零。这个式子又可以写成
\[
    \div{\left(\vb*{j}_\text{s}-\pdv{\vb*{P}}{t}\right)} = 0
\]
受到这个式子的启发，我们\emph{假设}（不是推出，因为光有上式不能定解，而先前我们只对$\vb*{j}_\text{c}$做过假设而没有对$\vb*{j}_\text{s}$做过假设，因此后者的取值仍然是任意的）有
\[
    \vb*{j}_\text{s} = \pdv{\vb*{P}}{t}
\]
这个假设不会让$\vb*{j}_\text{s}$和$\vb*{j}_\text{c}$无解。

将以上引入的所有物理量代入\eqref{eq:maxwell-eq-si}，得到
\[
    \begin{bigcase}
        \epsilon_0 \div{\vb*{E}} &= \rho_\text{f} - \div{\vb*{P}}, \\
        \curl{\vb*{E}} &= - \pdv{\vb*{B}}{t}, \\
        \div{\vb*{B}} &= 0, \\
        \curl{\frac{\vb*{B}}{\mu_0}} &= \vb*{j}_\text{f} + \curl{\vb*{M}} + \pdv{\vb*{P}}{t} + \epsilon_0 \pdv{\vb*{E}}{t}
    \end{bigcase}
\]
引入辅助量$\vb*{D}$和$\vb*{H}$（分别称为\concept{电位移矢量}和\concept{磁场强度}）
\begin{equation}
    \vb*{D} = \epsilon_0 \vb*{E} + \vb*{P}, \quad \vb*{H} = \frac{\vb*{B}}{\mu_0} - \vb*{M},
\end{equation}
就得到了
\begin{equation}
    \begin{bigcase}
        \div{\vb*{D}} &= \rho_\text{f}, \\
        \curl{\vb*{E}} &= - \pdv{\vb*{B}}{t}, \\
        \div{\vb*{B}} &= 0, \\
        \curl{\vb*{H}} &= \vb*{j}_\text{f} + \pdv{\vb*{D}}{t}
    \end{bigcase}
    \label{eq:maxwell-material}
\end{equation}
这就是\concept{介质中的麦克斯韦方程}。

方程组\eqref{eq:maxwell-material}除去了\eqref{eq:maxwell-eq-si}中由于介质产生的电荷密度和电流密度，形式上更加简洁，
但是即使在自由电荷密度和电流密度已经给定的情况下，只靠\eqref{eq:maxwell-material}本身也没有办法定解，因为未知数太多了。
考虑到从$\vb*{E}, \vb*{B}$到$\vb*{D}, \vb*{H}$的变换是线性的，这就意味着\eqref{eq:maxwell-eq-si}在自由电荷密度和电流密度已经给定的情况下其实也不能定解。
这是理所当然的，因为到现在为止我们没有真的描述介质如何响应自由电荷。

下面的问题是，在自由电荷密度和电流密度已经给定的情况下，增加什么方程能够让\eqref{eq:maxwell-material}定解？
当然，只要知道了从$\vb*{E}, \vb*{B}$到$\vb*{D}, \vb*{H}$的变换的具体计算式（而不是显含$\vb*{j}_\text{r}$的定义式）
就能够定解。
更进一步，在什么都不知道，只有初始条件和边界条件的情况下，怎样能够让\eqref{eq:maxwell-material}定解？
只需要增补$\vb*{j}_\text{f}$和$\vb*{E}$的显式关系，以及输运方程
\begin{equation}
    \pdv{\rho_\text{f}}{t} + \div{\vb*{j}_\text{f}} = 0
    \label{eq:transportation}
\end{equation}
就能够定解。

因此要求解出介质中的电磁场变化情况，首先需要\emph{物理方程}\eqref{eq:maxwell-material}，
然后是\emph{本构关系}也就是$\vb*{D}$，$\vb*{H}$，$\vb*{j}_\text{f}$关于其他量的表达式，最后是\emph{几何关系}\eqref{eq:transportation}，
再加上适当的边界条件和初始条件，就能够定解。

关于本构关系实际上有一个问题，就是从$\vb*{E}$，$\vb*{B}$，$\vb*{j}_\text{f}$到$\vb*{D}$和$\vb*{H}$是不是真的有一个函数关系。
如果相同的$\vb*{E}$，$\vb*{B}$，$\vb*{j}_\text{f}$实际上对应着不同的系统状态，那就糟糕了。
但是在经典电动力学中$\vb*{E}$，$\vb*{B}$是仅有的场，而如果对$\vb*{j}_\text{s}$和$\vb*{j}_\text{c}$加上足够的限制，总是可以使用$\vb*{j}_\text{f}$确定下整个$\vb*{j}$的分布，从而$\rho$的分布，因此$\vb*{E}$，$\vb*{B}$，$\vb*{j}_\text{f}$能够完全确定系统状态，从而本构关系总是可以写出来的。

\subsection{线性介质}

如果$\vb*{D}$和$\vb*{E}$、$\vb*{H}$和$\vb*{B}$之间的关系是线性的，那么这样的介质就是\concept{线性介质}。
最一般的关系是
\begin{equation}
    \vb*{D}(\vb*{r}, t) = \int \dd[3]{\vb*{r}} \dd{t} \vb*{\epsilon}(\vb*{r} - \vb*{r}', t - t') \vb*{E}(\vb*{r}', t'), \quad
    \vb*{B}(\vb*{r}, t) = \int \dd[3]{\vb*{r}} \dd{t} \vb*{\mu}(\vb*{r} - \vb*{r}', t - t') \vb*{H}(\vb*{r}', t').
\end{equation}
当然，总是可以做傅里叶变换将上式切换到频域空间。

真空是一种典型的线性介质。

\subsubsection{均匀各向同性介质}

大部分介质都是各向同性的，且没有记忆，于是
\begin{equation}
    \vb*{D} = \epsilon \vb*{E}, \quad \vb*{B} = \mu \vb*{B}.
\end{equation}
$\epsilon$和$\mu$这两个参数仍然可以在空间中发生变化。

电偶极子的图像、分子电流的图像

\subsection{介质中的电磁场能量和动量}

\subsection{边界条件}

当两个介质被贴在一起时，实际上出现了三层介质结构：两层原来的介质，一层过渡层。
通常我们并不在乎过渡层内部的细节，而只是

\begin{equation}
    \vb*{n} \cdot 
\end{equation}

\section{静电学}

本节讨论仅含有导体和线性电介质的静电系统。此时我们有

\begin{equation}
    \phi|_\text{surface} = \const,
\end{equation}
\begin{equation}
    \pdv{\phi}{\vb*{n}} = - \frac{\sigma}{\epsilon}
\end{equation}

真空中或者均匀线性电介质中不能有电势极大值或者极小值，因为在这样的区域内$\phi$是调和函数，而调和函数在它调和的区域内部不能有极大值、极小值。
物理上这很好理解，如极大值出现意味着从这一点向它周围的各个方向都有电场，因此这一点上应该有电荷，矛盾。

在计算静电系统中导体的受力时，不能简单地将无导体的空间内的电场外推到导体表面，然后使用$\vb*{f}=\sigma\vb*{E}$，因为导体表面电场是不连续的。
更加物理地看，这是因为导体表面实际上是非常复杂的一个系统：电场在微观层面快速衰减，表面上的电荷之间有相互作用力，数量级估计可以发现这些电荷之间的相互作用力和电荷受到的电场力是同阶的，因此简单的$\vb*{f}=\sigma\vb*{E}$会漏掉一部分作用力。
最为可靠的方法是使用麦克斯韦张量来计算，因为动量守恒是总是成立的，则在静电情况下动量流是连续的，所以直接计算导体外的麦克斯韦张量然后外推到导体表面即可。

\subsection{唯一性定理}



唯一性定理成立的条件是$\vb*{D}$和$\vb*{E}$之间的关系应该是一一对应的。
反之，在两者之间的关系实际上不一一对应的时候，唯一性定理就被破坏了。例如，如果$\vb*{D}-\vb*{E}$关系实际上构成了一条电滞回线，那就没有唯一性定理。

% TODO: 有限大小的体系内电荷总量应该为零：这是高斯定理的推论

\section{电路理论}

\subsection{电路理论的基本方程}

\subsubsection{似稳条件}

考虑以下特殊情况：磁场是高度局域的，也就是说某一点的电流产生的磁场的衰减特征尺度远小于我们研究的电磁场的振动频率对应的波长。
这种情况多见于体系中的电流被束缚在一些体积相对于电磁波波长不大的导体中的情况，也就是多见于\concept{电路}。
既然有介质，我们就需要考虑错综复杂的各种（可能是各向异性的、有滞后的、非线性的）响应关系。
但为了简单起见，我们还是将极化、磁化电流纳入研究范围，从而真空中的麦克斯韦方程适用。这样唯一和材料有关的就是电导率张量$\vb*{\sigma}$，它背后的物理机制是电流的动能转移给了其它组分，如晶格动能。

既然电流产生的磁场传播不了太远，磁场和电流之间的关系可以看成是瞬时的，即电流发生变化后磁场立即发生对应的变化，不需要任何传播过程（因为实际上的传播时间非常短），即可以找到一个二阶张量响应函数$\vb*{G}_{B, j}$使得
\[
    \vb*{B}(\vb*{r}, t) = \int \dd[3]{\vb*{r}'} \vb*{G}_{B, j}(\vb*{r}, \vb*{r}') \cdot \vb*{j}(\vb*{r}', t),
\]
其中$\vb*{B}$和$\vb*{j}$未必在同一个空间点上。具体的比例系数取决于电路结构。当然，很容易看出这就是对磁场应用了似稳条件。
再看电场满足的两个方程：
\[
    \div{\vb*{E}} = \frac{\rho}{\epsilon_0}, \quad \curl{\vb*{E}} = - \pdv{\vb*{B}}{t} \sim - \pdv{\vb*{j}}{t},
\]
根据矢量场的亥姆霍兹分解定理，我们有
\[
    \vb*{E}(\vb*{r}, t) = \int \dd[3]{\vb*{r}'} \vb*{G}_{E, \rho}(\vb*{r}, \vb*{r}') \rho(\vb*{r}', t) - \int \dd[3]{\vb*{r}'} \vb*{G}_{E, \partial_t j}(\vb*{r}, \vb*{r}') \cdot \pdv{\vb*{j}(\vb*{r}', t)}{t} ,
\]
其中$\vb*{G}_{E, \rho}$是一个矢量而$\vb*{G}_{E, \partial_t j}$是一个二阶张量。
第二项前面的负号是为了体现电场总是倾向于削弱电流变化，即楞次定律。
最后，假定电流对电场和非电场力的响应是线性的，即
\begin{equation}
    \vb*{j} = \vb*{\sigma} \cdot (\vb*{E} + \vb*{K}),
\end{equation}
我们有
\[
    \vb*{j}(\vb*{r}, t) = \vb*{\sigma}(\vb*{r}) \cdot \left( \vb*{K}(\vb*{r}, t) + \int \dd[3]{\vb*{r}'} \vb*{G}_{E, \rho}(\vb*{r}, \vb*{r}') \rho(\vb*{r}', t) - \int \dd[3]{\vb*{r}'} \vb*{G}_{E, \partial_t j}(\vb*{r}, \vb*{r}') \cdot \pdv{\vb*{j}(\vb*{r}', t)}{t} \right),
\]
两边对时间求导数，得到
\begin{equation}
    \int \dd[3]{\vb*{r}'} \vb*{G}_{E, \rho}(\vb*{r}, \vb*{r}') \div{\vb*{j}}(\vb*{r}', t) + \int \dd[3]{\vb*{r}'} \vb*{G}_{E, \partial_t j}(\vb*{r}, \vb*{r}') \cdot \pdv[2]{\vb*{j}(\vb*{r}', t)}{t} + \vb*{\rho} \cdot \pdv{\vb*{j}}{t} = \pdv{\vb*{K}}{t}.
    \label{eq:circuit-eq}
\end{equation}
其中$\vb*{\rho}$是电阻率张量，它是$\vb*{\sigma}$的逆。
可以看到：
\begin{itemize}
    \item \eqref{eq:circuit-eq}的右边是外部激励，这对应\concept{电源}，其余元件，相应地，可以称为\concept{用电器}；
    \item 左边第一项来自静电力，即电荷堆积在某处会影响电场，这种现象就是\concept{电容}，请注意从电荷到电场分布的关系和静电学完全一致；
    \item 左边第二项是电流产生磁场，磁场又产生感生电场的结果，如果我们研究的一部分$\vb*{j}$是给定的，那么这一部分$\vb*{j}$也可以认为是产生一个一个感生电源，这种现象就是\concept{电感}，同样，从电流到磁场的关系也和静磁学一样；
    \item 左边第三项来自$\vb*{j}$和$\vb*{E}$的线性关系，也就是来自\concept{电阻}。
\end{itemize}

在一般的变化的电磁场中，由于$\vb*{E}$的有旋部分依赖于$\vb*{B}$而$\vb*{B}$又以一种非常复杂的方式依赖于$\vb*{E}$，“电压”的概念用处不大。
但在\eqref{eq:circuit-eq}中，虽然$\vb*{E}$显然有有旋部分（电感导致的结果），但是由于$\vb*{B}$被假定可以瞬时地被$\vb*{j}$确定，实际上电感导致的那部分$\vb*{E}$是完全可以写成电流的导数的函数的，从而电感导致的无非是一个“感生电动势”而已。
因此在电路理论中，虽然我们要讨论变化的电磁场，（满足基尔霍夫电压方程的）电压的概念仍然是有用的，虽然将什么量当成电压仍然不确定。实际上，“电压”此时是可以胡乱定义的，因为唯一将电流和电场、磁场联系起来的有意义的方程是
\[
    \vb*{j} = \vb*{\sigma} \cdot (\vb*{E} + \vb*{K}),
\]
在其中$\vb*{K}$和$\vb*{E}$是完全等价的，那么把其中一部分的线积分称为电压，把其中另一部分的线积分称为电动势，不会有任何影响。
一般来说我们有这样几种选择：
\begin{enumerate}
    \item 要求“电压等于电流乘以电阻”成立，则电容、电感、电源全部当成电动势，即将电容和电感等效为电源。
    \item 要求“电压是静电场的线积分”，则电感、电源被当成电动势。
    \item 要求“电压就是和电源平衡的物理量”，即直接要求$U=\mathcal{E}$，即将电容、电感都当成用电器。
\end{enumerate}
这三种选择其实无非是将\eqref{eq:circuit-eq}的各项在等号左右移动罢了。

辅以适当的边界条件和初始条件，\eqref{eq:circuit-eq}给出了电路系统的全部性质——一个电路系统完全由电容、电阻、电感，以及初始条件和外界激励确定。
此外，求解它也是可行的，因为虽然\eqref{eq:circuit-eq}中出现了遍及全空间的积分，看起来非常复杂，但是既然我们假定磁场局限在很小的范围内，而能够约束磁场的边界条件往往也能约束电，那么其实这些积分也局限在相比于波长很小的范围内。

\eqref{eq:circuit-eq}是无记忆的，但那是我们把所有电荷都纳入考虑的结果。
如果我们只考虑一部分电荷和电流（比如说只考虑“自由电荷”而将极化、磁化当成一个黑箱子），那么介质就可以有内部状态，那么就可以是有记忆的；此时需要将\eqref{eq:circuit-eq}中的所有$G$换成$G(t-t')$，将等式左边的所有$t$时刻的物理量取为$t'$时刻，并且加一个对$t'$的积分。
此外如果我们讨论的系统非常大，以至于一点发生的变化需要较长的时间才能够传到另一点，那么也需要做上述操作。
当然，这实际上就是积掉一部分自由度导致推迟相互作用的典型例子。

\subsubsection{几个时间尺度}

在\eqref{eq:circuit-eq}适用的前提下，我们还可以做出更多简化。我们有几个时间尺度：导体达到静电平衡的弛豫时间，电磁场传播的时间（系统长度尺度除以光速），电压、电流变化的时间尺度（实际上就是外界策动的频率尺度的倒数）。
我们来分析这些时间尺度的意义。

在各向同性的均匀材料内部，电导率张量退化为一个标量$\sigma$，我们有
\[
    \div{\vb*{j}} = \sigma \div{\vb*{E}} = \sigma \frac{\rho}{\epsilon_0},
\]
而由电流输运方程\eqref{eq:charge-transportation}，我们有
\[
    \pdv{\rho}{t} + \frac{\sigma}{\epsilon_0} \rho = 0.
\]
这就是说，均匀导电材料内存不住电荷——量级为
\begin{equation}
    \tau_\text{relax} = \frac{\epsilon_0}{\sigma}
    \label{eq:static-relaxation-time}
\end{equation}
的弛豫时间过后元件内部的电荷密度降为零。原本的电荷或者被导线导走了，或者转移到了元件中不均匀的地方——例如说元件表面或是不同材料的交界面。
这又意味着，弛豫时间过后，我们有
\[
    \div{\vb*{j}} = 0,
\]
即流入该区域的电流和流出该区域的电流相同。

在实际的电路问题中，基本上弛豫时间都远小于我们关心的时间尺度，因此我们将忽略此弛豫过程；如果弛豫过程真的如此重要，那么通常电路理论也是不够用的。
此外，注意到\eqref{eq:static-relaxation-time}正是导体达到静电平衡需要的时间，通常可以保证系统中各个量的变化的时间尺度远大于\eqref{eq:static-relaxation-time}，那么电荷聚集情况可以直接使用静电平衡的有关理论来分析。%
\footnote{\eqref{eq:circuit-eq}只是保证了从电荷到电场的关系是静电学的，没有保证从电场到电荷的关系也是静电学的。例如，一个金属圆球上不均匀地分布着一些电荷这个场景可能出现在\eqref{eq:circuit-eq}中，但是不可能出现在系统中各个量的变化的时间尺度远大于\eqref{eq:static-relaxation-time}的情况下。}%
需要注意的是弛豫时间\eqref{eq:static-relaxation-time}和“充放电时间”不是一回事：很多体系，比如平行板电容器，会有很明显的充电和放电过程，但是这些过程的每一瞬时，体系状态都可以近似当成静电平衡的，变化的只是体系中的总电荷量。

既然电路理论中弛豫时间总是非常小的，接下来只需要比较电磁场传播时间$\tau_\text{prop}$和电路状态变化的时间尺度$\tau_\text{change}$即可。
如果$\tau_\text{prop}$远小于$\tau_\text{change}$，即
\begin{equation}
    L \ll c \tau_\text{change} = \frac{c}{f_\text{change}},
\end{equation}
则系统的内部状态基本上是均匀的，可以用几个数值（电荷总量、电流、电压、磁通量，等等）表示，即描述系统的行为只需要常微分方程。此时的系统称为\concept{集总}的。
反之，如果$\tau_\text{prop}$并不远小于$\tau_\text{change}$，那么系统的内部状态就需要使用空间分布来描述（如电荷密度、电流密度），此时的系统称为\concept{分布}的。

\subsubsection{初始条件和衔接条件}

关于初始条件，虽然初始条件可以任意选取，但很容易想到，实际的初始条件无非这么几类：通电，即原本没有任何$\vb*{K}$而突然加上了$\vb*{K}$；电路结构改变，如开关

% TODO:通电之后，需要发生的弛豫过程包括：电场传播；均匀介质内部电荷清除；静电平衡？（它和前一个一致吗？）；或者也许还有别的；传输线模型放弃了哪个假设？

可以将初始静电电荷当成0，因为叠加原理 % TODO

\subsection{集总元件}

电路中的\concept{元件}指的是这样的体系：除了其与外界连接的端口外，外界的电磁场基本被它的边界屏蔽，它内部的电磁场也不影响外界。
换而言之，元件与外界仅有的交互就是它和外界连接的电流端口，并且这个端口的尺寸非常小以至于无论电流密度在端口上怎么分布，真的会显著影响元件行为的只是总电流，
否则元件与外界的连接处的电流密度分布会显著影响元件内部的电场的分布，即元件和外界的连接处的电场分布会显著影响元件行为，那么再称这样的装置为元件就不合适了。
一个电路可以认为是不同的元件使用\concept{理想导线}——无电阻、电容、电感，其上也没有任何$\vb*{K}$的导线——连接而成的。
\concept{集总元件}就是空间尺度足够小，从而其行为可以完全使用常微分方程描述——其状态无需使用空间上的分布来描述，如只需要一个电荷量即可确定其状态而不需要电荷密度，在时间上也不存在延迟，输入和输出之间关系是瞬时的——的元件。

现在我们来看有哪些集总元件。我们首先讨论一系列理想的集总元件，然后会惊讶地发现，仅仅依靠这些概念实际上就能够很好地描述一个由集总元件构成的电路，甚至分布电路。

\subsubsection{常见理想元件}

% 二端口各向同性均匀材料集总元件

考虑一个使用各向同性均匀材料（可以多种材料贴在一起）做成的二端口集总元件。
我们只讨论$\tau_\text{relax}$之后的情况，因此输入电流等于输出电流。
这样，集总元件的行为完全可以由关于它两端的电压和流经它的电流满足的关系（未必是函数关系，可能是一个微分方程）确定。

本节先只讨论几种常见的二端口集总元件。首先我们有\concept{理想电源}，就是一个单纯提供一个$\vb*{K}$的元件。
由于是集总元件，对$\vb*{K}$求线积分，积分路径两端为输入端口和输出端口，取不同路径不会有太大差别，于是设
\begin{equation}
    \mathcal{E} = \int \dd{\vb*{l}} \cdot \vb*{K}
\end{equation}
为\concept{电源电动势}。

然后讨论\concept{理想电容器}。理想电容器有两个互不相交的电荷可以聚集的区域（比如说导体边界），除此以外没有电流也没有电荷，也没有任何电动势。
没有电流意味着没有感生电动势，两个电荷聚集区域之间没有电流意味着元件内部也没有空间电流密度，从而元件行为由
\[
    \int \dd[3]{\vb*{r}'} \vb*{G}_{E, \rho}(\vb*{r}, \vb*{r}') \div{\vb*{j}}(\vb*{r}', t) + \pdv{\vb*{E}}{t} = 0
\]
完全确定，或者说由
\[
    \int \dd[3]{\vb*{r}'} \vb*{G}_{E, \rho}(\vb*{r}, \vb*{r}') \rho(\vb*{r}', t) = \vb*{E}
\]
完全确定。由于元件内净电荷为0，两个电荷聚集区域含有的电荷数量相等而正负号相反，记它们的绝对值为$Q$。由线性性，$Q$增大或者减小并不改变元件内部的电场线形状，而只是改变电场大小，电场线形状由两个电荷聚集区的几何形状确定，由于电路理论中假设电荷分布近似为静电分布，电荷密度的分布也由两个电荷聚集区的几何形状确定。
因此只需要一个$Q$就可以完整描述理想电容器的状态。这样我们就可以写出
\begin{equation}
    U = \frac{Q}{C},
    \label{eq:capacity}
\end{equation}
其中$U$为理想电容器两端的电压，而$C$是一个常数，也称为\concept{电容}；行为满足\eqref{eq:capacity}的二端口集总元件统称为\concept{电容器}或者简称电容。
从\eqref{eq:capacity}也可以看出
\[
    \dv{U}{t} = \frac{I}{C}.
\]

我们再来看\concept{理想电感器}，在理想电感器中没有电荷聚集区，没有电动势，也没有任何电阻，只有从一个端口进，连续流至另一个端口的电流。
这样，控制方程就是
\[
    \int \dd[3]{\vb*{r}'} \vb*{G}_{E, \partial_t j}(\vb*{r}, \vb*{r}') \cdot \pdv{\vb*{j}(\vb*{r}', t)}{t} + \vb*{E} = 0.
\]

最后是\concept{理想电容器}，

电容、电阻、电感都是\concept{线性元件}，也就是说描述它们的行为的方程都是线性的。

\subsubsection{分布参数}

实际的集总元件的结构当然比这些

分布参数的出现并不意味着电路就是分布的

简单地说：把感生电动势单独用磁通量表示，带有电容的电阻就是电阻和电容并联。
% TODO

从结构确定集总元件参数的步骤：加电流，绘制电流管线图，计算电阻；加电荷，绘制电场线图，算电容；然后加入感生电动势。
能这么做是因为叠加原理。

\subsubsection{介质}

在以上推导中我们显式用到介质性质的地方只有电阻。

\subsection{分布元件}

% TODO：分布元件转化为集总元件 ；是否这总是可行的？
集总元件中，输入和输出之间的关系是瞬时的：输入变化后元件瞬间弛豫，输出马上改变。
对于尺度非常大的系统这当然不是事实。

\section{电磁场和波函数}

单粒子量子力学中的波函数和电磁场有看起来很相似的性质：它们在数学上都是经典场，即从空间坐标到实数或复数（实际上，也可以将电磁场当成复数以引入电磁波的相位因子）的映射；它们均服从带有拉普拉斯算符的波动方程。
但是，波函数和电磁场实际上是非常不同的自由度。前者是一个量子理论中的系统状态，并且\concept{不是}一个描述了电子的场论的场自由度，后者是经典理论中的系统状态，同时也是经典的“可观察算符”。


\end{document}
