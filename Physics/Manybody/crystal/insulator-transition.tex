\chapter{相互作用导致的金属-绝缘体转变}\label{chap:interaction-transition}

\section{杂质导致的金属局域磁矩}

\subsection{Anderson模型}\label{sec:anderson-model}

考虑一个无相互作用的体系，我们在其中引入一个杂质，并且假定该杂质能够将电子紧密地约束在其周围。
这样一来我们就有了两套能级：一套是原本的费米液体，还有一套是一个单独的能级，处于这个能级的电子被束缚在杂质周围。
需要使用晶格动量和自旋标记前者（仅考虑能量最低的能带），称为\concept{巡游电子}，因为它的波函数是布洛赫波函数，并不定域；后者是定域的，只需要使用自旋即可标记后者，称为\concept{d电子}（因为很多时候这个轨道是杂质的d轨道）。
前者和后者可以自然地转化，即两者之间有\concept{杂化}。
于是描述它们的模型就是以下\concept{单杂质的Anderson模型}：
\begin{equation}
    {H} = \sum_{\vb*{k}, \sigma} (\epsilon_{\vb*{k}} - \mu) {c}_{\vb*{k}\sigma}^\dagger {c}_{\vb*{k} \sigma} + \sum_\sigma \epsilon_\text{d} {c}_{\text{d}\sigma}^\dagger {c}_{\text{d} \sigma} + \sum_{\vb*{k}, \sigma} V_{\vb*{k} \text{d}} {c}_{\vb*{k} \sigma}^\dagger {c}_{\text{d} \sigma} + \text{h.c.} + U {n}_{\text{d} \uparrow} {n}_{\text{d} \downarrow}.
    \label{eq:impurity-anderson}
\end{equation}
不失一般性地认为$V_{\vb*{k} \text{d}}$都是实数，如果它不是实数，那总是可以通过重新定义${c}_{\vb*{k} \text{d}}$（乘上一个复数因子）来让它变成实数。
最后一项是因为同处于d能级的两个电子之间会有库伦排斥作用，这一项实际上是唯一的真正的相互作用，因为前三项都是二次型。请注意这一项具有自选旋转不变性，这也是合理的。
与d轨道上的自旋-自旋排斥相比，巡游电子相互作用不会有显著的影响。

\begin{figure}
    \centering

    \input{insulator-transition-figs/anderson/model.tex}

    \caption{Anderson模型，d电子可以和巡游电子相互转换（使用红色和蓝色的波浪线表示），不同自旋的d电子相互排斥（灰色波浪线）}
    \label{fig:anderson-model}
\end{figure}

d电子的相互作用项意味着d轨道上出现两个电子会大大增大能量，如果费米面位于d轨道出现一个电子和d轨道出现两个电子的能量之间，那么巡游电子总会填充d轨道，而且填充一个电子，其结果就是产生杂质附近的局域磁矩。
实际上，这样会导致一个低能有效理论，见\autoref{sec:kondo-effect}。
本节则主要观察什么时候会出现一个局域磁矩，即什么时候会出现对称性自发破缺。

在展开计算之前，首先尝试做一些定性的分析。记能谱展宽为$\Delta$，则由费米黄金法则，
\[
    \Delta \propto \frac{1}{\tau} \propto \sum_{\vb*{k}} \abs{V_{\vb*{k} \text{d}}}^2 N(\epsilon_\text{d}).
\]
只有$U$很大时才能够产生局域磁矩，否则d轨道可以很容易地填满。
当$U \gg \epsilon_\text{d} \gg \Delta$时，d电子能谱发生弱展宽，但仍然有清晰的能级，并且会有一个良定义的局域磁矩。
而当$U \gg \Delta \gg \epsilon_\text{d}$时能级已经很不清楚，d电子可以和费米海中大范围的电子发生相互作用，因此虽然d轨道上只有一个电子，但它会频繁地发生自旋翻转，因此不会有局域磁矩。

\subsection{平均场近似}

相互作用项为
\[
    U {n}_{\text{d} \uparrow} {n}_{\text{d} \downarrow} = U {c}_{\text{d} \uparrow}^\dagger {c}_{\text{d} \uparrow} {c}^\dagger_{\text{d} \downarrow} {c}_{\text{d} \downarrow},
\]
现在尝试应用平均场近似。假定体系近似自由，我们有
\[
    \begin{aligned}
        \expval{U {n}_{\text{d} \uparrow} {n}_{\text{d} \downarrow}} &= U \expval*{{c}_{\text{d} \uparrow}^\dagger {c}_{\text{d} \uparrow} {c}^\dagger_{\text{d} \downarrow} {c}_{\text{d} \downarrow}} \\
        &= U ( \expval*{{c}_{\text{d} \uparrow}^\dagger {c}_{\text{d} \uparrow}} \expval*{{c}_{\text{d} \downarrow}^\dagger {c}_{\text{d} \downarrow}} + \expval*{{c}_{\text{d} \uparrow}^\dagger {c}_{\text{d} \downarrow}} \expval*{{c}_{\text{d} \uparrow} {c}^\dagger_{\text{d} \downarrow}} ),
    \end{aligned}
\]
第二项如果有非零值，$z$方向上的自旋旋转对称性就破缺了。
确实有这样的可能，就是系统基态有对称性自发破缺，但这里暂时假定没有这种情况。%
\footnote{从这里也可以看到平均场近似总是倾向于高估系统的对称性破缺，因为我们完全可以假定$z$方向上的自旋旋转对称性真的破缺了，从而得到一个$z$方向上自选旋转对称性真的破缺的平均场理论。
}%
这样就有
\[
    \expval{U {n}_{\text{d} \uparrow} {n}_{\text{d} \downarrow}} = U \expval*{{c}_{\text{d} \uparrow}^\dagger {c}_{\text{d} \uparrow}} \expval*{{c}_{\text{d} \downarrow}^\dagger {c}_{\text{d} \downarrow}},
\]
这又告诉我们，我们有
\[
    \expval{U {n}_{\text{d} \uparrow} {n}_{\text{d} \downarrow}} = \expval{ U {n}_{\text{d} \uparrow} \expval*{{n}_{\text{d} \downarrow}} + U \expval*{{n}_{\text{d} \uparrow}} {n}_{\text{d} \downarrow} - U \expval*{{n}_{\text{d} \uparrow}} \expval*{{n}_{\text{d} \downarrow}} },
\]
那么如果相互作用哈密顿量适用平均场近似我们就有
\begin{equation}
    U {n}_{\text{d} \uparrow} {n}_{\text{d} \downarrow} \approx U {n}_{\text{d} \uparrow} \expval*{{n}_{\text{d} \downarrow}} + U \expval*{{n}_{\text{d} \uparrow}} {n}_{\text{d} \downarrow} - U \expval*{{n}_{\text{d} \uparrow}} \expval*{{n}_{\text{d} \downarrow}}.
\end{equation}
当然，这只是一种可能的平均场分解——没有理由认为这就是最理想的近似，但实际上使用变分计算可以确定这确实是最理想的近似。
忽略仅改变能量零点的常数项，得到平均场哈密顿量
\begin{equation}
    {H}_\text{MF} = \sum_{\vb*{k}, \sigma} \xi_{\vb*{k}} {c}_{\vb*{k}\sigma}^\dagger {c}_{\vb*{k} \sigma} + \sum_\sigma \epsilon_\text{d} {c}_{\text{d}\sigma}^\dagger {c}_{\text{d} \sigma} + \sum_{\vb*{k}, \sigma} V_{\vb*{k} \text{d}} {c}_{\vb*{k} \sigma}^\dagger {c}_{\text{d} \sigma} + \text{h.c.} + U {n}_{\text{d} \uparrow} \expval*{{n}_{\text{d} \downarrow}} + U \expval*{{n}_{\text{d} \uparrow}} {n}_{\text{d} \downarrow}.
    \label{eq:anderson-mf}
\end{equation}
这是一个二次型哈密顿量。\eqref{eq:anderson-mf}含有不确定的参数$\expval*{{n}_{\text{d} \uparrow}}$和$\expval*{{n}_{\text{d} \downarrow}}$（这两个参数实际上是序参量，它们的差给出了$z$轴上的磁矩），但是可以将它们当成参数，求解出${n}_{\text{d} \uparrow}$和${n}_{\text{d} \downarrow}$之后回代，从而形成自洽方程。

求解\eqref{eq:anderson-mf}，在适当的条件上我们会看到$\expval*{{n}_{\text{d} \uparrow}} - \expval*{{n}_{\text{d} \downarrow}}$不等于零，即出现了一个自发磁矩。
虽然出现了一个局域磁矩，但这和我们的假定——$z$方向上自选旋转不变——并不矛盾，因为$z$方向上的自旋破缺的是$x$或$y$方向的自旋旋转不变性。
换而言之，以上我们证明的结论是：平均场理论下，$x, y, z$三个方向上的自选旋转不变性不可能全部保留，保留$z$轴的自旋旋转不变性就必定破坏其它两个方向的自选旋转不变性。

可以对\eqref{eq:anderson-mf}做对角化。定义
\begin{equation}
    E_{\text{d} \sigma} = \epsilon_\text{d} + U \expval*{{n}_{\text{d} (-\sigma)}},
    \label{eq:energy-d-sigma}
\end{equation}
则
\begin{equation}
    {H}_\text{MF} = \sum_{\vb*{k}, \sigma} \xi_{\vb*{k}} {c}_{\vb*{k}\sigma}^\dagger {c}_{\vb*{k} \sigma} + \sum_\sigma E_{\text{d} \sigma} {c}_{\text{d}\sigma}^\dagger {c}_{\text{d} \sigma} + \sum_{\vb*{k}, \sigma} V_{\vb*{k} \text{d}} {c}_{\vb*{k} \sigma}^\dagger {c}_{\text{d} \sigma} + \text{h.c.}
\end{equation}
下面要对角化该哈密顿量。设已有对角化形式
\[
    {H}_\text{MF} = \sum_{n, \sigma} \epsilon_{n \sigma} {c}^\dagger_{n\sigma} {c}_{n\sigma},
\]
其中$n$是某个未知的量子数，${c}_{n \sigma}$可以写成${c}_{\vb*{k} \sigma}$和${c}_{\text{d} \sigma}$的幺正变换，通过要求对易关系一致（或者别的什么技巧）就得到方程组
\begin{equation}
    \begin{aligned}
        \epsilon_{n\sigma} \braket{\vb*{k}\sigma}{n \sigma} &= \braket{\vb*{k} \sigma}{n \sigma} \xi_{\vb*{k}} + \braket{\text{d} \sigma}{n \sigma} V_{\vb*{k} \text{d}}, \\
        \epsilon_{n \sigma} \braket{\text{d} \sigma}{n \sigma} &= \braket{\text{d} \sigma}{n \sigma} E_{\text{d} \sigma} + \sum_{\vb*{k}} \braket{\vb*{k} \sigma}{n \sigma} V_{\vb*{k} \sigma}.
    \end{aligned}
\end{equation}
求解此方程组，并加入幺正性条件，就可以完成对角化。

\subsection{平均场近似下的格林函数}

由于系统自旋守恒，两个自旋不同的算符的格林函数为零，因此可以使用$G_{\text{dd}, \sigma}$标记d轨道电子的格林函数，用$G_{\vb*{k} \text{d}, \sigma}$标记从$\vb*{k}$动量的巡游电子跃迁为d电子的格林函数。
从一个巡游电子到另一个巡游电子的过程动量守恒（因为相当于积掉了d电子自由度），用$G_{\vb*{k}\sigma}$标记这个过程的格林函数。
我们并不会计算这些格林函数，于是首先考虑$n$-$\sigma$表象下的格林函数，然后再使用表象变换得到d电子或者别的什么东西的格林函数。
要计算d点子格林函数是为了计算$\expval*{{n}_{\text{d}\uparrow}}$和$\expval*{{n}_{\text{d}\downarrow}}$。

在$n$-$\sigma$表象下哈密顿量对角，于是使用$G_{n\sigma}$标记$n$表象电子的格林函数。
首先考虑松原格林函数，考虑到$n$表象下系统是自由的，有
\begin{equation}
    G_{n\sigma} (\omega_n) = \frac{1}{\ii \omega_n - \epsilon_n},
\end{equation}
请注意这里有两种$n$：$\omega_n$中的$n$标记频率，$\epsilon_n$和$G$的下标中的$n$则是量子数。
虚频单电子格林算符定义为
\[
    (\ii \omega_n - {h}_\text{MF}) {G}(\omega_n) = 1,
\]
使用$G_{n \sigma}$，单电子格林算符就是
\begin{equation}
    {G}(\omega_n) = \sum_{n, \sigma} \frac{\dyad{n\sigma}}{\ii \omega_n - \epsilon_n} = \frac{1}{\ii \omega_n - {h}_\text{MF}},
\end{equation}
其中${h}_\text{MF}$就是单体哈密顿量，为
\begin{equation}
    {h}_\text{MF} = \sum_{\vb*{k}, \sigma} \xi_{\vb*{k}} \dyad{\vb*{k} \sigma} + \sum_\sigma E_{\text{d} \sigma} \dyad{\text{d} \sigma} + \sum_{\vb*{k}, \sigma} V_{\vb*{k} \text{d}} ( \ket{\vb*{k} \sigma} \bra{\text{d} \sigma} + \text{h.c.} ).
    \label{eq:anderson-green-operator}
\end{equation}
格林算符在不同表象下的矩阵元就给出了全部的单电子格林函数（或者说二算符格林函数）。

计算\eqref{eq:anderson-green-operator}在$\vb*{k}, \text{d}$表象下的不同矩阵元，可以得到$G_{\text{dd}, \sigma}$，$G_{\vb*{k} \text{d}, \sigma}$和$G_{\vb*{k}, \sigma}$之间的关系。
可以预期$G_{\vb*{k}, \sigma}$和自由情况不会差太多，因为巡游电子远远多于d电子。
d电子的格林函数相对自由电子格林函数则会有较大的修正，具体而言，是
\begin{equation}
    (G_{\text{dd}, \sigma}(\omega_n))^{-1} = \ii \omega_n - E_{\text{d}\sigma} - \sum_{\vb*{k}} \frac{V_{\vb*{k}\text{d}}^2}{\ii \omega_n - \epsilon_{\vb*{k}}}.
\end{equation}
相应的推迟格林函数是
\begin{equation}
    (G_{\text{dd}, \sigma}^\text{ret}(\omega))^{-1} = \omega - E_{\text{d}\sigma} - \sum_{\vb*{k}} \frac{V_{\vb*{k}\text{d}}^2}{\omega - \epsilon_{\vb*{k}} + \ii 0^+}.
\end{equation}
自能修正为
\begin{equation}
    \Sigma_{\text{d} \sigma}^\text{ret} = \sum_{\vb*{k}} \frac{V_{\vb*{k}\text{d}}^2}{\omega - \epsilon_{\vb*{k}} + \ii 0^+} = \frac{V}{(2\pi)^3} \int \dd[3]{\vb*{k}} \frac{V_{\vb*{k}\text{d}}^2}{\omega - \epsilon_{\vb*{k}} + \ii 0^+}.
\end{equation}
它来自d电子通过和巡游电子作用，间接地“自己和自己相互作用”。它的实部带来能级修正，它的虚部就是能级展宽的量级。
实部是通常的柯西积分主值
\[
    \Re \Sigma_{\text{d} \sigma}^\text{ret} = \frac{V}{(2\pi)^3} \primevalue \int \dd[3]{\vb*{k}} \frac{V_{\vb*{k}\text{d}}^2}{\omega - \epsilon_{\vb*{k}} + \ii 0^+},
\]
虚部为
\[
    \Im \Sigma_{\text{d} \sigma}^\text{ret} = - \frac{V}{(2\pi)^3} \int \dd[3]{\vb*{k}} \pi \delta(\omega - \epsilon_{\vb*{k}}) V_{\vb*{k} \text{d}}^2 .
\]
我们在费米面附近工作，从而%
\footnote{
    一种看起来更加舒服的记号是
    \[
        \Im \Sigma_{\text{d} \sigma}^\text{ret} = - \sum_{\vb*{k}} \pi \delta(\omega - \epsilon_{\vb*{k}}) V_{\vb*{k} \text{d}}^2,
    \]
    但是要注意，由于$1 / (\omega + \ii 0^+)$的虚部是$- \pi \ii \delta(\omega)$这件事其实只有在积分中成立，上式的求和号后的一串$\delta$函数必须要做一定的平滑化处理才能让这个求和有定义，否则一串$\delta$函数的求和是非常奇怪的。
}%
\[
    \begin{aligned}
        \Im \Sigma_{\text{d} \sigma}^\text{ret} &= - \pi \expval*{V_{\vb*{k} \text{d}}^2}_\text{FS} \frac{V}{(2\pi)^3} \int \dd[3]{\vb*{k}} \delta(\omega - \epsilon_{\vb*{k}}) \\
        &= - \pi \expval*{V_{\vb*{k} \text{d}}^2}_\text{FS} N(\omega).
    \end{aligned}
\]
费米子谱函数为
\[
    A_{\text{d} \sigma} = -\frac{1}{\pi} \Im G_{\text{d} \sigma}^\text{ret},
\]
它在$\omega = E_{\text{d} \sigma}$附近有峰，其它位置接近零。
由于通常能级展宽很小，在计算谱函数时假定自能中的$\omega$始终取$E_{\text{d} \sigma}$，同时将自能修正归入$E_{\text{d} \sigma}$。（$E_{\text{d} \sigma}$是做过重整化的，所以它到底取什么值根本就不知道，因此将自能实部也归入其中是合理的）
以自能虚部绝对值为能级展宽量级，记作
\begin{equation}
    \Delta = \pi \expval*{V_{\vb*{k} \text{d}}^2}_\text{FS} N(\omega),
\end{equation}
谱函数就是
\begin{equation}
    A_{\text{d}\sigma} = \frac{1}{\pi} \frac{\Delta}{(\omega-E_{\text{d}\sigma})^2 + \Delta^2}.
    \label{eq:anderson-spectral}
\end{equation}

\subsection{平均场自洽计算}

我们现在完成平均场计算的最后一步，即获得关于平均场序参量$\expval*{{n}_{\text{d} \uparrow}}$和$\expval*{{n}_{\text{d} \downarrow}}$的自洽方程。
由谱函数的性质可以计算出
\[
    \expval*{{n}_{\text{d} \sigma}} = \int \dd{\omega} A_{\text{d} \sigma} f(\omega),
\]
上式与\eqref{eq:energy-d-sigma}和\eqref{eq:anderson-spectral}联立，就得到自洽方程
\begin{equation}
    \begin{aligned}
        \expval*{{n}_{\text{d} \sigma}} &= \int \dd{\omega} \frac{1}{\pi} \frac{\Delta}{(\omega-E_{\text{d}\sigma})^2 + \Delta^2} f(\omega), \\
        E_{\text{d} \sigma} &= \epsilon_\text{d} + U \expval*{{n}_{\text{d} (-\sigma)}}.
    \end{aligned}
\end{equation}
例如，在零温情况下，就得到自洽方程
\begin{equation}
    \expval*{{n}_{\text{d} \sigma}} = \frac{1}{\pi} \arccot \left( \frac{\epsilon_{\text{d}} + U \expval*{{n}_{\text{d} (-\sigma)}}}{\Delta} \right).
    \label{eq:anderson-zero-temperature-sc}
\end{equation}
这个三角超越方程难以写出解析解。为了观察它能否给出自发局域磁矩，考虑$\epsilon_{\text{d}} = - U / 2$的情况（此时实际上有电子-空穴对称性），且基态d轨道总占据数应该是1，这样
\[
    \expval*{{n}_{\text{d} \uparrow}} + \expval*{{n}_{\text{d} \downarrow}} = 1,
\]
我们设
\[
    \expval*{{n}_{\text{d} \uparrow, \downarrow}} = \frac{1}{2} \pm x,
\]
若出现自发磁矩则$x$不为零。此时\eqref{eq:anderson-zero-temperature-sc}为
\[
    x = \frac{1}{\pi} \arctan \left( \frac{U}{\Delta} x \right).
\]
$x=0$是平凡解；当
\[
    \frac{\pi \Delta}{U} < 1
\]
时，有三个解，也即会有沿着$z$轴的局域磁矩。这是符合直觉的，因为当$\Delta$比较大，即$V_{\vb*{k} \text{d}}$比较大时，巡游电子和d轨道电子不停发生相互作用，d轨道电子的自旋会不断上下翻转，因此不应该有局域磁矩。
这和\autoref{sec:anderson-model}中的分析一致。

\section{Kondo效应}\label{sec:kondo-effect}

\subsection{Anderson单杂质模型的低能有效理论}

在\eqref{eq:impurity-anderson}中$U > \abs{\epsilon_\text{d}} \gg V$时，d轨道上通常会有单个电子，从而导致一个局域磁矩。
我们使用平均场近似得到了一些定性的结果，本节则讨论在此基础上的涨落。平均场使用相互作用的平均值代替它本身，但是在这个平均值上还有热涨落和量子涨落。
$U > \abs{\epsilon_\text{d}}$意味着空的d轨道、半满的d轨道、全满的d轨道分得非常开，因此我们只讨论仅涉及单满的d轨道的一个低能有效模型，为此需要把空的d轨道、全满的d轨道这两个态积掉，而只保留低能子空间，即半满d轨道。

使用二阶微扰论处理这个问题，此时我们的任务是找到${H}$在二阶微扰下的本征值（本征矢并不重要）。如下将Anderson模型分成两部分：
\[
    {H} = \underbrace{\sum_{\vb*{k}, \sigma} (\epsilon_{\vb*{k}} - \mu) {c}_{\vb*{k}\sigma}^\dagger {c}_{\vb*{k} \sigma} + \sum_\sigma \epsilon_\text{d} {c}_{\text{d}\sigma}^\dagger {c}_{\text{d} \sigma} + U {n}_{\text{d} \uparrow} {n}_{\text{d} \downarrow}}_{{H}_0} + \underbrace{\sum_{\vb*{k}, \sigma} V_{\vb*{k} \text{d}} {c}_{\vb*{k} \sigma}^\dagger {c}_{\text{d} \sigma} + \text{h.c.}}_{{H}_1}.
\]
${H}_0$中巡游电子和d电子是完全解耦的。
${H}_1$会让半满的d轨道变成全满，或者让半满的d轨道变成全空，因此其一阶效应对低能有效模型没有影响。
计算到二阶微扰，使用$n$标记高能的自由度，使用希腊字母标记低能自由度，有
\[
    \mel{\alpha}{{H}_\text{eff}^{(2)}}{\beta} = \sum_n \mel{\alpha}{{H}_1}{n} \mel{n}{{H}_1}{\beta} \frac{1}{2} \left( \frac{1}{E_\alpha - E_n} + \frac{1}{E_\beta - E_n} \right),
\]
其中等式左边的$\ket{\alpha}$、$\ket{\beta}$是微扰之后的本征态，右边的$\ket{\alpha}$和$\ket{\beta}$是微扰之前的。
画费曼图可以得到两个初末态都在低能子空间中的二阶过程：%
\footnote{由于${H}_1$给出的都是二体散射，这是非连通图，但是由于这并不是在计算散射振幅，非连通图不能随意丢弃。}%
\begin{enumerate}
    \item 自旋为$\sigma'$的d电子转化为动量为$\vb*{k}'$的巡游电子（此时d轨道空了），然后动量为$\vb*{k}$，自旋为$\sigma$的巡游电子转化为d电子；
    \item 动量为$\vb*{k}'$，自旋为$\sigma'$的巡游电子转化为d电子（于是就有了两个d电子），自旋为$\sigma$的d电子转化为动量为$\vb*{k}$的巡游电子。
\end{enumerate}
实际上还有一些初末态完全一致的过程，但它们只会给哈密顿量加上一个常数，故略去。
我们尝试写出这两个过程带来的修正。积掉高能自由度之后应该得到一个巡游电子-d电子之间的有效相互作用，这个相互作用的形式为%
\footnote{需要强调会得到巡游电子-d电子相互作用，且这是二体相互作用，是因为使用微扰论时原则上应当考虑所有可能的初态$\ket{\alpha}$和末态$\ket{\beta}$，计算出能量修正，但这样非常繁琐。
如果我们能够确定积掉高能自由度之后的有效哈密顿量中只会出现二体的巡游电子-d电子相互作用，就只需要讨论各含一个d电子和巡游电子的初末态就可以了，从而大大简化计算。
}%
\[
    {H}_\text{eff int} \sim {c}^\dagger_{\text{d}} {c}^\dagger_{\vb*{k}} {c}_{\vb*{k}} {c}_{\text{d}},
\]
于是通过计算微扰后能量修正，得到过程1对应的哈密顿量修正为
\[
    \sum_{\vb*{k}, \vb*{k}', \sigma, \sigma'} V_{\vb*{k}' \text{d}} V^*_{\vb*{k} \text{d}} 
    {c}_{\text{d} \sigma}^\dagger {c}^\dagger_{\vb*{k}' \sigma'} 
    \frac{1}{2} \left( 
        \frac{1}{(\epsilon_{\vb*{k}} + \epsilon_\text{d}) - (\epsilon_{\vb*{k}} + \epsilon_{\vb*{k}'})} + \frac{1}{(\epsilon_{\vb*{k}'} + \epsilon_\text{d}) - (\epsilon_{\vb*{k}} + \epsilon_{\vb*{k}'})} 
    \right)
    {c}_{\text{d} \sigma'} {c}_{\vb*{k} \sigma} ,
\]
过程2对应的哈密顿量为
\[
    \sum_{\vb*{k}, \vb*{k}', \sigma, \sigma'} V_{\vb*{k} \text{d}} V_{\vb*{k}' \text{d}}^*
    {c}^\dagger_{\text{d} \sigma'} {c}^\dagger_{\vb*{k} \sigma}
    \frac{1}{2} \left(
        \frac{1}{(\epsilon_\text{d} + \epsilon_{\vb*{k}}) - (U + 2 \epsilon_{\text{d}})} + \frac{1}{(\epsilon_\text{d} + \epsilon_{\vb*{k}'}) - (U + 2 \epsilon_{\text{d}})}
    \right)
    {c}_{\text{d} \sigma} {c}_{\vb*{k}' \sigma'},
\]
于是最后有效哈密顿量为
\begin{equation}
    \begin{aligned}
        {H}_\text{eff} &= \sum_{\vb*{k}, \sigma} \epsilon_{\vb*{k}} {c}_{\vb*{k}\sigma}^\dagger {c}_{\vb*{k} \sigma} + \sum_\sigma \epsilon_\text{d} {c}_{\text{d}\sigma}^\dagger {c}_{\text{d} \sigma} \\
        & + \sum_{\vb*{k}, \vb*{k}', \sigma, \sigma'} V_{\vb*{k}' \text{d}}^* V_{\vb*{k} \text{d}} {c}^\dagger_{\vb*{k} \sigma} {c}_{\vb*{k}' \sigma'} {c}^\dagger_{\text{d} \sigma'} {c}_{\text{d} \sigma} 
        \frac{1}{2} \left( \frac{1}{\epsilon_{\vb*{k}}- \epsilon_\text{d}} + \frac{1}{\epsilon_{\vb*{k}'} - \epsilon_\text{d}} + \frac{1}{U + \epsilon_\text{d} - \epsilon_{\vb*{k}}} + \frac{1}{U + \epsilon_\text{d} - \epsilon_{\vb*{k}'}} \right).
    \end{aligned}
    \label{eq:effective-anderson}
\end{equation}

\eqref{eq:effective-anderson}看起来非常复杂，但实际上通过对称性的论证可以发现它可以化简为非常简单的形式。
首先d轨道电子的自旋角动量显然是
\[
    {\vb*{S}}_\text{d} = \frac{1}{2} {c}_{\text{d} \alpha}^\dagger \vb*{\sigma}_{\alpha \beta} {c}_{\text{d} \beta},
\]
而巡游电子的自旋角动量在动量表象下，是
\[
    {\vb*{S}}_{\vb*{k} \vb*{k}'} = \frac{1}{2} {c}^\dagger_{\vb*{k} \alpha} \vb*{\sigma}_{\alpha \alpha'} {c}_{\vb*{k}' \alpha'}.
\]
这里我们已经使用了爱因斯坦求和规则，$\alpha$和$\beta$标记了$\uparrow$和$\downarrow$两种自旋。
有效哈密顿量\eqref{eq:effective-anderson}是自旋对称的，显然它的相互作用部分只能是下面的自旋标量的函数：
\[
    \sum_{\vb*{k}, \vb*{k}'} J_{\vb*{k} \vb*{k}'} {\vb*{S}}_{\vb*{k} \vb*{k}'} \cdot {\vb*{S}}_\text{d},
\]
而\eqref{eq:effective-anderson}中
\[
    {H}_I \sim {c}^\dagger_{\vb*{k} \alpha} {c}^\dagger_{\text{d} \beta} {c}_{\vb*{k}' \beta} {c}_{\text{d} \alpha},
\]
因此必须有
\[
    {H}_I = \sum_{\vb*{k}, \vb*{k}'} J_{\vb*{k} \vb*{k}'} {\vb*{S}}_{\vb*{k} \vb*{k}'} \cdot {\vb*{S}}_\text{d}.
\]
泡利矩阵的点乘有下面的有用结果：
\[
    \vb*{\sigma}_{\alpha \beta} \cdot \vb*{\sigma}_{\alpha' \beta'} = 2 \delta_{\alpha \beta'} \delta_{\beta \alpha'} - \delta_{\alpha \beta} \delta_{\alpha' \beta'},
\]
于是可以计算出
\[
    {\vb*{S}}_{\vb*{k} \vb*{k}'} \cdot {\vb*{S}}_\text{d} = \frac{1}{2} {c}^\dagger_{\vb*{k} \alpha} {c}^\dagger_{\vb*{k}' \beta} {c}_{\text{d} \beta} {c}_{\text{d} \alpha} - \frac{1}{4} {c}^\dagger_{\vb*{k} \alpha} {c}_{\vb*{k}' \alpha} {c}^\dagger_{\text{d} \beta} {c}_{\text{d} \beta}.
\]
由于我们要考虑的是低能有效理论，在其中${c}^\dagger_{\text{d} \beta} {c}_{\text{d} \beta}$几乎不变，因此它只会对$\epsilon_{\vb*{k}}$有一个常数修正。
于是我们预期，费米面附近，有效哈密顿量应该是
\begin{equation}
    {H}_\text{eff} = \sum_{\vb*{k}, \sigma} \epsilon_{\vb*{k}} {c}_{\vb*{k}\sigma}^\dagger {c}_{\vb*{k} \sigma} + \sum_\sigma \epsilon_\text{d} {c}_{\text{d}\sigma}^\dagger {c}_{\text{d} \sigma} + \frac{1}{2} \sum_{\vb*{k}, \vb*{k}'} J_{\vb*{k} \vb*{k}'} {c}^\dagger_{\vb*{k} \alpha} {c}^\dagger_{\vb*{k}' \beta} {c}_{\text{d} \beta} {c}_{\text{d} \alpha}.
    \label{eq:kondo-from-symmetry}
\end{equation}
事实上，在费米面附近，$\epsilon_{\vb*{k}}$几乎就是化学势，于是\eqref{eq:effective-anderson}可以化成
\[
    {H}_\text{eff} = \sum_{\vb*{k}, \sigma} \epsilon_{\vb*{k}} {c}_{\vb*{k}\sigma}^\dagger {c}_{\vb*{k} \sigma} + \sum_\sigma \epsilon_\text{d} {c}_{\text{d}\sigma}^\dagger {c}_{\text{d} \sigma} 
    + \sum_{\vb*{k}, \vb*{k}', \sigma, \sigma'} \left( \frac{1}{\mu - \epsilon_\text{d}} + \frac{1}{U + \epsilon_\text{d} - \mu} \right) V_{\vb*{k}' \text{d}}^* V_{\vb*{k} \text{d}} {c}^\dagger_{\vb*{k} \sigma} {c}_{\vb*{k}' \sigma'} {c}^\dagger_{\text{d} \sigma'} {c}_{\text{d} \sigma}.
\]
这和我们通过对称性分析得到的\eqref{eq:kondo-from-symmetry}的形式完全一致。

实际上，在很多情况下，在坐标空间中只有两个电子足够接近才能发生相互作用，换而言之坐标空间中的相互作用系数几乎是一个$\delta$函数，于是动量空间中的相互作用系数随$\vb*{k}$的变化不大，于是可以把它看成常数。
这个常数是反比于系统体积$V$的，因为参与傅里叶变换的有两个${c}_{\vb*{k}}$，于是会加入一个$(1/\sqrt{V})^2$的因子。
这样就得到一个非常简单的有效理论：
\[
    {H}_\text{eff} = \sum_{\vb*{k}, \sigma} \epsilon_{\vb*{k}} {c}_{\vb*{k}\sigma}^\dagger {c}_{\vb*{k} \sigma} + \sum_\sigma \epsilon_\text{d} {c}_{\text{d}\sigma}^\dagger {c}_{\text{d} \sigma} + \frac{J_0}{2V} \sum_{\vb*{k}, \vb*{k}'} {c}^\dagger_{\vb*{k} \alpha} \vb*{\sigma}_{\alpha \beta} {c}_{\vb*{k}' \beta} \cdot {\vb*{S}}_\text{d}.
\]
其中特意保留了一个$1/2$因子是为了强调电子的自旋是$1/2$；我们已经重新定义了单粒子能量，即不失一般性地取化学势为$0$。% TODO:什么时候可以这么做？？
由于低能有效理论中d电子始终只有一个，$\epsilon_\text{d}$项是常数，故略去，就得到
\begin{equation}
    {H}_\text{eff} = \sum_{\vb*{k}, \sigma} \epsilon_{\vb*{k}} {c}_{\vb*{k}\sigma}^\dagger {c}_{\vb*{k} \sigma} + \frac{J_0}{2V} \sum_{\vb*{k}, \vb*{k}'} {c}^\dagger_{\vb*{k} \alpha} \vb*{\sigma}_{\alpha \beta} {c}_{\vb*{k}' \beta} \cdot {\vb*{S}_\text{d}}.
\end{equation}
这就是所谓的\concept{Kondo模型}。注意Kondo模型中还是有d电子的，这个自由度没有被完全积掉（因为它提供的自旋和巡游电子的自旋之间有相互作用），但是始终只有一个d电子，它唯一可变的参数是自旋。

\subsection{低温下电子的散射和电阻}

在低温下，杂质对电子的散射会导致电阻随着温度下降而增加，这种反常性称为\concept{Kondo效应}。正常情况下电子的散射主要来自电子热运动，因此本来应该是越热电阻率越大。
照惯例将d电子在$x$和$y$方向上的自旋算符组合成升降算符：
\begin{equation}
    {S}_\text{d}^{\pm} = {S}_\text{d}^x \pm \ii {S}_\text{d}^y,
\end{equation}
则Kondo模型可以改写为
\begin{equation}
    {H}_\text{eff} = \sum_{\vb*{k}, \sigma} \epsilon_{\vb*{k}} {c}^\dagger_{\vb*{k} \sigma} {c}_{\vb*{k} \sigma} + \frac{J_0}{2V} \sum_{\vb*{k}, \vb*{k}'} (
        {S}_\text{d}^z ({c}^\dagger_{\vb*{k} \uparrow} {c}_{\vb*{k}' \uparrow} - {c}^\dagger_{\vb*{k} \downarrow} {c}_{\vb*{k}' \downarrow})
        + {S}^+_\text{d} {c}^\dagger_{\vb*{k} \downarrow} {c}_{\vb*{k}' \uparrow}
        + {S}^-_\text{d} {c}^\dagger_{\vb*{k} \uparrow} {c}_{\vb*{k}' \downarrow}
    ).
    \label{eq:kondo-spin-up-down}
\end{equation}
${S}^+_\text{d}$和${S}^-_\text{d}$项分别表示$z$方向上的自旋角动量从巡游电子传递给了d电子，或者从d电子传递给了巡游电子。

下面根据\eqref{eq:kondo-spin-up-down}计算一些散射振幅。我们需要的是跃迁概率，因此需要计算${T}$矩阵的矩阵元。以下记d电子自旋为$m_s$。
% TODO：费曼图绘制
不失一般性地假定入射巡游电子的自旋为$\uparrow$。一阶过程包括两个图，一个是入射电子自旋没有发生翻转的，一个是入射电子自旋发生了翻转的，它们展示如\autoref{fig:first-order-kondo}。
\begin{figure}
    \centering
    \subfigure[无自旋翻转]{
        \begin{tikzpicture}
            \begin{feynhand}
                \vertex (a) at (-2.5, 0);
                \vertex (o) at (0, 0);
                \node[below] at (0, 0) {${S}^z_\text{d}$};
                \vertex (b) at (2.5, 0);
                \vertex (c) at (-2.5, 2.5);
                \vertex (d) at (2.5, 2.5);
                \propag[fer] (a) to [edge label={$m$}] (o);
                \propag[fer] (o) to [edge label={$m$}] (b);
                \propag[fer] (c) to [edge label={$\vb*{k}\uparrow$}] (o);
                \propag[fer] (o) to [edge label={$\vb*{k}' \uparrow$}] (d);
            \end{feynhand}
        \end{tikzpicture}
    }
    \subfigure[有自旋翻转]{
        \begin{tikzpicture}
            \begin{feynhand}
                \vertex (a) at (-2.5, 0);
                \vertex (o) at (0, 0);
                \node[below] at (0, 0) {${S}^+_\text{d}$};
                \vertex (b) at (2.5, 0);
                \vertex (c) at (-2.5, 2.5);
                \vertex (d) at (2.5, 2.5);
                \propag[fer] (a) to [edge label={$m$}] (o);
                \propag[fer] (o) to [edge label={$m+1$}] (b);
                \propag[fer] (c) to [edge label={$\vb*{k}\uparrow$}] (o);
                \propag[fer] (o) to [edge label={$\vb*{k}' \downarrow$}] (d);
            \end{feynhand}
        \end{tikzpicture}
    }
    \caption{一阶Kondo散射}
    \label{fig:first-order-kondo}
\end{figure}
它们的跃迁矩阵元分别是
\begin{equation}
    T^{(1)}_{\vb*{k}\uparrow \longrightarrow \vb*{k}' \uparrow} = \frac{J_0 m_s}{2V}, \quad T^{(1)}_{\vb*{k}\uparrow \longrightarrow \vb*{k}' \downarrow} = \frac{J_0}{2V} \sqrt{\frac{3}{4} - m_s (m_s+1)}. 
\end{equation}
以上两式中没有出现任何温度依赖，因此仅考虑一阶过程得不到Kondo效应。这是合理的，因为一阶过程中没有传播子，而对温度的依赖是通过传播子引入的。
于是仅考虑一阶过程，$m_s$给定时，散射率为
\begin{equation}
    \begin{aligned}
        \Gamma(m_s) &= 2\pi \sum_{\vb*{k}'} \delta(\epsilon_{\vb*{k}'} - \epsilon_{\vb*{k}}) (\abs*{T^{(1)}_{\vb*{k}\uparrow \longrightarrow \vb*{k}' \uparrow}}^2 + \abs*{T^{(1)}_{\vb*{k}\uparrow \longrightarrow \vb*{k}' \downarrow}}^2) \\
        &= \frac{\pi N(0)}{2 V} J_0^2 \left( \frac{3}{4} - m_s \right).
    \end{aligned}
\end{equation}
第二个等号实际上做了近似：我们假定$\vb*{k}$总是出现在费米面附近，从而$\epsilon_{\vb*{k}}$就是化学势。
总的散射率就是将不同的$m_s$对应的$\Gamma$加起来。

现在考虑二阶过程。容易验证初末自旋翻转的图有4个，不翻转的图也有4个。
初末态自旋无翻转的图如\autoref{fig:second-order-no-flip-kondo}所示，初末态自旋有翻转的图如\autoref{fig:second-order-flip-kondo}所示。
\autoref{fig:second-order-no-flip-kondo}和\autoref{fig:second-order-flip-kondo}中的每一个图都有一个巡游电子/空穴传播子（d电子传播子由于d电子已经被积掉，无需考虑），由于是有限温度，巡游电子传播子带有一个因子$1-f_{\vb*{q}}$而空穴传播子带有一个因子$f_{\vb*{q}}$，直观地说，就是中间过程产生的巡游电子必须被激发到一个尚未被占据的态，而中间过程产生的空穴必须是一个已经被占据的态上的电子被打掉以后产生的。
\autoref{fig:second-order-no-flip-kondo}对应的$T$矩阵元为%
\footnote{虽然在这里费米子线组成了一个圈，但我们并没有加上一个负号。这是因为我们使用的模型中，在无相互作用时不存在d电子和巡游电子的转化，因此d电子和巡游电子可以当成两种不同的粒子，从而可以认为没有出现闭合的巡游电子线，所以不用加入负号。}%
\begin{equation}
    T^{(2)}_{\vb*{k} \uparrow \longrightarrow \vb*{k}' \uparrow} = \sum_{\vb*{q}} \left( \frac{J_0}{2V} \right)^2 \frac{1}{2} \left( \frac{1}{\epsilon_{\vb*{k}} - \epsilon_{\vb*{q}}} + \frac{1}{\epsilon_{\vb*{k}'} - \epsilon_{\vb*{q}}} \right) \left( \frac{3}{4} - m_s + 2 m_s f_{\vb*{q}} \right).
    \label{eq:t-2-k-temp}
\end{equation}
注意到，虽然\autoref{fig:second-order-no-flip-kondo}的前两个图的因子$f_{\vb*{q}}$和$1-f_{\vb*{q}}$相互抵消了，后两个图由于自旋变化，并不能抵消。这就引入了温度依赖。
由于我们关注低温下的散射行为，以下均假定$\vb*{k}$和$\vb*{k}'$在费米面附近，且$f_{\vb*{q}}$是简单的阶跃函数。对$\vb*{q}$的求和可以转化为积分，于是
\[
    \begin{aligned}
        \frac{1}{V} \sum_{\vb*{q}} \frac{1}{2} \left( \frac{1}{\epsilon_{\vb*{k}} - \epsilon_{\vb*{q}}} + \frac{1}{\epsilon_{\vb*{k}'} - \epsilon_{\vb*{q}}} \right) &= \int \frac{\dd[3]{\vb*{q}}}{(2\pi)^3} m \left( \frac{1}{k^2 - q^2} + \frac{1}{k'^2 - q^2} \right) \\
        &= \frac{m}{2\pi^2} \int q^2 \dd{q} \left( \frac{1}{k^2 - q^2} + \frac{1}{k'^2 - q^2} \right),
    \end{aligned}
\]
然后我们会发现\eqref{eq:t-2-k-temp}右边最后一个括号中前两项是发散的，但这是因为$J_0$实际上会随着$\vb*{k}$变化而变化；最后一项对$T^{(2)}_{\vb*{k} \uparrow \longrightarrow \vb*{k}' \uparrow}$的贡献就是
\[
    \begin{aligned}
        &\quad \frac{J_0^2 m m_s}{4\pi^2 V} \int_0^{k_\text{F}} q^2 \dd{q} \left( \frac{1}{k^2 - q^2} + \frac{1}{k'^2 - q^2} \right) \\
        &= \frac{J_0^2 m m_s}{4\pi^2 V} \left( - 2 k_\text{F} - \frac{k}{2} \ln \abs{\frac{k-k_\text{F}}{k+k_\text{F}}} - \frac{k'}{2} \ln \abs{\frac{k'-k_\text{F}}{k'+k_\text{F}}} \right),
    \end{aligned}
\]
严格计算所有东西太过繁琐，我们就做一个简单的数量级估计。由于是低温极限，$\epsilon_{\vb*{k}}$和$\epsilon_{\vb*{k}'}$分布在费米面附近一个厚度大体上正比于$T$的区域内，则
\[
    \abs{\frac{k^2}{2m} - \frac{k_\text{F}^2}{2m}} \sim T,
\]
于是\eqref{eq:t-2-k-temp}中的最后一项的贡献就是
\[
    \begin{aligned}
        & \sim - \frac{J_0^2 m m_s}{4\pi^2 V} k_\text{F} \ln \left( \frac{m T}{2 k_\text{F}^2} \right) \\
        & \sim N(0) \ln(\frac{T_\text{F}}{T}).
    \end{aligned}
\]
在低温下上式对数发散，因此除此以外的$T^{(2)}_{\vb*{k} \uparrow \longrightarrow \vb*{k}' \uparrow}$的部分都可以忽略。
类似地可以计算出
\begin{equation}
    T^{(2)}_{\vb*{k} \uparrow \longrightarrow \vb*{k}' \downarrow} = \sum_{\vb*{q}} \left( \frac{J_0}{2V} \right)^2 \frac{1}{2} \left( \frac{1}{\epsilon_{\vb*{k}} - \epsilon_{\vb*{q}}} + \frac{1}{\epsilon_{\vb*{k}'} - \epsilon_{\vb*{q}}} \right) (2 m_s + 1) \sqrt{\frac{3}{4} - m_s (m_s + 1)},
\end{equation}
这里没有温度依赖。

\begin{figure}
    \centering
    \subfigure{
        \begin{tikzpicture}
            \begin{feynhand}
                \vertex (a) at (-2.5, 0);
                \vertex (b) at (-1.25, 0);
                \vertex (c) at (1.25, 0);
                \vertex (d) at (2.5, 0);
                \vertex (e) at (-2.5, 1.75);
                \vertex (f) at (2.5, 1.75);
                \node[below] at (b) {${S}^z_\text{d}$};
                \node[below] at (c) {${S}^z_\text{d}$};
                \propag[fer] (a) to [edge label={$m_s$}] (b);
                \propag[fer] (b) to [edge label={$m_s$}] (c);
                \propag[fer] (c) to [edge label={$m_s$}] (d);
                \propag[fer] (e) to [edge label={$\vb*{k} \uparrow$}] (b);
                \propag[fer] (b) to [out=60, in=120, edge label={$\vb*{q} \uparrow$}] (c);
                \propag[fer] (c) to [edge label={$\vb*{k}' \uparrow$}] (f);
            \end{feynhand}
        \end{tikzpicture}
    }
    \subfigure{
        \begin{tikzpicture}
            \begin{feynhand}
                \vertex (a) at (-2.5, 0);
                \vertex (b) at (-1.25, 0);
                \vertex (c) at (1.25, 0);
                \vertex (d) at (2.5, 0);
                \vertex (e) at (-2.5, 1.75);
                \vertex (f) at (2.5, 1.75);
                \node[below] at (b) {${S}^z_\text{d}$};
                \node[below] at (c) {${S}^z_\text{d}$};
                \propag[fer] (a) to [edge label={$m_s$}] (b);
                \propag[fer] (b) to (c);
                \propag[fer] (c) to [edge label={$m_s$}] (d);
                \propag[fer] (e) to [out=0, in=120] (c);
                \propag[fer] (c) to [out=120, in=70, edge label={$\vb*{q} \uparrow$}] (b);
                \propag[fer] (b) to [out=70, in=180] (f);
                \node[below] at (0, 0) {$m_s$};
                \node[above] at (-2.3, 1.73) {$\vb*{k} \uparrow$};
                \node[above] at (2.3, 1.73) {$\vb*{k}' \uparrow$};
            \end{feynhand}
        \end{tikzpicture}
    }
    \subfigure{
        \begin{tikzpicture}
            \begin{feynhand}
                \vertex (a) at (-2.5, 0);
                \vertex (b) at (-1.25, 0);
                \vertex (c) at (1.25, 0);
                \vertex (d) at (2.5, 0);
                \vertex (e) at (-2.5, 1.75);
                \vertex (f) at (2.5, 1.75);
                \node[below] at (b) {${S}^+_\text{d}$};
                \node[below] at (c) {${S}^-_\text{d}$};
                \propag[fer] (a) to [edge label={$m_s$}] (b);
                \propag[fer] (b) to [edge label={$m_s+1$}] (c);
                \propag[fer] (c) to [edge label={$m_s$}] (d);
                \propag[fer] (e) to [edge label={$\vb*{k} \uparrow$}] (b);
                \propag[fer] (b) to [out=60, in=120, edge label={$\vb*{q} \downarrow$}] (c);
                \propag[fer] (c) to [edge label={$\vb*{k}' \uparrow$}] (f);
            \end{feynhand}
        \end{tikzpicture}
    }
    \subfigure{
        \begin{tikzpicture}
            \begin{feynhand}
                \vertex (a) at (-2.5, 0);
                \vertex (b) at (-1.25, 0);
                \vertex (c) at (1.25, 0);
                \vertex (d) at (2.5, 0);
                \vertex (e) at (-2.5, 1.75);
                \vertex (f) at (2.5, 1.75);
                \node[below] at (b) {${S}^-_\text{d}$};
                \node[below] at (c) {${S}^+_\text{d}$};
                \propag[fer] (a) to [edge label={$m_s$}] (b);
                \propag[fer] (b) to (c);
                \propag[fer] (c) to [edge label={$m_s$}] (d);
                \propag[fer] (e) to [out=0, in=120] (c);
                \propag[fer] (c) to [out=120, in=70, edge label={$\vb*{q} \downarrow$}] (b);
                \propag[fer] (b) to [out=70, in=180] (f);
                \node[below] at (0, 0) {$m_s-1$};
                \node[above] at (-2.3, 1.73) {$\vb*{k} \uparrow$};
                \node[above] at (2.3, 1.73) {$\vb*{k}' \uparrow$};
            \end{feynhand}
        \end{tikzpicture}
    }
    \caption{初末态自旋无翻转的二阶过程}
    \label{fig:second-order-no-flip-kondo}
\end{figure}

\begin{figure}
    \centering
    \subfigure{
        \begin{tikzpicture}
            \begin{feynhand}
                \vertex (a) at (-2.5, 0);
                \vertex (b) at (-1.25, 0);
                \vertex (c) at (1.25, 0);
                \vertex (d) at (2.5, 0);
                \vertex (e) at (-2.5, 1.75);
                \vertex (f) at (2.5, 1.75);
                \node[below] at (b) {${S}^+_\text{d}$};
                \node[below] at (c) {${S}^z_\text{d}$};
                \propag[fer] (a) to [edge label={$m_s$}] (b);
                \propag[fer] (b) to [edge label={$m_s+1$}] (c);
                \propag[fer] (c) to [edge label={$m_s+1$}] (d);
                \propag[fer] (e) to [edge label={$\vb*{k} \uparrow$}] (b);
                \propag[fer] (b) to [out=60, in=120, edge label={$\vb*{q} \downarrow$}] (c);
                \propag[fer] (c) to [edge label={$\vb*{k}' \downarrow$}] (f);
            \end{feynhand}
        \end{tikzpicture}
    }
    \subfigure{
        \begin{tikzpicture}
            \begin{feynhand}
                \vertex (a) at (-2.5, 0);
                \vertex (b) at (-1.25, 0);
                \vertex (c) at (1.25, 0);
                \vertex (d) at (2.5, 0);
                \vertex (e) at (-2.5, 1.75);
                \vertex (f) at (2.5, 1.75);
                \node[below] at (b) {${S}^+_\text{d}$};
                \node[below] at (c) {${S}^z_\text{d}$};
                \propag[fer] (a) to [edge label={$m_s$}] (b);
                \propag[fer] (b) to (c);
                \propag[fer] (c) to [edge label={$m_s+1$}] (d);
                \propag[fer] (e) to [out=0, in=120] (c);
                \propag[fer] (c) to [out=120, in=70, edge label={$\vb*{q} \uparrow$}] (b);
                \propag[fer] (b) to [out=70, in=180] (f);
                \node[below] at (0, 0) {$m_s+1$};
                \node[above] at (-2.3, 1.73) {$\vb*{k} \uparrow$};
                \node[above] at (2.3, 1.73) {$\vb*{k}' \downarrow$};
            \end{feynhand}
        \end{tikzpicture}
    }
    \subfigure{
        \begin{tikzpicture}
            \begin{feynhand}
                \vertex (a) at (-2.5, 0);
                \vertex (b) at (-1.25, 0);
                \vertex (c) at (1.25, 0);
                \vertex (d) at (2.5, 0);
                \vertex (e) at (-2.5, 1.75);
                \vertex (f) at (2.5, 1.75);
                \node[below] at (b) {${S}^z_\text{d}$};
                \node[below] at (c) {${S}^+_\text{d}$};
                \propag[fer] (a) to [edge label={$m_s$}] (b);
                \propag[fer] (b) to [edge label={$m_s$}] (c);
                \propag[fer] (c) to [edge label={$m_s+1$}] (d);
                \propag[fer] (e) to [edge label={$\vb*{k} \uparrow$}] (b);
                \propag[fer] (b) to [out=60, in=120, edge label={$\vb*{q} \uparrow$}] (c);
                \propag[fer] (c) to [edge label={$\vb*{k}' \downarrow$}] (f);
            \end{feynhand}
        \end{tikzpicture}
    }
    \subfigure{
        \begin{tikzpicture}
            \begin{feynhand}
                \vertex (a) at (-2.5, 0);
                \vertex (b) at (-1.25, 0);
                \vertex (c) at (1.25, 0);
                \vertex (d) at (2.5, 0);
                \vertex (e) at (-2.5, 1.75);
                \vertex (f) at (2.5, 1.75);
                \node[below] at (b) {${S}^z_\text{d}$};
                \node[below] at (c) {${S}^+_\text{d}$};
                \propag[fer] (a) to [edge label={$m_s$}] (b);
                \propag[fer] (b) to (c);
                \propag[fer] (c) to [edge label={$m_s+1$}] (d);
                \propag[fer] (e) to [out=0, in=120] (c);
                \propag[fer] (c) to [out=120, in=70, edge label={$\vb*{q} \downarrow$}] (b);
                \propag[fer] (b) to [out=70, in=180] (f);
                \node[below] at (0, 0) {$m_s$};
                \node[above] at (-2.3, 1.73) {$\vb*{k} \uparrow$};
                \node[above] at (2.3, 1.73) {$\vb*{k}' \downarrow$};
            \end{feynhand}
        \end{tikzpicture}
    }
    \caption{初末态自旋有翻转的二阶过程}
    \label{fig:second-order-flip-kondo}
\end{figure}

这样，$T$矩阵形如
\[
    T \sim T_0 \left( 1 + J_0 N(0) \ln(\frac{T_\text{F}}{T}) + \cdots \right),
\]
从而散射率在低温下的的数量级就是
\begin{equation}
    \Gamma \sim \Gamma_0 \left(1 + 2 J_0 N(0) \ln \frac{T_\text{F}}{T} + \cdots \right).
\end{equation}
考虑到电阻率正比于散射率，我们这就导出了低温下电阻率反常对数发散的现象。
需要注意的是，上式实际上意味着当温度非常低时算到二阶的微扰论是错误的，因为此时散射概率会超过1。
会出现这种现象的原因在于当温度变小时有效的$J_{0}^\text{eff}$实际上会变大，从而破坏微扰论的基础。
显然，只要
\begin{equation}
    J_0 N(0) \ln \frac{T_\text{F}}{T} \sim 1,
\end{equation}
那么微扰论就不再适用。对应的温度尺度
\begin{equation}
    T_\text{K} = T_\text{F} \ee^{- \frac{4}{3J_0 N(0)}}
\end{equation}
称为\concept{Kondo温度}（$3/4$的因子是更严格计算导致的）。当温度大于Kondo温度时微扰论适用，而对小于Kondo温度的系统，d电子和巡游电子强烈的自旋-自旋相互作用会导致一个巡游电子和d电子紧密地结合起来，形成一个自旋单态，从而屏蔽d电子对巡游电子的扰动，这就是所谓的\concept{Kondo屏蔽}。
如果没有Kondo屏蔽，巡游电子和d电子可以有“自旋相同，空间回避”的效应，从而d电子对巡游电子也许没有什么散射，但是Kondo屏蔽发生后，这种效应不复存在，从而巡游电子被高效地散射。

\subsection{重整化群}

上一节中我们提到，随着温度下降——或者说随着能标下降——相互作用会增强。本节相对严格地证明这一点。
我们并不做完整的重整化群计算，而是采用一个称为\concept{Poor man's scaling}的方法。
我们将始终假定相互作用非常弱（这其实是没有道理的，因为我们想要的是相互作用如何变强，那么肯定要涉及相互作用比较强的区域；这就是poor man一词的来历——它只是一个非常粗略的结果），从而自由理论的能带宽度$2 D$标记了能标；温度$T$也标记了能标，于是我们有$T \propto D$。
当$T=T_\text{F}$时Kondo散射观察不到，实际上我们关注的问题通常都远远低于费米温度，因此可以用它做重整化群计算的起点，即
\begin{equation}
    \frac{T}{T_\text{F}} = \frac{D}{D_0}.
\end{equation}
由于假定了相互作用非常弱，我们将只计算具有如下形式的二阶费曼图：一个低能电子经过一次d电子散射，产生一个高能中间电子，然后再经过一次d电子散射产生一个低能电子。

\eqref{eq:kondo-spin-up-down}中，三个相互作用项都具有完全一样的耦合常数，这是因为我们导出\eqref{eq:kondo-spin-up-down}使用的Anderson模型是各向同性的。
本节讨论一个稍微一般一些的模型，即如下的各向异性Kondo模型：
\begin{equation}
    {H}_\text{eff} = \sum_{\vb*{k}, \sigma} \epsilon_{\vb*{k}} {c}^\dagger_{\vb*{k} \sigma} {c}_{\vb*{k} \sigma} + \frac{1}{2V} \sum_{\vb*{k}, \vb*{k}'} (
        J_z {S}_\text{d}^z ({c}^\dagger_{\vb*{k} \uparrow} {c}_{\vb*{k}' \uparrow} - {c}^\dagger_{\vb*{k} \downarrow} {c}_{\vb*{k}' \downarrow})
        + J_+ {S}^+_\text{d} {c}^\dagger_{\vb*{k} \downarrow} {c}_{\vb*{k}' \uparrow}
        + J_- {S}^-_\text{d} {c}^\dagger_{\vb*{k} \uparrow} {c}_{\vb*{k}' \downarrow}
    ),
\end{equation}
其中我们强行要求
\begin{equation}
    J_+ = J_- = J_\pm,
\end{equation}
从而保留有一个自旋的$\mathbb{Z}_2$对称性，即将自旋上下颠倒则什么也没有发生。于是在重整化群作用下，${c}^\dagger_\uparrow {c}_\uparrow$项和${c}^\dagger_\downarrow {c}_\downarrow$项的系数始终只差了一个负号，从而在讨论耦合常数变化时可以只讨论入射电子自旋向上的情况。

% TODO：化学势
现在开始积掉从$D-\abs{\var{D}}$到$D$这么多的能带中的电子自由度，以及从$-D$到$-D+\abs{\var{D}}$这么多的能带中的电子自由度。
我们考虑$J_z$的变化情况，$\var{J_z}$对应所有入射、出射电子自旋均向上的图之和，从而我们有


如果我们以\eqref{eq:kondo-spin-up-down}为起点做重整化群计算，那么无论参数如何跑动，$J_z$, $J_+$和$J_-$总是相等的。
于是参数跑动就是
\begin{equation}
    \dv{J}{\ln D} = N(0) J^2.
\end{equation}

\section{Anderson局域化}

\subsection{固体中的无序}

理想晶体是高度有序的，但是实际的固体多少具有一些无序性。
本节将介绍一种现象：当固体中出现无序，即平移对称性破缺时，电子会倾向于留在原地而不发生长距离跃迁。
这种现象称为\concept{Anderson局域化}。无序可以来自掺杂，也可以来自离子实实际上并没有构成晶体这一事实。

例如可以写出这样的一个带有格点无序的紧束缚模型：
\begin{equation}
    {H} = - t \sum_{\pair{i, j}} ({c}_i^\dagger {c}_j + \text{h.c.}) + \sum_i \epsilon_i {c}_i^\dagger {c}_i,
    \label{eq:tight-binding-with-disorder}
\end{equation}
其中$\epsilon_i$是一个随机变量，它基本上就是一个在空间各点不一样的“化学势”，让一些地方比另一些地方更能够留住电子。
接下来考虑这样的$\epsilon_i$的分布特例：
\begin{equation}
    \overline{\epsilon_i} = 0, \quad \overline{\epsilon_i \epsilon_j} = \delta_{ij} W^2 , \quad W^2 \neq 0.
\end{equation}
这样，$W/t$就表征了无序的大小。如果$\epsilon_i$的分布服从高斯分布，我们就有Wick定理成立。
这里我们使用$\overline{\cdots}$表示对杂质的构型的平均，而用$\expval*{\cdots}$表示给定杂质的构型之后做量子力学的平均。

在$W/t=0$时就得到一个普通的能带，而如果$W/t \gg 1$，即无序很强，则体系的哈密顿量近似为
\[
    {H} = \sum_i \epsilon_i {c}_i^\dagger {c}_i,
\]
这个哈密顿量在以瓦尼尔波函数为基底的表象下是对角化的，这样电子倾向于固定在原地，即出现局域化。另一方面，完全没有随机扰动时，电子可以自由地移动。
这意味着随着$W/t$的增大，或是会出现一个金属-绝缘体相变，或是会出现一个crossover。

一些简单的论证可以说明这种模型的电子结构。
局域态和（能够长距离移动，从而能够导电的）延展态应该不共享能量。否则，设一个局域态和一个延展态具有一样的能量，那么将这个局域态和延展态做线性组合，得到另一个延展态，也能具有一样的能量，因此最终我们会发现，同一个能量上有一个被大量延展态环绕着的局域态，这种情况下我们其实可以直接忽略这个局域态。
$W=0$时我们有一个连续的延展态能带。通过微扰论可以发现，在这个能带两端的波函数将转化为局域态。% TODO
因此含有无序的金属的电子能带结构包括一个延展态能带和位于延展态能带两边的所谓的\concept{带尾局域态}。随着$W/t$的增大，会有越来越多的延展态转化为局域态。

现在费米面的位置将决定系统的导电性。如果费米面的位置位于较低的局域态能带中，虽然此时有能带半填充，但是由于是局域态，系统是绝缘体。
在实空间中，这等价于电子都被束缚在杂质周围。
费米面进入延展态能带后，所有能够被占据的杂质轨道都被占据了，电子别无他法，必须有一部分是延展态的。
在实空间中，这就好像大水漫灌将小水坑都灌满而仍然有不少剩余的可以四处流动。
当费米面进入较高的局域态能带时，延展态能带被占满，系统又一次变成绝缘体。
在实空间中，这就好像水缸被填满了，只留下几个气泡，然而气泡被定域在一些点附近无法移动。
改变费米面高度，或者更加容易的，改变$W/t$，因而能够产生一个延展-局域相变，或者说是金属-绝缘体相变。
这个相变通常称为\concept{Anderson转变}。
$W/t$增大只会让带尾局域态越来越多，最后延展态完全消失，因此无论费米面一开始在哪里，$W/t$足够大时都会发现金属-绝缘体相变，这正是前面通过分析$W/t=0$和$W/t \to \infty$而得出的结论。

\subsection{格林函数的微扰计算}

\eqref{eq:tight-binding-with-disorder}是自由理论，因此是严格可解的。通常我们会计算所谓的无序平均，即对每个可能的$\{\epsilon_i\}$构型，计算出某个物理量$O$（此处不是指可观察量算符，而是真的实行观测测得的量，如$\epsilon$给定后，某算符的期望值、方差，格林函数等），然后求出平均值$\overline{O}$。
对一个热力学系统，如果$O$是关于系统全局的，则$O$和无序平均$\overline{O}$大概率是非常接近的，这是等概率原理的空间版本。

我们要计算两点格林函数。显然
\begin{equation}
    G^{-1}_{ij}(\ii \omega_n) = \omega_n + t_{ij} - \epsilon_i \delta_{ij}.
\end{equation}
我们现在对$\epsilon_i$做微扰展开（虽然是自由系统但微扰展开总是合法的），就有
\begin{equation}
    \begin{aligned}
        G_{ij}(\ii \omega_n) &= \frac{1}{\ii \omega_n + t_{ij}} + \frac{1}{\ii \omega_n + t_{ik}} (- \epsilon_k \delta_{kl}) \frac{1}{\ii \omega_n + t_{lj}} + \cdots \\
        &= \frac{1}{\ii \omega_n - \hat{T}} + \frac{1}{\ii \omega_n - \hat{T}} \hat{\epsilon} \frac{1}{\ii \omega_n - \hat{T}} + \cdots,
    \end{aligned}
    \label{eq:disorder-scattered-fermion-green}
\end{equation}
这里我们已经引入了动能算符$\hat{T}$和微扰$\hat{\epsilon}$。
当然，这是非常直观的：电子和杂质散射了一次，两次，……
用格林函数计算出各种可以观测的物理量，对$\{\epsilon_i\}$求平均即可。
\eqref{eq:disorder-scattered-fermion-green}的第一项在杂质构型平均中保留，第二项消失，因为出现了奇数个$\hat{\epsilon}$，第三项保留，为
\begin{equation}
    \overline{\frac{1}{\ii \omega_n - \hat{T}} \hat{\epsilon} \frac{1}{\ii \omega_n - \hat{T}} \hat{\epsilon} \frac{1}{\ii \omega_n - \hat{T}}} = W^2 \frac{1}{\ii \omega_n - t_{ij}} \frac{1}{\ii \omega_n - t_{jj}} \frac{1}{\ii \omega_n - t_{jk} }.
\end{equation}
考虑更高阶项，会发现格林函数实际上可以通过费曼规则
\begin{equation}
    \begin{gathered}
        \begin{tikzpicture}
            \begin{feynhand}
                \vertex (a) at (-1, 0);
            \end{feynhand}
        \end{tikzpicture}
    \end{gathered} = 
\end{equation}
得到。直观地看，这是说电子运动路径如果经过它曾经经过的某一点，那么这个路径的权重就很大。
我们也可以定义动量空间中的费曼规则。计算傅里叶变换，有
\[
    \begin{aligned}
        G^{(2)}(\vb*{k}, \ii \omega_n) &= \sum_{i, j, l} G_{ij}^{0} G_{jj}^{0} G_{jl}^0 \ee^{- \ii \vb*{k} \cdot (\vb*{r}_i - \vb*{r}_l)} \\
        &= \sum_{\vb*{k}'} G_{\vb*{k}}^0 G_{\vb*{k}'}^0 G_{\vb*{k}}^0,
    \end{aligned}
\]
其结果是
% TODO：费曼规则
这是意料之中的，因为坐标空间中的费曼规则要求某两次散射发生在同一个地点，这个地点上的动量守恒条件实际上就是
\[
    \vb*{k} + \vb*{k}' = \vb*{k} + \vb*{k}'.
\]

将无穷多个图加在一起实际上给出的就是自能修正。“一圈图”（虽然实际上是树图，因为虚线不提供传播子，也就没有圈图积分）的自能修正是
\begin{equation}
    \overline{G(\vb*{k}, \ii \omega_n)} = \frac{1}{\ii \omega_n - \xi_{\vb*{k}} - \Sigma} , \quad \Sigma = W^2 \sum_{\vb*{k}'} \frac{1}{\ii \omega_n - \xi_{\vb*{k}'}} ,
\end{equation}
或者换成推迟格林函数中的自能，是
\begin{equation}
    \overline{G^\text{ret}(\vb*{k}, \omega)} = \frac{1}{\omega - \xi_{\vb*{k}} - \Sigma + \ii 0^+} , \quad \Sigma^\text{ret} = W^2 \sum_{\vb*{k}'} \frac{1}{\omega - \xi_{\vb*{k}'}  + \ii 0^+}.
\end{equation}
这个自能修正的实部是非常平凡的，除了平移了一下化学势以外什么也没有做，而其虚部
\begin{equation}
    \Im \Sigma^\text{ret} = - \pi W^2 \sum_{\vb*{k}'} \delta(\omega - \xi_{\vb*{k}'}) = - \pi W^2 N(0).
\end{equation}
则给出了电子的寿命，实际上最好说是电子的动量模式的寿命，即电子运动着运动着就被散射到别的动量模式上了。通过计算电子寿命可以得到体系的电阻。

\subsection{弱局域化}

上一节并没有解释为何当无序越来越强时到底发生了什么才导致局域化。本节将提供一些物理图像。

系统中总是有大量热涨落，因此电子在长距离运动时会出现退相干。
设$l$为电子的相干长度，则参数
\begin{equation}
    \gamma = \frac{1}{\pi k_\text{F} l}
\end{equation}
表征了长距离相干性。在$\gamma$非常小时，两个杂质的间距远大于电子相关长度，因此可以使用经典模型处理问题。
这样，我们认为电子以费米速度运动，并与杂质发生弹性碰撞。于是可以认为电子在做一个随机行走，两步之间没有任何关联。
这样，两条路径之间不可能

现在假定虽然$\gamma$很小，但相干的散射还是可能的。这样两点之间的跃迁概率就会出现超越经典模型的修正。
从一个点出发经过一系列点然后又回来的路径会因为相干叠加而获得很大概率（经典概率的两倍）。

电子运动情况的空间系综平均等价于一个随机行走
% TODO
\[
    \expval*{r^2}(t) = D_0 t = \frac{l^2}{\tau} t = v_\text{F}^2 \tau t.
\]
在时间$t$内，电子经典情况下可以到达的体积为
\[
    V(t) \sim (\sqrt{D_0 t})^d = (D_0 t)^{d/2},
\]
如果其体积在一个大小为
\[
    \sim \lambda_\text{F}^{d-1} v_\text{F} \dd{t}
\]
的圆柱体中，那么在$t$到$t+\dd{t}$时间内它就可以回到原点。这样
\[
    P_{a \to a} \sim \int \frac{\lambda_\text{F}^{d-1} v_\text{F} \dd{t}}{(D_0 t)^{d/2}} 
\]
积分下限的数量级为$\tau$，因为在比这更小的时间尺度上，电子的运动只是布朗运动，不是较连续的扩散。
积分上限为退相干时间$\tau_\phi$，它也许来自电子和热化的声子的相互作用或是电子电子相互作用，无论如何都涉及一些有限温的机制。
\[
    \frac{\var{\sigma}}{\sigma_0} = - \lambda_\text{d} \begin{cases}
        \sqrt{\frac{\tau_\phi}{\tau}}, \quad &d = 1, \\
        \ln(\frac{\tau_\phi}{\tau}) , \quad &d = 2, \\
        \sqrt{\frac{\tau}{\tau_\phi}} , \quad &d = 3.
    \end{cases}
\]
当$T\to 0$时，$d=1, 2$的情况给出了缺乏物理意义的结果：电导率趋向负无穷。这意味着此时出现了局域化，并且不能使用微扰论讨论。
$d=3$时随着温度降低，电导降至零。

\subsection{Thouless论证和重整化群}

由于$d=1, 2$的情况是超越微扰论的，需要使用重整化群的理论来分析问题。
记归一化无量纲电导为
\begin{equation}
    g = \frac{G}{e^2 / \hbar},
\end{equation}
其中$G$为电导，它和材料的长度尺度$L$有关。将$L$看成重整化群参数，$L$增大表示往宏观性质方向移动。
这样$\beta$函数定义为
\begin{equation}
    \beta(g(L)) = \dv{\ln g}{\ln L}.    
\end{equation}

对$g \gg 1$的情况，即良导体极限，由电阻定律
\[
    g = \sigma / (e^2 / \hbar) L^{d-2},
\]
则
\[
    \beta(g) = d - 2.
\]
实际上，无序的存在会让电阻变大，电导变小，即会让$\ln g$增长得没有那么快，于是对$g$比较大的情况，我们做一阶展开：
\begin{equation}
    \beta(g) = d - 2 - c \frac{1}{g},
    \label{eq:disorder-rg-large-g}
\end{equation}
其中$c$是一个大于零的常数。

对$g \ll 1$的情况即绝缘体的情况，电导会随着系统尺度快速衰减，通常是指数衰减：
\[
    g = g_0 \ee^{- L / \xi},
\]
于是
\begin{equation}
    \beta(g) = \ln(\frac{g}{g_0}).
    \label{eq:disorder-rg-small-g}
\end{equation}
实际的$\beta$函数应该在\eqref{eq:disorder-rg-large-g}和\eqref{eq:disorder-rg-small-g}之间。
绘图可知，对$d=1, 2$的情况，$\beta$函数始终小于零，因此在$L$增大时$g$会衰减到零。换而言之，这两个情况下含有无序的固体只有一个地能有效理论，就是完全的局域化。
三维系统的$\beta$函数有一个零点$g_\text{c}$，如果一开始$g < g_\text{c}$，那么$\beta$函数始终是负的，于是重整化之后$g=0$，得到一个绝缘体相；如果一开始$g > g_\text{c}$，那么$\beta$函数始终是正的，重整化之后得到一个导体相。
换而言之$g_\text{c}$是一个相变点。

对三维情况，在相变点附加将$\beta$函数线性化，有
\begin{equation}
    \beta(g) = s \left( \frac{g - g_\text{c}}{g_\text{c}} \right),
\end{equation}
计算得到
\begin{equation}
    \frac{g(L) - g_\text{c}}{g_\text{c}} = \left( \frac{L}{} \right)
\end{equation}

\section{Mott绝缘体}

能带较窄的系统与其说和金属比较相似，不如说和孤立原子比较相似。设系统中电子浓度使得每个原子周围正好可以有一个电子，则在能带很窄的情况下，由于电子-电子排斥，最稳定的状态显然是电子定域在各个原子周围。
这种情况下系统是不导电的。如果还是相信库伦相互作用只是修正了能带云云，那将会因为此时的能带是半满的而错误地以为系统导电。
