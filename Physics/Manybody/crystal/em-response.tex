\section{电子气的电磁响应和库伦相互作用}

本节讨论电子气的电磁响应。由于$\vb*{A}$耦合在$\vb*{j}$上，而能够决定极化电场的也无非是电子数密度，讨论电子气的电磁响应基本上就是要计算密度-密度关联函数。
如果不考虑电子之间的库仑相互作用，那么这是平凡的：诸如“谐振子受到电场策动，然后出现极化”的图像就能工作得很好。
在绝缘体中这大体上是正确的，在金属中则不见得是这样。
因此，比较精确地计算电子气的电磁响应，实际上就是需要将电子-电子库伦相互作用纳入计算，而这就很自然地要求我们使用一种完整的凝聚态场论：以某种电子气——自由电子气，或者紧束缚模型等——为自由理论，以库伦相互作用为微扰。

本节讨论那些把库仑相互作用直接当成微扰尚可取得较好结果的系统。对强关联系统，这个做法是很可能失效的。

\subsection{能带电子电磁响应的波包动力学处理}

\subsubsection{Bloch电子波包}

考虑一个可以被看成晶格动量为$\vb*{k}_0$的Bloch电子波包。显然这个波包由同一个能带中的不同晶格动量成分组成（不同能带的电子具有非常不同的色散关系，它们各自运行的速度非常不同，用它们是无法组成一个比较稳定的波包的；以下略去能带标记$n$），且它们的晶格动量$\vb*{k}'$均很接近$\vb*{k}_0$，假定大体上
\begin{equation}
    - \frac{\Delta}{2} \leq k_i = k_{0i} - k'_i \leq \frac{\Delta}{2},
\end{equation}
从而可以做展开
\begin{equation}
    \epsilon_{\vb*{k}'} = \epsilon_{\vb*{k}_0} + \vb*{k} \cdot (\grad_{\vb*{k}} \epsilon_{\vb*{k}})|_{\vb*{k}_0}.
\end{equation}
波函数的形式形如
\[
    \psi(\vb*{r}, t) = \sum_{\vb*{k}'} a_{\vb*{k}} \psi_{n \vb*{k}}(\vb*{r}, t) = \sum_{\vb*{k}'} a_{\vb*{k}} \ee^{\ii (\vb*{k}' \cdot \vb*{r} - \epsilon_{\vb*{k}'})} u_{\vb*{k}}(\vb*{r}, t),
\]
其中$a_{\vb*{k}}$满足归一化条件。代入$\epsilon_{\vb*{k}'}$的展开式，能够得到
\[
    \psi(\vb*{r}, t) = \ee^{\ii (\vb*{k}_0 \cdot \vb*{r} - \epsilon_{\vb*{k}_0} t)} \sum_{\vb*{k}} a_{\vb*{k}} \ee^{\ii }
\]
\begin{equation}
    \psi(\vb*{r}, t)
\end{equation}

\subsection{自由电子气加入库伦相互作用后对外加电场的响应}\label{sec:ext-e}

\subsubsection{托马斯-费米静态屏蔽势}

本节讨论一个足够稀疏，从而可以忽略交换作用的电子气系统。
由于可以忽略交换作用，可以完全照搬经典静电学，即认为一个电子的全部能量是其动能加上电势能，而不考虑任何交换能或者关联能。
想象我们在一个满足托马斯-费米近似的近独立电子气当中放入一个电荷。显然，异号电荷会移动到前者附近而产生一个屏蔽效应。
在电子气规模很大时（我们所研究的固体总是在热力学极限之下，因此这是成立的），屏蔽效应很强，这让外加电荷对电子气的扰动实际上局限在外加电荷的一个小邻域内。
不管怎么说求解外加电荷的影响就是求解以下自洽问题：
\begin{enumerate}
    \item 外加电荷导致外加电势能
    \begin{equation}
        \phi_\text{ext} = \frac{Q}{r},
    \end{equation}
    \item 外加电势与屏蔽电荷形成的电势$\var{\phi}$叠加，导致总的电势变化为
    \begin{equation}
        \phi_\text{eff} = \phi_\text{ext} + \var{\phi},
    \end{equation}
    \item 总电势变化$\phi_\text{eff}$导致了电荷密度变化$\var{n}$，电荷密度变化给出屏蔽电势$\var{\phi}$。
\end{enumerate}
自洽求解以上问题就可以确定所有物理量。

以上自洽求解步骤还需要一个方程：$V_\text{eff}$是怎么影响电荷密度的。
$V_\text{eff}$改变粒子排布的方式是这样的：单电子的能量$\epsilon_{\vb*{k}}$会由于$V_\text{eff}$的引入发生一个小的变化，且这个小的变化在不同位置通常是不一样的。
由于托马斯-费米近似成立，我们认为每个$\vb*{r}$位置附近的诸电子都可以认为是组成了一个正则系综%
\footnote{这么做总是可以的，因为我们讨论近平衡态理论，确实允许电荷密度在空间上出现分布，虽然完全的平衡态电子气应该是均匀的。}%
，且$\vb*{k}$和$\vb*{r}$可以同时确定，于是
\[
    n(\vb*{r}) = \sum_{\vb*{k}, \sigma} \frac{1}{1 + \ee^{\beta (\epsilon_{\vb*{k}}(\vb*{r}) - \mu)}} = 2 \sum_{\vb*{k}} \frac{1}{1 + \ee^{\beta (\epsilon_{\vb*{k}}(\vb*{r}) - \mu)}}, \quad \epsilon_{\vb*{k}}(\vb*{r}) = \epsilon_{\vb*{k}}^0 + V_\text{eff}(\vb*{r}),
\]
由于体系足够大，屏蔽作用让外加电荷的作用几乎是局域的，则$\var{n}(\vb*{r})$可以写成$V_\text{eff}(\vb*{r})$的函数而不涉及长程相互作用。
而由于外加电荷很小，可以采取线性近似，于是（第二个等号是因为费米-狄拉克分布的形式）
\[
    \var{n} = \dv{n}{V_\text{eff}} V_\text{eff} = \sum_{\vb*{k}} \pdv{n}{\epsilon_{\vb*{k}}} V_\text{eff} = - \pdv{n}{\mu} V_\text{eff},
\]
关于能量的态密度（即单位$\dd{\epsilon}$、单位体积中有多少可能的态）为
\begin{equation}
    N(\mu' - \mu) = \pdv{n\big|_{\mu \to \mu'}}{\mu'},
\end{equation}
其中能量从费米面量起，且我们将$n$的表达式中的$\mu$换成了变量$\mu'$，而使用$\mu$表示实际系统的化学势。使用该记号，则
\begin{equation}
    \var{n}(\vb*{r}) = - N(0) V_\text{eff}(\vb*{r}).
    \label{eq:from-veff-to-varn}
\end{equation}
这就是从$V_\text{eff}$计算$\var{n}$的方法。通过$\var{n}$计算$\var{\phi}$的方程为泊松方程
\[
    - \laplacian \phi_\text{eff} = 4 \pi \left( Q \delta(\vb*{r}) - e \var{n}(\vb*{r}) \right),
\]
其中我们不失一般性地将外加电荷放在原点上。使用傅里叶变换并且使用$\var{n}$和$V_\text{eff}$之间的线性关系\eqref{eq:from-veff-to-varn}，可以得到
\[
    k^2 V_\text{eff}(\vb*{k}) = - 4\pi e Q - 4 \pi e^2 N(0) V_\text{eff}(\vb*{k}),
\]
解出$V_\text{eff}(\vb*{k})$为
\[
    V_\text{eff}(\vb*{k}) = - \frac{4 \pi e Q}{k^2 + \kappa
    _\text{TF}^2},
\]
做傅里叶逆变换得到
\begin{equation}
    V_\text{eff}(\vb*{r}) = - \frac{eQ}{r} \ee^{- \kappa_\text{TF} r},
    \label{eq:thomas-fermi-potential}
\end{equation}
其中
\begin{equation}
    \kappa_\text{TF}^2 = 4 \pi e^2 N(0).
\end{equation}
这个结果就是\concept{托马斯-费米屏蔽}。

\subsubsection{RPA近似下的动态屏蔽响应}

托马斯-费米屏蔽是静态的。现在考虑一般的近独立电子气的线性响应。
外加电势导致如下的相互作用哈密顿量：
\[
    {H}_\text{ext} = \int \dd[3]{\vb*{r}} {n}(\vb*{r}, t) V_\text{ext} (\vb*{r}, t),
\]
则它对电子数密度的影响可以使用（各向同性不含时体系的）推迟格林函数
\[
    G^\text{ret}_{nn}(\vb*{r}-\vb*{r}', t-t') = - \ii \theta(t-t') \expval*{\comm{\var{{n}}(\vb*{r}, t)}{\var{{n}}(\vb*{r}', t')}}
\]
描述，而响应就是%
\footnote{我们没有将$V_\text{ext}$写进${H}$中而是把它看成了外界扰动，这样电子气本身的哈密顿量仍然是空间平移不变的。}%
\begin{equation}
    \expval*{\var{{n}}(\vb*{r}, t)} = \int \dd{t'} G^\text{ret}_{nn}(\vb*{r}-\vb*{r}', t-t') V_\text{ext}(\vb*{r}', t'),
\end{equation}
在频域中就是
\begin{equation}
    \expval*{\var{{n}}(\vb*{k}, \omega)} = G^\text{ret}_{nn}(\vb*{k}, \omega) V_\text{ext}(\vb*{k}, \omega).
    \label{eq:green-function-electro-shielding}
\end{equation}
当然，在系统的构成已知的情况下，可以直接用费曼图计算出格林函数$G^\text{ret}_{nn}$，但是本节不这么处理问题。
但如果真的这么做很快就会遇到数学上的困难：费曼图求和需要经过一些特殊的重求和步骤才能够给出有意义的结果。
因此本节只是做一个近似，将最为奇异的那部分费曼图做一个求和，然后发现它确实能够给出有意义的结果。

为简化问题我们做\concept{RPA（Random Phase Approximation）近似}%
\footnote{这个名称最早来自核物理，在那里它是通过对某个随机相位的求和得到的。}%
，这个近似要求以下两点：
\begin{itemize}
    \item $\var{{n}}$和$V_\text{eff}$之间的响应函数近似是自由电子的$\var{{n}}$-$\var{{n}}$格林函数，即我们认为$V_\text{eff}$中来自电子屏蔽的部分在其它电子上的作用和一个外加势场完全没有区别；
    \item 只考虑经典静电能，即将电子数密度期望当成经典电子数密度，忽略所有交换能或关联能。
\end{itemize}
RPA近似看起来似乎没有什么明确的意义，但它实际上把最为奇异剧烈效应考虑在内，并且给出了定性上正确的屏蔽库伦势（从一个长程的相互作用变成了一个短程的相互作用）。如果RPA近似不准，只需要多算几个微扰就可以。
这样，自洽方程可以通过下面的方法给出。
\begin{enumerate}
    \item 外加电荷引入外加电势能，
    \item 外加电势能加上屏蔽电荷产生的电势能等于总的电势能变化$V_\text{ext}$，
    \item 总的电势能变化可以反推出屏蔽电荷。
\end{enumerate}

粒子数的平均值近似为一个经典的数密度，从而$\var{V}$可以使用泊松方程写成
\[
    - \laplacian \var{V}(\vb*{r}, t) = - 4\pi e^2 \expval*{\var{{n}}(\vb*{r}, t)},
\]
也即
\begin{equation}
    k^2 \var{V}(\vb*{k}, \omega) = 4\pi e^2 \expval*{\var{{n}}(\vb*{k}, \omega)}.
\end{equation}
于是第二步完成了。

第三步通过RPA近似的基本假设得到。这里我们用$G^\text{0, ret}_{nn} (\vb*{k}, \omega)$作为$G^\text{0, ret}_{\var{n}\var{n}} (\vb*{k}, \omega)$的简写：
\begin{equation}
    \expval*{\var{{n}}(\vb*{k}, \omega)} = G^\text{0, ret}_{nn} (\vb*{k}, \omega) V_\text{eff} (\vb*{k}, \omega).
    \label{eq:rpa-approximation}
\end{equation}
这样就得到自洽方程
\[
    V_\text{ext}(\vb*{k}, \omega) + \frac{4\pi e^2}{k^2} \expval*{\var{{n}}(\vb*{k}, \omega)} = (G^\text{0, ret}_{nn} (\vb*{k}, \omega))^{-1} \expval*{\var{{n}}(\vb*{k}, \omega)},
\]
从而
\begin{equation}
    G^\text{ret}_{nn}(\vb*{k}, \omega) = \frac{G^\text{0, ret}_{nn}(\vb*{k}, \omega)}{1 - \frac{4\pi e^2}{k^2} G^\text{0, ret}_{nn}(\vb*{k}, \omega)} = \frac{G^\text{0, ret}_{nn}(\vb*{k}, \omega)}{\epsilon(\vb*{k}, \omega)},
    \label{eq:ext-electron-ret-nn}
\end{equation}
其中$\epsilon(\vb*{k}, \omega)$是介电常数。
这样，计算出自由电子的密度-密度格林函数之后问题就完全解决了。

实际上从\eqref{eq:ext-electron-ret-nn}就可以看出RPA近似的实质。将\eqref{eq:ext-electron-ret-nn}做级数展开，我们有
\[
    G^\text{ret}_{nn}(\vb*{k}, \omega) = G^\text{0, ret}_{nn}(\vb*{k}, \omega) + G^\text{0, ret}_{nn}(\vb*{k}, \omega) \frac{4\pi e^2}{k^2} G^\text{0, ret}_{nn}(\vb*{k}, \omega) + \cdots,
\]
上式两边加上电子数密度平方，并注意到$G^\text{0, ret}_{nn}(\vb*{k}, \omega)$就是电子-空穴组成的环的贡献——依照定义，自由电子的密度-密度格林函数为
\[
    \begin{aligned}
        G_{nn}^\text{0}(\vb*{r}-\vb*{r}', \tau-\tau') &= - T_\tau \expval*{\var{{n}}(\vb*{r}, \tau) \var{{n}}(\vb*{r}', \tau')} \\
        &= - T_\tau \expval*{{{n}}(\vb*{r}, \tau) {{n}}(\vb*{r}', \tau')} + \expval*{{n}(\vb*{r}, \tau)} \expval*{{n}(\vb*{r}', \tau')} \\
        &= \sum_{\sigma, \sigma'} T_\tau \expval*{{\psi}_{\sigma'}(\vb*{r}', \tau') {\psi}^\dagger_\sigma(\vb*{r}, \tau)} T_\tau \expval*{ {\psi}_\sigma(\vb*{r}, \tau) {\psi}^\dagger_{\sigma'}(\vb*{r}', \tau') } ,
    \end{aligned}
\]
其中最后一个等号用到了Wick定理——我们就发现\eqref{eq:ext-electron-ret-nn}实际上就是环形图近似。
\eqref{eq:ext-electron-ret-nn}实际上给出了$G^\text{ret}_{nn}$中最为奇异的部分，因为环形图会产生次数非常高的$1/k^n$型的项，从而发散得最厉害；但是将所有这些发散的图求和起来却能够得到一个收敛的结果。
环形图近似的成立条件是粒子数密度很高，从而主要的相互作用形式是电子通过库仑相互作用，激发出一些电子-空穴对（即环形图中的环），即主要的相互作用是环形图。
也可以从另一个角度理解这件事：粒子数密度较高意味着屏蔽作用很强，所以$1/k^n$发散得不那么厉害的那些项没有什么贡献。

由于自旋守恒性，只有$\sigma = \sigma'$的项才非零，我们得到
\[
    G_{nn}^\text{0}(\vb*{r}-\vb*{r}', \tau-\tau') = \sum_\sigma G_\sigma(\vb*{r}' - \vb*{r}, \tau' - \tau) G_\sigma(\vb*{r} - \vb*{r}', \tau - \tau').
\]
上式具有卷积的形式，切换到频谱，就是
\[
    G_{nn}^\text{0}(\vb*{q}, \ii \omega_n) = \sum_{\sigma} \sum_{\vb*{k}} \frac{1}{\beta} \sum_{\nu_n} G_\sigma(\vb*{q}, \ii \nu_n) G_\sigma(\vb*{k} + \vb*{q}, \ii (\omega_n + \nu_n)),
\]
其中
\[
    \nu_n = \frac{\pi(2n+1)}{\beta}, \quad \omega_n = \frac{2\pi n}{\beta},
\]
前者是费米子的松原频率，后者则是玻色子的，因为电子配对形成玻色子。自由费米子的谱函数为
\[
    A(\vb*{k}, \omega) = \delta(\omega - \xi_{\vb*{k}}), \quad \xi_{\vb*{k}} = \frac{\vb*{k}^2}{2m} - \mu,
\]
格林函数为
\[
    G_\sigma(\vb*{r}, \ii \omega_n) = \frac{1}{\ii \omega_n - \xi_{\vb*{k}}}.
\]
于是，有
\[
    G_{nn}^\text{0}(\vb*{q}, \ii \omega_n) = 2 \sum_{\vb*{k}} \frac{1}{\beta} \sum_{\nu_n} \frac{1}{\ii \nu_n - \xi_{\vb*{k}}} \frac{1}{\ii \omega_n + \ii \nu_n - \xi_{\vb*{k}+\vb*{q}}}.
\]
要计算上式，常用的一个技巧是将求和转化为围道积分。注意到$\{\ii \nu_n\}$正是$f(z)$的全部极点，而且这些极点都是一阶极点。
容易看出这些极点的留数都是$-1/\beta$，于是对一个在虚轴上解析的函数$F(z)$，有
\[
    \frac{1}{\beta} \sum_{\nu_n} F(\ii \nu_n) = - \oint \frac{\dd{z}}{2\pi \ii} f(z) F(z),
\]
于是设围绕虚轴的环路为$C$，它实际上就是从$-\ii \infty + 0^+$到$\ii \infty + 0^+$，再从$\ii \infty - 0^+$到$-\ii \infty - 0^+$，
有
\[
    \begin{aligned}
        G_{nn}^\text{0}(\vb*{q}, \ii \omega_n) &= - 2 \sum_{\vb*{k}} \oint_C \frac{\dd{z}}{2\pi \ii} f(z) \frac{1}{z - \xi_{\vb*{k}}} \frac{1}{z +  \ii \omega_n - \xi_{\vb*{k}+\vb*{q}}} \\
        &= 2 \sum_{\vb*{k}} \left( \frac{f(\xi_{\vb*{k}})}{\xi_{\vb*{k}} + \ii \omega_n - \xi_{\vb*{k} + \vb*{q}}} + \frac{f(\xi_{\vb*{k} + \vb*{q}} - \ii \omega_n)}{\xi_{\vb*{k} + \vb*{q}} - \ii \omega_n - \xi_{\vb*{k}}} \right).
    \end{aligned}
\]
负号消失了是因为绕极点$z=\xi_{\vb*{k}}$和$z = \xi_{\vb*{k} + \vb*{q}} - \ii \omega_n$是顺时针而不是留数定理通常是的逆时针。
由$\{\omega_n\}$的定义，$f(\xi_{\vb*{k} + \vb*{q}} - \ii \omega_n)$就是$f(\xi_{\vb*{k} + \vb*{q}})$，于是得到松原格林函数
\begin{equation}
    G_{nn}^\text{0}(\vb*{q}, \ii \omega_n) = 2 \sum_{\vb*{k}} \frac{f(\xi_{\vb*{k}}) - f(\xi_{\vb*{k} + \vb*{q}})}{\ii \omega_n + \xi_{\vb*{k}} - \xi_{\vb*{k} + \vb*{q}}}.
\end{equation}
做解析延拓就得到推迟格林函数
\begin{equation}
    G_{nn}^\text{ret, 0}(\vb*{q}, \ii \omega_n) = 2 \sum_{\vb*{k}} \frac{f(\xi_{\vb*{k}}) - f(\xi_{\vb*{k} + \vb*{q}})}{\omega + \xi_{\vb*{k}} - \xi_{\vb*{k} + \vb*{q}} + \ii 0^+}.
    \label{eq:ext-electron-retarded-green-function}
\end{equation}
介电常数为
\begin{equation}
    \epsilon(\vb*{k}, \omega) = \frac{V_\text{ext}}{V_\text{eff}} = 1 - \frac{4 \pi e^2}{k^2} G^\text{ret, 0}_{nn}(\vb*{k}, \omega)
\end{equation}

\eqref{eq:ext-electron-retarded-green-function}可以推导出托马斯-费米屏蔽。
在$V_\text{eff}$在时间和空间上都变化非常缓慢时，只需要考虑$\vb*{q}$接近零的那部分傅里叶分量。
让$\omega$和$\vb*{q}$趋于零，我们有
\[
    G_{nn}^\text{ret, 0}(\vb*{q}, \ii \omega_n) = 2 \sum_{\vb*{k}} \dv{f(\xi_{\vb*{k}})}{\xi_{\vb*{k}}} = - 2 \sum_{\vb*{k}} \dv{f(\xi_{\vb*{k}})}{\mu} = - \pdv{n}{\mu} = - N(0),
\]
这正是我们在托马斯-费米屏蔽中做的近似。这也表明RPA近似至少在低频下是合理的。

\subsubsection{等离子体和等离激元}

考虑$\omega$非常高的极限，此时做展开
\[
    \frac{1}{\omega + \xi_{\vb*{k}} - \xi_{\vb*{k} + \vb*{q}} + \ii 0^+} = \frac{1}{\omega} - \frac{\xi_{\vb*{k}} - \xi_{\vb*{k} + \vb*{q}}}{\omega^2} + \cdots,
\]
展开到前两阶，代入\eqref{eq:ext-electron-retarded-green-function}，得到
\[
    \begin{aligned}
        G_{nn}^\text{ret, 0}(\vb*{q}, \ii \omega_n) &= - \frac{2}{\omega^2} \sum_{\vb*{k}} (f(\xi_{\vb*{k}}) - f(\xi_{\vb*{k} + \vb*{q}})) (\xi_{\vb*{k}} - \xi_{\vb*{k} + \vb*{q}}) \\
        &= \frac{2 q^2}{m \omega^2} \sum_{\vb*{k}} f(\xi_{\vb*{k}}), 
    \end{aligned}
\]
于是就得到
\begin{equation}
    G_{nn}^\text{ret, 0}(\vb*{q}, \ii \omega_n) = \frac{q^2 n_\text{e}}{m \omega^2},
\end{equation}
相应的，
\[
    \epsilon(\vb*{k}, \omega \to 0) = 1 - \frac{4 \pi e^2 n_\text{e}}{m \omega^2},
\]
定义
\begin{equation}
    \omega_\text{p}^2 = \frac{4 \pi e^2 n_\text{e}}{m},
\end{equation}
就得到
\begin{equation}
    \epsilon(\vb*{k}, \omega \to 0) = 1 - \frac{\omega_\text{p}^2}{\omega^2}.
\end{equation}
考虑到\eqref{eq:ext-electron-ret-nn}，当$\omega = \omega_\text{p}$时格林函数出现奇点，即此处有集体激发。实际上，这正是\concept{等离激元}。
$G^\text{ret}_{nn}(\vb*{k}, \omega)$是一个密度-密度格林函数，对任意的动量，在$\omega = \omega_\text{p}$处都有一个密度波的集体激发模式。
这个集体激发的频谱是平的，这当然是因为我们假定光速无穷大，完全使用库伦相互作用。如果考虑到光速有限，使用麦克斯韦方程可以推出
\begin{equation}
    \omega_{\vb*{k}}^2 = \omega_\text{p}^2 + c^2 k^2,
\end{equation}
即光子的一个模式和固体发生耦合，打开了一个能隙。在假定光速无限时，丢弃不可见、恒定的无穷大项（相当于将元激发的产生湮灭算符的时间演化加上一个因子$\ee^{\ii c k t}$）就得到
\[
    \omega_{\vb*{k}} = \omega_\text{p},
\]
即我们算出的结果。

TODO：自能修正会影响吗？注意$-\Sigma$才是全体自能正规图的和。