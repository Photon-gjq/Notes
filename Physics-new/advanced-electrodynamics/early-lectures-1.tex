\documentclass[hyperref, a4paper]{article}

\usepackage{geometry}
\usepackage{titling}
\usepackage{titlesec}
% No longer needed, since we will use enumitem package
% \usepackage{paralist}
\usepackage{enumitem}
\usepackage{footnote}
\usepackage{enumerate}
\usepackage{amsmath, amssymb, amsthm}
\usepackage{mathtools}
\usepackage{bbm}
\usepackage{cite}
\usepackage{graphicx}
\usepackage{subfigure}
\usepackage{physics}
\usepackage{tensor}
\usepackage{siunitx}
\usepackage[version=4]{mhchem}
\usepackage{tikz}
\usepackage{xcolor}
\usepackage{listings}
\usepackage{autobreak}
\usepackage[ruled, vlined, linesnumbered]{algorithm2e}
\usepackage{nameref,zref-xr}
\zxrsetup{toltxlabel}
\zexternaldocument*[optics-]{../optics/optics}[optics.pdf]
\zexternaldocument*[solid-]{../solid/solid}[solid.pdf]
\zexternaldocument*[113-]{lecture-11-3}[lecture-11-3.pdf]
\usepackage[colorlinks,unicode]{hyperref} % , linkcolor=black, anchorcolor=black, citecolor=black, urlcolor=black, filecolor=black
\usepackage[most]{tcolorbox}
\usepackage{prettyref}

% Page style
\geometry{left=3.18cm,right=3.18cm,top=2.54cm,bottom=2.54cm}
\titlespacing{\paragraph}{0pt}{1pt}{10pt}[20pt]
\setlength{\droptitle}{-5em}
\preauthor{\vspace{-10pt}\begin{center}}
\postauthor{\par\end{center}}

% More compact lists 
%\setlist[itemize]{
%    itemindent=17pt, 
%    leftmargin=1pt,
%    listparindent=\parindent,
%    parsep=0pt,
%}

% Math operators
\DeclareMathOperator{\timeorder}{\mathcal{T}}
\DeclareMathOperator{\diag}{diag}
\DeclareMathOperator{\legpoly}{P}
\DeclareMathOperator{\primevalue}{P}
\DeclareMathOperator{\sgn}{sgn}
\newcommand*{\ii}{\mathrm{i}}
\newcommand*{\ee}{\mathrm{e}}
\newcommand*{\const}{\mathrm{const}}
\newcommand*{\suchthat}{\quad \text{s.t.} \quad}
\newcommand*{\argmin}{\arg\min}
\newcommand*{\argmax}{\arg\max}
\newcommand*{\normalorder}[1]{: #1 :}
\newcommand*{\pair}[1]{\langle #1 \rangle}
\newcommand*{\fd}[1]{\mathcal{D} #1}
\DeclareMathOperator{\bigO}{\mathcal{O}}

% TikZ setting
\usetikzlibrary{arrows,shapes,positioning}
\usetikzlibrary{arrows.meta}
\usetikzlibrary{decorations.markings}
\tikzstyle arrowstyle=[scale=1]
\tikzstyle directed=[postaction={decorate,decoration={markings,
    mark=at position .5 with {\arrow[arrowstyle]{stealth}}}}]
\tikzstyle ray=[directed, thick]
\tikzstyle dot=[anchor=base,fill,circle,inner sep=1pt]

% Algorithm setting
% Julia-style code
\SetKwIF{If}{ElseIf}{Else}{if}{}{elseif}{else}{end}
\SetKwFor{For}{for}{}{end}
\SetKwFor{While}{while}{}{end}
\SetKwProg{Function}{function}{}{end}
\SetArgSty{textnormal}

\newcommand*{\concept}[1]{{\textbf{#1}}}

% Support for tensor double arrows.
\renewcommand{\tensor}[1]{ \stackrel{\leftrightarrow}{\vb*{#1}}}

% Embedded codes
\lstset{basicstyle=\ttfamily,
  showstringspaces=false,
  commentstyle=\color{gray},
  keywordstyle=\color{blue}
}

% Reference formatting
\newrefformat{fig}{Figure~\ref{#1} on page~\pageref{#1}}

% Color boxes
\tcbuselibrary{skins, breakable, theorems}
\newtcbtheorem[number within=section]{warning}{Warning}%
  {colback=orange!5,colframe=orange!65,fonttitle=\bfseries, breakable}{warn}
\newtcbtheorem[number within=section]{note}{Note}%
  {colback=green!5,colframe=green!65,fonttitle=\bfseries, breakable}{note}

\newcommand{\opticsdoc}{\href{../optics/optics.pdf}{this optics note}}

\title{Advanced Electrodynamics by Prof. Kun Din}
\author{Jinyuan Wu}

\begin{document}

\maketitle

Some contents of the first several lectures are covered in \opticsdoc,
but some technical details are worth a separate note.

\section{Guiding vectors and eigenmodes}

We use the guiding vector method to find eigenmodes in 
several systems. Here we summarize the procedure: what we want to do is to solve the equation 
\begin{equation}
    (\laplacian + k^2) \vb*{M} = 0, \quad \div{\vb*{M}} = 0.
\end{equation}
By doing so we can make the ansatz 
\begin{equation}
    \vb*{M} = \curl(\psi \vb*{c}), \quad \div{\vb*{c}} = \const, \quad \curl{\vb*{c}} = 0, 
\end{equation}
which is always possible. (see \eqref{optics-sec:guiding-vector} in \opticsdoc) Now what should be done is 
to find a certain $\vb*{c}$ and then solve 

TODO



\section{Effective continuous medium}

Suppose $f(\vb*{r})$ is a filter or ``smoother''. Suppose the electric charge is 
\begin{equation}
    \eta(\vb*{r}) = \sum_n \sum_{i \in C_n} q_i \delta(\vb*{r} - \vb*{r}_i),
\end{equation}
where $n$ is the index of clusters of electrons, most frequently moleculars. The smoothened version is 
\[
    \begin{aligned}
        \expval{\eta}(\vb*{r}) &= \int \dd[3]{\vb*{r}'} \eta(\vb*{r} - \vb*{r}') f(\vb*{r}') \\
        &= \int \dd[3]{\vb*{r}'} \sum_n \sum_{i \in C_n} q_i \delta(\vb*{r} - \vb*{r}' - \vb*{r}_i) 
        \int \frac{\dd[3]{\vb*{k}}}{(2\pi)^3} f(\vb*{k}) \ee^{\ii \vb*{k} \cdot \vb*{r}'} \\
        &= \sum_n \int \frac{\dd[3]{\vb*{k}}}{(2\pi)^3} f(\vb*{k}) \sum_{i \in C_n} \ee^{\ii \vb*{k} \cdot (\vb*{r} - \vb*{r}_i)} \\
        &= \sum_n \int \frac{\dd[3]{\vb*{k}}}{(2\pi)^3} f(\vb*{k}) \ee^{\ii \vb*{k} \cdot (\vb*{r} - \vb*{r}_n)} \sum_{i \in C_n} \ee^{\ii \vb*{k} \cdot (\vb*{r}_n - \vb*{r}_i)} \\
        &= \sum_n \int \frac{\dd[3]{\vb*{k}}}{(2\pi)^3} f(\vb*{k}) \ee^{\ii \vb*{k} \cdot (\vb*{r} - \vb*{r}_n)} \sum_{i \in C_n} (1 - \ii \vb*{k} \cdot (\vb*{r}_i - \vb*{r}_n) + \cdots),
    \end{aligned}
\]
and if the perturbation of the charges is not strong, we can make a cutoff and get 
\[
    \begin{aligned}
        &\quad \sum_n \int \frac{\dd[3]{\vb*{k}}}{(2\pi)^3} f(\vb*{k}) \ee^{\ii \vb*{k} \cdot (\vb*{r} - \vb*{r}_n)} \sum_{i \in C_n} (1 - \ii \vb*{k} \cdot (\vb*{r}_i - \vb*{r}_n)) \\
        &= \sum_n \int \frac{\dd[3]{\vb*{k}}}{(2\pi)^3} f(\vb*{k}) \ee^{\ii \vb*{k} \cdot (\vb*{r} - \vb*{r}_n)} (q_n - \ii \vb*{k} \cdot \vb*{p}_n) \\
        &= \sum_n \left( q_n \int \frac{\dd[3]{\vb*{k}}}{(2\pi)^3} f(\vb*{k}) \ee^{\ii \vb*{k} \cdot (\vb*{r} - \vb*{r}_n)} - \vb*{p}_n \cdot \grad \int \frac{\dd[3]{\vb*{k}}}{(2\pi)^3} f(\vb*{k}) \ee^{\ii \vb*{k} \cdot (\vb*{r} - \vb*{r}_n)}  \right) \\
        &= \sum_n (q_n f(\vb*{r} - \vb*{r}_n) - \vb*{p}_n \cdot \grad f(\vb*{r} - \vb*{r}_n)) \\
        &= \sum_n (q_n f(\vb*{r} - \vb*{r}_n) - \div(\vb*{p}_n f(\vb*{r} - \vb*{r}_n))) .
    \end{aligned}
\]
Now we note that 
\[
    \expval{ \delta(\vb*{r} - \vb*{r}_n)} = f(\vb*{r} - \vb*{r}_n), 
\]
and we get 
\begin{equation}
    \expval{\eta}(\vb*{r}) = \rho(\vb*{r}) - \div{\vb*{P}(\vb*{r})},
\end{equation}
where 
\begin{equation}
    \rho(\vb*{r}) = \expval{\sum_n q_n \delta(\vb*{r} - \vb*{r}_n)}, \quad 
    \vb*{P}(\vb*{r}) = \expval{\sum_n \vb*{p}_n \delta(\vb*{r} - \vb*{r}_n)}   .
\end{equation}

TODO: magnetic average

\section{Constitutive relations}

\begin{equation}
    \vb*{D} = \epsilon_0 \vb*{E} + \vb*{P} = \epsilon_0 (1 + \chi_\text{e}) \vb*{E}, \quad 
    \vb*{H} = \frac{\vb*{B}}{\mu_0} - \vb*{M},
\end{equation}
\begin{equation}
    \div{\vb*{P}} = - \rho,
\end{equation}


\section{Frequency dispersion and the Clausius-Mossotti equation}

Now we work on a frequent mechanism of frequency dispersion, i.e. the response of the material depending on 
$\omega$. We consider a oscillator model, where the electrons can be seen as oscillators, 
the EOM of each of which is
\begin{equation}
    m \ddot{\vb*{r}} = - m \omega_0^2 \vb*{r} - m \gamma \vb*{r} + e \vb*{E}_\text{driving}.
\end{equation}
Note that though the electrons has no interaction, but first, since the electrons are immersed in the 
radiation created by themselves, $m$, $\gamma$, and $\omega_0$ will be modified, and second, an electron 
can feel the collective electric field of other electrons, and there must be a term for this in 
$\vb*{E}_\text{drive}$. Since $\vb*{E}_\text{other electrons} + \vb*{E}_\text{this electron}$ has no
long scale effects and only modifies $m$, $\gamma$, and $\omega_0$ (because they it modifies the lattice potential
and therefore change $\omega_0$, and it also modifies the phonon spectrum, thus modifying $\gamma$, and 
since we know the radiation of a moving charge has a term proportion to $\ddot{\vb*{d}}$, $m$ is also modified),
we can say that 
\[
    \vb*{E}_\text{driving} = \vb*{E}_\text{external} - \vb*{E}_\text{self}.
\]
Here and after we write $\vb*{E}_\text{external}$ as $\vb*{E}$, and we have 
\begin{equation}
    m \ddot{\vb*{r}} = - m \omega_0^2 \vb*{r} - m \gamma \vb*{r} + e (\vb*{E} - \vb*{E}_\text{self}).
\end{equation}
Note that this can also be seen as ``using $\vb*{E}_\text{self}$ to modify $m$, $\omega_0$ and $\gamma$ and
subtracting $\vb*{E}_\text{sef}$ from $\vb*{E}$''. A more generalized discussion of the modifications 
can be found in discussions around \eqref{optics-eq:local-electric-field-enhancement} in \opticsdoc.
What we are doing is actually a self-energy correction.

Suppose $\vb*{r} \propto \ee^{- \ii \omega t}$, and we have 
\begin{equation}
    e\vb*{r} \eqqcolon \vb*{d} = \alpha \vb*{E}, \quad \alpha = \frac{e^2}{m (\omega_0^2 - \omega^2 - \ii \gamma \omega)}.
    \label{eq:alpha-oscillators}
\end{equation}
The long range radiation is summarized as 
\begin{equation}
    \vb*{P} = N \vb*{d} = N \alpha (\vb*{E} - \vb*{E}_\text{self}),
\end{equation}
where $N$ is the number of electrons per volume unit, and if we approximate the self field as 
\begin{equation}
    \vb*{E}_\text{sef} = - \frac{\vb*{P}}{3 \epsilon_0},
\end{equation}
which is the field strength in a empty cavity in a homogeneously polarized insulator, and more generally, is the 
self field of a large number of dipoles (see \eqref{113-eq:self-field-dipole} in 
\href{lecture-11-3.pdf}{this note}), then we get 
\begin{equation}
    \vb*{P} = \frac{N \alpha}{1 - \frac{N \alpha}{3 \epsilon_0}} \vb*{E} \eqqcolon \epsilon_0 \chi_\text{e} \vb*{E},
\end{equation}
\begin{equation}
    \chi_\text{e} = \frac{N \alpha / \epsilon_0}{1 - N \alpha / (3 \epsilon_0)}, \quad \frac{\epsilon_\text{r} - 1}{\epsilon_\text{r} + 2} = \frac{N \alpha}{3 \epsilon_0}.
    \label{eq:clausius-mossotti}
\end{equation}
This is the so-called \concept{Clausius-Mossotti equations}.

Now we put \eqref{eq:alpha-oscillators} into \eqref{eq:clausius-mossotti}, and get 
\[
    \epsilon_\text{r} = 1 + \chi_\text{e} = 1 + \frac{1}{\left(\frac{N e^2}{m \epsilon_0}\right)^{-1} (\omega_0^2 - \omega^2 - \ii \gamma \omega) - \frac{1}{3}}, 
\]
and therefore after introducing the plasma frequency we get 
\begin{equation}
    \epsilon_\text{r} = 1 + \chi_\text{e} = 1 + \frac{\omega_\text{p}^2}{\tilde{\omega}_0^2 - \omega^2 - \ii \gamma \omega}, \quad \tilde{\omega}_0^2 = \omega_0^2 - \frac{1}{3} \omega_\text{p}^2, \quad \omega_\text{p}^2 = \frac{N e^2}{m \epsilon_0}.
    \label{eq:clausius-epsilon}
\end{equation}
This equation means a non-trivial photon band structure. Now we assume $\gamma = 0$, and because we have 
\begin{equation}
    k^2 = \left(\frac{\omega}{c}\right)^2 \epsilon_\text{r}(\omega),
\end{equation}
it is possible that $\epsilon_\text{r} < 0$ in some frequencies. The photon band structure, therefore, has 
a forbidden band. This is visualize in \prettyref{fig:clausius-epsilon}. It is easy to verify that 
\begin{equation}
    \omega_\text{L} = \sqrt{\tilde{\omega}_0^2 + \omega_\text{p}^2}, \quad \omega_\text{T} = \tilde{\omega}_0.
\end{equation}
The subscripts have meanings. When $\omega = \omega_\text{L}$, $\epsilon_\text{r} = 0$, and the equation
\[
    0 = \div{\vb*{D}} = \epsilon_\text{r} \div{\vb*{E}}
\]
is trivial, and it is possible that $\div{\vb*{E}} \neq 0$. So we see the subscript L means ``longitude mode''.
When $\omega = \omega_\text{T} = \tilde{\omega}_0$, the oscillators oscillate in its eigen mode and are coupled 
strongly to the electromagnetic field. Both of them vibrate transversely. Since there is no interaction between 
oscillators, the dispersion relation of density wave modes of these oscillators is a flat line, independent of 
$\vb*{k}$, with the frequency $\omega_\text{T}$. That is the meaning of the subscript T: the ``transverse density mode''.

\begin{figure}
    \centering
    \input{early-figures/clausius-band.tex}
    \caption{The photon band structure of \eqref{eq:clausius-epsilon}}
    \label{fig:clausius-epsilon}
\end{figure}

\end{document}