\documentclass[hyperref, a4paper]{article}

\usepackage{geometry}
\usepackage{titling}
\usepackage{titlesec}
% No longer needed, since we will use enumitem package
% \usepackage{paralist}
\usepackage{enumitem}
\usepackage{footnote}
\usepackage{enumerate}
\usepackage{amsmath, amssymb, amsthm}
\usepackage{mathtools}
\usepackage{bbm}
\usepackage{cite}
\usepackage{graphicx}
\usepackage{subfigure}
\usepackage{physics}
\usepackage{tensor}
\usepackage{siunitx}
\usepackage[version=4]{mhchem}
\usepackage{tikz}
\usepackage{xcolor}
\usepackage{listings}
\usepackage{autobreak}
\usepackage[ruled, vlined, linesnumbered]{algorithm2e}
\usepackage{nameref,zref-xr}
\zxrsetup{toltxlabel}
\usepackage[colorlinks,unicode]{hyperref} % , linkcolor=black, anchorcolor=black, citecolor=black, urlcolor=black, filecolor=black
\usepackage{prettyref}

% Page style
\geometry{left=3.18cm,right=3.18cm,top=2.54cm,bottom=2.54cm}
\titlespacing{\paragraph}{0pt}{1pt}{10pt}[20pt]
\setlength{\droptitle}{-5em}
\preauthor{\vspace{-10pt}\begin{center}}
\postauthor{\par\end{center}}

% More compact lists 
%\setlist[itemize]{
    %itemindent=17pt, 
    %leftmargin=1pt,
    %listparindent=\parindent,
    %parsep=0pt,
%}

% Math operators
\DeclareMathOperator{\timeorder}{\mathcal{T}}
\DeclareMathOperator{\diag}{diag}
\DeclareMathOperator{\legpoly}{P}
\DeclareMathOperator{\primevalue}{P}
\DeclareMathOperator{\sgn}{sgn}
\newcommand*{\ii}{\mathrm{i}}
\newcommand*{\ee}{\mathrm{e}}
\newcommand*{\const}{\mathrm{const}}
\newcommand*{\suchthat}{\quad \text{s.t.} \quad}
\newcommand*{\argmin}{\arg\min}
\newcommand*{\argmax}{\arg\max}
\newcommand*{\normalorder}[1]{: #1 :}
\newcommand*{\pair}[1]{\langle #1 \rangle}
\newcommand*{\fd}[1]{\mathcal{D} #1}
\DeclareMathOperator{\bigO}{\mathcal{O}}

% TikZ setting
\usetikzlibrary{arrows,shapes,positioning}
\usetikzlibrary{arrows.meta}
\usetikzlibrary{decorations.markings}
\tikzstyle arrowstyle=[scale=1]
\tikzstyle directed=[postaction={decorate,decoration={markings,
    mark=at position .5 with {\arrow[arrowstyle]{stealth}}}}]
\tikzstyle ray=[directed, thick]
\tikzstyle dot=[anchor=base,fill,circle,inner sep=1pt]

% Algorithm setting
% Julia-style code
\SetKwIF{If}{ElseIf}{Else}{if}{}{elseif}{else}{end}
\SetKwFor{For}{for}{}{end}
\SetKwFor{While}{while}{}{end}
\SetKwProg{Function}{function}{}{end}
\SetArgSty{textnormal}

\newcommand*{\concept}[1]{{\textbf{#1}}}

% Embedded codes
\lstset{basicstyle=\ttfamily,
  showstringspaces=false,
  commentstyle=\color{gray},
  keywordstyle=\color{blue}
}

\newcommand{\opticsdoc}{\href{../optics/optics}{the optics note}}
\newcommand{\soliddoc}{\href{../solid/solid}{the solid state physics note}}

\newrefformat{fig}{Figure~\ref{#1} on page~\pageref{#1}}
\newrefformat{sec}{Section~\ref{#1}}

\title{Mode-Coupling Theory of the Glass Transition}
\author{Jinyuan Wu}

\begin{document}

\maketitle

The \concept{Mode-Coupling Theory (MCT)} is the only known theory about glass transition that are
first-principles-based \cite{mct2005,mct-primer}. It uses the Mori-Zwanzig formalism 
\cite{MoriZwanzigformalismWikipedia} to integrate out unnecessary degrees of freedom and focuses 
on quantities that characterize glasses.

\section{A review of Mori-Zwanzig formalism}

First we have a brief review of the Mori-Zwanzig formalism. 
It says that any time-dependent quantity $A$ obeying the (generalized) Heisenberg equation 
\begin{equation}
    \dv*{A}{t} = \ii \mathcal{L} A
\end{equation}
also obeys the closed-form equation
\begin{equation}
    {\dot {A}}(t)= \ii \Omega A(t) - \int _{0}^{t} \dd{s} K(s)A(t-s)+F(t).
    \label{eq:closed-form-a}
\end{equation}
The three terms on the RHS are named as the \concept{frequency matrix}, the \concept{memory function}, 
and the \concept{fluctuating force}, respectively. The fluctuating force collects all ``fast'' variables that 
are orthogonal to $A$, and the memory function is the time autocorrelation function of the fluctuating force.
These two terms represent how $A$ gets connected to (in the case in a quantum theory, entangled with) the degrees of
freedom that are ignored. 
Assuming we already have an inner product defined on physical quantities, which is usually 
\begin{equation}
    (A, B) = \expval*{A^* B},
    \label{eq:inner-product-def}
\end{equation}
we have 
\begin{equation}
    \ii \Omega =(A, \ii \mathcal{L} A)(A,A)^{-1},
\end{equation}
\begin{equation}
    F(t)=\ee^{\ii t(1-\mathcal{P}) \mathcal{L}}\ii (1-\mathcal{P}) \mathcal{L} A, \quad (F(t), A(0)) = 0,
\end{equation}
and 
\begin{equation}
    K(t)=- (\ii \mathcal{L} F(t),A)(A,A)^{-1} = (F(0), F(t)) (A,A)^{-1},
    \label{eq:k-def}
\end{equation}
where 
\begin{equation}
    \mathcal{P} X=(A,A)^{-1}(X,A)A.
\end{equation}
Note that the convention of notation varies in the literature, and the two expressions of $K(t)$ in \eqref{eq:k-def}
can both be seen. We require $A$ to be ``slow'' variables (or satisfy other conditions that somehow separate it 
from other degrees of freedom), or otherwise fluctuation is too strong for $A$ to be a useful quantity.

Of course we can have several slow variables and several fast variables. Therefore, we may replace $A$ by a vector. 
Note that at this time, $\Omega, F$ and $K$ are matrices, and it can be found that \eqref{eq:inner-product-def}
should be replaced by 
\begin{equation}
    \expval*{A, B} = \expval*{A^* B^\top},
\end{equation} 
instead of 
\[
    \expval*{A, B} = \expval*{A^\dagger B}.
\]

\section{The exact MCT equation} 

Now we go back to derive a theory about glass transition. 
The derivation shown below is mainly based on \cite{mct2005}, but the notation is from \cite{RevModPhys.76.785}.
Note that the spacial translation symmetry gives 
\begin{equation}
    \expval*{\rho(0, 0) \rho(\vb*{r}, t)} = \frac{1}{V} \int \frac{\dd[3]{\vb*{k}}}{(2\pi)^3} 
    \ee^{- \ii \vb*{k} \cdot \vb*{r}} \expval*{\rho_{-\vb*{k}}(0) \rho_{\vb*{k}}(t)},
\end{equation}
and since no valuable information is provided when $\abs*{\vb*{r}} \to 0$, we will work on the correlation function
in the momentum space to separate different spatial scales.
What we are going to do is to find a self-consistent equation about the density-density correlation function in 
the small momentum region (or the large $\abs*{\vb*{r}}$ region). We denote the correlation function as 
\begin{equation}
    F(k, t)=\frac{1}{N}\left\langle\rho_{-\vb*{k}}(0) \rho_{\vb*{k}}(t)\right\rangle=\frac{1}{N} \sum_{i j}\left\langle \ee^{-\ii \vb*{k} \cdot \vb*{r}_{i}(0)} \ee^{\ii \vb*{k} \cdot \vb*{r}_{j}(t)}\right\rangle,
\end{equation}
where 
\begin{equation}
    \begin{aligned}
        \rho_{\vb*{k}}(t) &= \int \dd[3]{\vb*{r}} \ee^{\ii \vb*{k} \cdot \vb*{r}} \rho(\vb*{r}, t) \\
        &=\sum_{i} \int \dd[3]{\vb*{r}} \ee^{\ii \vb*{k} \cdot \vb*{r}} \delta\left(\vb*{r}-\vb*{r}_{i}(t)\right) \\
        &=\sum_{i} \ee^{\ii \vb*{k} \cdot \vb*{r}_{i}(t)}.
    \end{aligned}
\end{equation}
Specifically, we have 
\begin{equation}
    F(k, 0) = S(k),
\end{equation}
which is the static structural factor.

We are going to apply the Mori-Zwanzig formalism to $F(k, t)$. We need to find some slow variables
and apply \eqref{eq:closed-form-a} to them to find their dynamics, and then we are able to find the dynamics 
of $F(k, t)$. It can be easily noticed that since we are interested in the small $k$ region, the time derivative 
\[
    \dot{\rho}_{\vb*{k}} = \sum_i \frac{\ii \vb*{k} \cdot \vb*{p}_i}{m} \ee^{\ii \vb*{k} \cdot \vb*{r}_i }
\]
is also small, and therefore $\rho_{\vb*{k}}(t)$ is a slow variable. Then we also find that 
\[
    \ii \abs*{\vb*{k}} j_{\vb*{k}}^\text{L} = \ii \vb*{k} \cdot 
    \underbrace{\sum_{i} \frac{\vb*{p}_i}{m} \ee^{\ii \vb*{k} \cdot \vb*{r}}}_{\vb*{j}_{\vb*{k}}}
\]
is a slow variable. So the slow variable set is 
\begin{equation}
    \vb{A} = \pmqty{\var{\rho_{\vb*{k}}} \\ j_{\vb*{k}}^\text{L}},  
\end{equation}
where 
\begin{equation}
    \var{\rho_{\vb*{k}}} = \rho_{\vb*{k}} - \expval*{\rho_{\vb*{k}}} 
    = \sum_{i} \ee^{\ii \vb*{q} \cdot \vb*{r}_i} - (2\pi)^3 \rho \delta(\vb*{q}).
\end{equation}

Applying \eqref{eq:closed-form-a} to $\vb{A}$, we have 
\[
    \dot{\vb{A}}(t)= \ii \vb{\Omega} \vb{A}(t) - \int_{0}^{t} \dd{s} \vb{K}(s) \vb{A}(t-s)+ \vb{F}(t),
\]
and since 
\[
    \expval*{\vb{A}(0), \vb{F}(t)} = \expval*{\vb{A}(0)^* \vb{F}(t)^\top} = 0, 
\]
which is a result in the Mori-Zwanzig formalism, we have 
\begin{equation}
    \dot{\vb{C}} = \ii \vb{\Omega} \vb{C}(t) - \int_{0}^{t} \dd{s} \vb{K}(s) \vb{C}(t-s),
\end{equation}
where we have 
\begin{equation}
    \vb{C}(t) = \expval*{\vb{A}(0)^* \vb{A}(t)^\top} = \pmqty{\left\langle\delta \rho_{-\vb*{q}}(0) \delta \rho_{\vb*{q}}(t)\right\rangle & \left\langle\delta \rho_{-\vb*{q}} j_{\vb*{q}}^\text{L}(t)\right\rangle \\
    \left\langle j_{-\vb*{q}}^\text{L}(0) \delta \rho_{\vb*{q}}(t)\right\rangle & \left\langle j_{-\vb*{q}}^\text{L}(0) j_{\vb*{q}}^\text{L}(t)\right\rangle},
\end{equation}
\begin{equation}
    \begin{aligned}
        \ii \vb{\Omega} &= \expval*{\vb{A}, \dot{\vb{A}}} \expval*{\vb{A}, \vb{A}}^{-1} \\
        &= \pmqty{ 
            \expval*{\var{\rho_{-\vb*{q}}} \var{\dot{\rho}_{\vb*{q}}} } &
            \expval*{\var{\rho_{-\vb*{q}}} \var{\dot{j}^\text{L}_{\vb*{q}}} } \\
            \expval*{\var{j^\text{L}_{-\vb*{q}}} \var{\dot{\rho}_{\vb*{q}}} } &
            \expval*{\var{j^\text{L}_{-\vb*{q}}} \var{\dot{j}^\text{L}_{\vb*{q}}} }} 
        \pmqty{ 
            \expval*{\var{\rho_{-\vb*{q}}} \var{{\rho}_{\vb*{q}}} } &
            \expval*{\var{\rho_{-\vb*{q}}} \var{{j}^\text{L}_{\vb*{q}}} } \\
            \expval*{\var{j^\text{L}_{-\vb*{q}}} \var{{\rho}_{\vb*{q}}} } &
            \expval*{\var{j^\text{L}_{-\vb*{q}}} \var{{j}^\text{L}_{\vb*{q}}} } }^{-1}
    \end{aligned}
    \label{eq:omega-def}
\end{equation}
Note that unitarity guarantees that the $\expval*{\vb{A}, \vb{A}}$ factor in \eqref{eq:omega-def} is constant,
and therefore we have 
\[
    \pmqty{ 
            \expval*{\var{\rho_{-\vb*{q}}} \var{{\rho}_{\vb*{q}}} } &
            \expval*{\var{\rho_{-\vb*{q}}} \var{{j}^\text{L}_{\vb*{q}}} } \\
            \expval*{\var{j^\text{L}_{-\vb*{q}}} \var{{\rho}_{\vb*{q}}} } &
            \expval*{\var{j^\text{L}_{-\vb*{q}}} \var{{j}^\text{L}_{\vb*{q}}} } 
        } = \pmqty{
            N S(q) & 0 \\ 
            0 &  \frac{N k_\text{B} T}{m}
        },
\]
where 
\[
    \expval*{\var{\rho_{-\vb*{q}}} \var{{j}^\text{L}_{\vb*{q}}} } \propto \vb*{q} \cdot \expval*{\vb*{p}}  = 0,
\]
and 
Here and below we calculate all expectations with the assumption that the translational symmetry is not broken,
and therefore the probabilistic distributions of positions and momenta are independent.

\bibliographystyle{plain}
\bibliography{glass} 

\end{document}