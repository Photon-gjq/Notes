\documentclass[hyperref, a4paper]{article}

\usepackage{geometry}
\usepackage{titling}
\usepackage{titlesec}
% No longer needed, since we will use enumitem package
% \usepackage{paralist}
\usepackage{enumitem}
\usepackage{footnote}
% Conflicts with enumitem
%\usepackage{enumerate}
\usepackage{amsmath, amssymb, amsthm}
\usepackage{mathtools}
\usepackage{bbm}
\usepackage{cite}
\usepackage{graphicx}
\usepackage{subcaption}
\usepackage{physics}
\usepackage{tensor}
\usepackage{siunitx}
\usepackage[version=4]{mhchem}
\usepackage{tikz}
\usepackage{xcolor}
\usepackage{listings}
\usepackage{autobreak}
\usepackage[ruled, vlined, linesnumbered]{algorithm2e}
\usepackage{nameref,zref-xr}
\zxrsetup{toltxlabel}
%\zexternaldocument*[optics-]{../optics/optics}[optics.pdf]
%\zexternaldocument*[solid-]{../solid/solid}[solid.pdf]
\usepackage[colorlinks,unicode]{hyperref} % , linkcolor=black, anchorcolor=black, citecolor=black, urlcolor=black, filecolor=black
\usepackage[most]{tcolorbox}
\usepackage{prettyref}

% Page style
\geometry{left=3.18cm,right=3.18cm,top=2.54cm,bottom=2.54cm}
\titlespacing{\paragraph}{0pt}{1pt}{10pt}[20pt]
\setlength{\droptitle}{-5em}
\preauthor{\vspace{-10pt}\begin{center}}
\postauthor{\par\end{center}}

% More compact lists 
\setlist[itemize]{
    itemindent=17pt, 
    leftmargin=1pt,
    listparindent=\parindent,
    parsep=0pt,
}

% Math operators
\DeclareMathOperator{\timeorder}{\mathcal{T}}
\DeclareMathOperator{\diag}{diag}
\DeclareMathOperator{\legpoly}{P}
\DeclareMathOperator{\primevalue}{P}
\DeclareMathOperator{\sgn}{sgn}
\newcommand*{\ii}{\mathrm{i}}
\newcommand*{\ee}{\mathrm{e}}
\newcommand*{\const}{\mathrm{const}}
\newcommand*{\suchthat}{\quad \text{s.t.} \quad}
\newcommand*{\argmin}{\arg\min}
\newcommand*{\argmax}{\arg\max}
\newcommand*{\normalorder}[1]{: #1 :}
\newcommand*{\pair}[1]{\langle #1 \rangle}
\newcommand*{\fd}[1]{\mathcal{D} #1}
\DeclareMathOperator{\bigO}{\mathcal{O}}
\DeclareMathOperator{\li}{Li}

% TikZ setting
\usetikzlibrary{arrows,shapes,positioning}
\usetikzlibrary{calc}
\usetikzlibrary{arrows.meta}
\usetikzlibrary{decorations.markings}
\tikzstyle arrowstyle=[scale=1]
\tikzstyle directed=[postaction={decorate,decoration={markings,
    mark=at position .5 with {\arrow[arrowstyle]{stealth}}}}]
\tikzstyle ray=[directed, thick]
\tikzstyle dot=[anchor=base,fill,circle,inner sep=1pt]

% Algorithm setting
% Julia-style code
\SetKwIF{If}{ElseIf}{Else}{if}{}{elseif}{else}{end}
\SetKwFor{For}{for}{}{end}
\SetKwFor{While}{while}{}{end}
\SetKwProg{Function}{function}{}{end}
\SetArgSty{textnormal}

\newcommand*{\concept}[1]{{\textbf{#1}}}

% Embedded codes
\lstset{basicstyle=\ttfamily,
  showstringspaces=false,
  commentstyle=\color{gray},
  keywordstyle=\color{blue}
}

% Support for tensor double arrows.
\renewcommand{\tensor}[1]{ \stackrel{\leftrightarrow}{\vb*{#1}}}

% Reference formatting
\newrefformat{fig}{Figure~\ref{#1} on page~\pageref{#1}}

% Color boxes
\tcbuselibrary{skins, breakable, theorems}
\newtcbtheorem[number within=section]{warning}{Warning}%
  {colback=orange!5,colframe=orange!65,fonttitle=\bfseries, breakable}{warn}
\newtcbtheorem[number within=section]{note}{Note}%
  {colback=green!5,colframe=green!65,fonttitle=\bfseries, breakable}{note}

\title{Project}
\author{Jinyuan Wu}

\begin{document}

\maketitle

\begin{figure}
    \centering
    \begin{subfigure}{0.45\textwidth}
        \includegraphics[width=\textwidth]{alpha-re.pdf}
        \subcaption{}
    \end{subfigure}
    \begin{subfigure}{0.45\textwidth}
        \includegraphics[width=\textwidth]{alpha-im.pdf}
        \subcaption{}
    \end{subfigure}
    \caption{The real and the imaginary part of $\alpha(\omega)$. The lines are plotted by definition, and the scattered points are obtained by K-K relations. (a) The real part. (b) The imaginary part.}
    \label{fig:plot}
\end{figure}

\paragraph{Problem 1} Consider a one dimensional infinite chain on the $z$ direction consisting of metallic balls, 
each of which have radius $a$ and is made of a metal with permittivity
\begin{equation}
    \epsilon_\text{r} = 1 - \frac{\omega_\text{p}^2}{\omega (\omega + \ii \gamma)}.
\end{equation} 
When $a \to 0$, we have
\begin{equation}
    \alpha(\omega) = 4 \pi \epsilon_0 a^3 \frac{\epsilon_\text{r}(\omega) - 1}{\epsilon_\text{r}(\omega) + 2},
\end{equation}
We use Mathematica to plot the real and the imaginary part of $\alpha(\omega)$ and recalculate them with 
K-K relations 
\begin{equation}
    \Re \alpha(\omega) = - \frac{1}{\pi} \primevalue \int_{-\infty}^\infty \frac{\Im \alpha(\nu)}{\omega - \nu} \dd{\nu}, \quad \Im \alpha(\omega) = \frac{1}{\pi} \primevalue \int_{-\infty}^\infty \frac{\Re \alpha(\nu)}{\omega - \nu} \dd{\nu}
    \label{eq:kk-relation}
\end{equation}
in \prettyref{fig:plot}. It can be found that K-K relations do hold for $\alpha$. 

\begin{note*}{Numerical details of K-K relations}
    The prime value integral is implemented using the replacement 
    \[
        \primevalue \int_{-\infty}^\infty \longrightarrow \int_{-\infty}^{\omega - o} + \int_{\omega+o}^\infty,
    \]
    where $o$ is a small number.
\end{note*}

Qualitatively, the behavior 
of $\alpha(\omega)$ is just like the behavior of the response of a driven damped oscillator, where the imaginary 
part diverges when $\epsilon_\text{r}(\omega) + 2 = 0$, or considering that $\gamma$ is small, when 
\begin{equation}
    \omega = \sqrt{\frac{1}{3}} \omega_\text{p} = \SI{3.56}{eV}.
\end{equation}
When the driving frequency is larger than $\omega_\text{p} / \sqrt{3}$, the real part of $\alpha$ is positive, 
which means the system is able to ``keep in track with'' the driving field. When $\omega > \omega_\text{p}$,
$\Re \alpha < 0$, which means that the system is too slow to response ``in time'' to the driving field and 
therefore has an opposite phase to the driving field.

\paragraph{}

\paragraph{Problem 2} We need to solve 
\begin{equation}
    \vb*{p}_m = \alpha (\vb*{E}_\text{ext}(\vb*{r}_m) + \omega^2 \mu_0 \sum_{n \neq m} \tensor{\vb*{G}}(\vb*{r}_m - \vb*{r}_n) \cdot \vb*{p}_n),
    \label{eq:p-ext}
\end{equation}
and when there is no external field, by the Bloch condition 
\begin{equation}
    \vb*{p}_m = \vb*{u} \ee^{\ii k z_m},
\end{equation}
we have 
\[
    \vb*{u} \ee^{\ii k z_m} = \alpha \omega^2 \mu_0 \sum_{n \neq m} \tensor{\vb*{G}}(\vb*{r}_m - \vb*{r}_n) \cdot \vb*{u} \ee^{\ii k z_n},
\]
\[
    \left( \tensor{\vb*{I}} - \alpha \omega^2 \mu_0 \sum_{n \neq m} \tensor{\vb*{G}}(\vb*{r}_m - \vb*{r}_n) \ee^{\ii k z_n} \ee^{- \ii k z_m}  \right) \vb*{u}  = 0,
\]
and we have 
\begin{equation}
    \tensor{\vb*{M}} = \alpha^{-1} \tensor{ \vb*{I}} - \omega^2 \mu_0 \sum_{n \neq m} \tensor{\vb*{G}}(\vb*{r}_m - \vb*{r}_n) \ee^{\ii k (z_n - z_m)}, \quad \tensor{\vb*{M}} \vb*{u} = 0,
    \label{eq:eigen-problem}
\end{equation}
and we need to evaluate 
\begin{equation}
    \tensor{\vb*{W}} = \omega^2 \mu_0 \sum_{n \neq m} \tensor{\vb*{G}}(\vb*{r}_m - \vb*{r}_n) \ee^{\ii k (z_n - z_m)}.
    \label{eq:def-w}
\end{equation}

The dyadic Green function is 
\begin{equation}
    \tensor{G}(\vb*{R}) = \frac{k_0}{4\pi} \frac{\ee^{\ii k_0 R}}{k_0 R} \Biggl( \tensor{I} \left( 1 - \frac{4\pi R}{3k_0^2} \delta(\vb*{R}) - \frac{1}{k_0^2 R^2} + \frac{\ii}{k_0 R} \right) 
        + \frac{\vb*{R} \vb*{R}}{R^2} \left( \frac{3}{k_0^2 R^2} - 1 - \frac{3\ii}{k_0 R} \right) \Biggr).
\end{equation}
Since $\vb*{R} = \vb*{r}_m - \vb*{r}_n \neq 0$, the $\delta$-function term vanishes. Since $\vb*{r}_m - \vb*{r}_n$
is along the $z$ axis, We have 
\[
    \frac{\vb*{R} \vb*{R}}{R^2} = \vb*{e}_z \vb*{e}_z, \quad R = \abs*{z_m - z_n}.
\]
Therefore, by the definition \eqref{eq:def-w}, we have 
\[
    \begin{aligned}
        \tensor{\vb*{W}} &= \omega^2 \mu_0 \sum_{m \neq n} \ee^{\ii k(z_n - z_m)} \frac{k_0}{4\pi} \ee^{\ii k_0 R}
        \Biggl( \tensor{\vb*{I}} \left( \frac{1}{k_0 R} + \frac{\ii}{k_0^2 R^2} - \frac{1}{k_0^3 R^3} \right) \\
        &\quad \quad + \vb*{e}_z \vb*{e}_z \left( - \frac{1}{k_0 R} - \frac{3 \ii}{k_0^2 R^2} + \frac{3}{k_0^3 R^3} \right) \Biggr) \\
        &= \omega^2 \mu_0 \frac{k_0}{4\pi} \left( \sum_{z_m < z_n} + \sum_{z_m > z_n} \right) \ee^{\ii k_0 R - \ii k (z_m - z_n)} \Biggl( \tensor{\vb*{I}} \left( \frac{1}{k_0 R} + \frac{\ii}{k_0^2 R^2} - \frac{1}{k_0^3 R^3} \right) \\
        &\quad \quad + \vb*{e}_z \vb*{e}_z \left( - \frac{1}{k_0 R} - \frac{3 \ii}{k_0^2 R^2} + \frac{3}{k_0^3 R^3} \right) \Biggr) \\ 
        &= \omega^2 \mu_0 \frac{k_0}{4\pi} \left( \sum_{l=1}^\infty \ee^{\ii (k_0 - k) \Lambda l} + \sum_{l=1}^\infty \ee^{\ii (k_0 + k) \Lambda l} \right) \Biggl( \tensor{\vb*{I}} \left( \frac{1}{k_0 \Lambda l} + \frac{\ii}{k_0^2 \Lambda^2 l^2} - \frac{1}{k_0^3 \Lambda^3 l^3} \right) \\
        &\quad \quad + \vb*{e}_z \vb*{e}_z \left( - \frac{1}{k_0 \Lambda l} - \frac{3 \ii}{k_0^2 \Lambda^2 l^2} + \frac{3}{k_0^3 \Lambda^3 l^3} \right) \Biggr) .
    \end{aligned}
\] 
Using formulae from \href{https://en.wikipedia.org/wiki/Polylogarithm}{Wikipedia}, we have 
\[
    \left( \sum_{l=1}^\infty \ee^{\ii (k_0 - k) \Lambda l} + \sum_{l=1}^\infty \ee^{\ii (k_0 + k) \Lambda l} \right) \frac{1}{l^s} = \li_s(\ee^{\ii (k_0 - k) \Lambda}) + \li_s(\ee^{\ii (k_0 + k) \Lambda}),
\]
So finally we have 
\begin{equation}
    \begin{aligned}
        \tensor{\vb*{W}} &= \frac{\omega^2 \mu_0 k_0}{4 \pi} \biggl(
        \frac{1}{k_0 \Lambda} (\tensor{\vb*{I}} - \vb*{e}_e \vb*{e}_z) (\li_1(\ee^{\ii (k_0 - k) \Lambda}) + \li_1(\ee^{\ii (k_0 + k) \Lambda})) \\
        &\quad \quad + \frac{\ii}{k_0^2 \Lambda^2} (\tensor{\vb*{I}} - 3 \vb*{e}_z \vb*{e}_z) (\li_2(\ee^{\ii (k_0 - k) \Lambda}) + \li_2(\ee^{\ii (k_0 + k) \Lambda})) \\
        &\quad \quad - \frac{1}{k_0^3 \Lambda^3} (\tensor{\vb*{I}} - 3 \vb*{e}_z \vb*{e}_z) (\li_3(\ee^{\ii (k_0 - k) \Lambda}) + \li_3(\ee^{\ii (k_0 + k) \Lambda})).
        \biggr)
    \end{aligned}
    \label{eq:w-explicit}
\end{equation}

\paragraph{}

\paragraph{Problem 3} When the system is in a single mode, we have $\vb*{p}_m = \alpha_\text{eff} 
\vb*{E}_\text{eig}$, and from \eqref{eq:p-ext} we have 
\[
    \alpha^{-1} \vb*{p}_m = \alpha_\text{eig}^{-1} \vb*{p}_m + \omega^2 \mu_0 \sum_{n \neq m} \tensor{\vb*{G}}(\vb*{r}_m - \vb*{r}_n) \cdot \vb*{p}_n,
\]
and we find it is equivalent to 
\begin{equation}
    \tensor{\vb*{M}} \cdot \ \vb*{u} = \frac{1}{\alpha_\text{eff}} \vb*{u} = \lambda \vb*{u}.
    \label{eq:external-eigen}
\end{equation}
The eigenvalues are inverse effective polarizabilities. \eqref{eq:external-eigen} is equivalent to 
\[
    \alpha^{-1} \vb*{u} \ - \tensor{\vb*{W}} \cdot \ \vb*{u} = \alpha_\text{eig}^{-1} \vb*{u},
\]
and we known that $\tensor{\vb*{W}}$ is diagonal in the $\vb*{e}_x, \vb*{e}_y, \vb*{e}_z$ basis, so the
eigenvectors are just $\vb*{e}_x, \vb*{e}_y, \vb*{e}_z$, and it is straightforward to find that the 
polarizabilities on the $x$ and $y$ directions are the same: 
\begin{equation}
    \begin{aligned}
        \alpha_\text{eig,$xy$}^{-1} &= \alpha^{-1} - \frac{\omega^2 \mu_0 k_0}{4 \pi} \biggl( \frac{1}{k_0 \Lambda} (\li_1(\ee^{\ii (k_0 - k) \Lambda}) + \li_1(\ee^{\ii (k_0 + k) \Lambda})) \\
        &\quad \quad + \frac{\ii}{k_0^2 \Lambda^2} (\li_2(\ee^{\ii (k_0 - k) \Lambda}) + \li_2(\ee^{\ii (k_0 + k) \Lambda})) - \frac{1}{k_0^3 \Lambda^3} (\li_3(\ee^{\ii (k_0 - k) \Lambda}) + \li_3(\ee^{\ii (k_0 + k) \Lambda})) \biggr),
    \end{aligned}
    \label{eq:alpha-xy}
\end{equation}
and the polarizability on the $z$ direction is 
\begin{equation}
    \begin{aligned}
        \alpha_\text{eig,$z$}^{-1} &= \alpha^{-1} - \frac{\omega^2 \mu_0 k_0}{4 \pi} \biggl( - \frac{2\ii}{k_0^2 \Lambda^2} (\li_2(\ee^{\ii (k_0 - k) \Lambda}) + \li_2(\ee^{\ii (k_0 + k) \Lambda})) \\
        &\quad \quad  + \frac{2}{k_0^3 \Lambda^3} (\li_3(\ee^{\ii (k_0 - k) \Lambda}) + \li_3(\ee^{\ii (k_0 + k) \Lambda})) \biggr).
    \end{aligned}
    \label{eq:alpha-z}
\end{equation}

Plotting \eqref{eq:alpha-xy} and \eqref{eq:alpha-z} on the complex plane, we get \prettyref{fig:complex-plane}.
It can be found that between \SI{3}{eV} and \SI{4}{eV} $\Im \alpha$ is considerably large, indicating that 
there is a band of an eigenmode in this frequency range. We also see two V-shaped blank regions in the plots,
which means there are singularities along two $\omega=ak$ lines. These singularity lines come from the fact 
that 
If we plot 

\begin{figure}
    \centering
    \begin{subfigure}{0.45\textwidth}
        \includegraphics[width=\textwidth]{alphaxy-complex-plane.pdf}
        \subcaption{$\alpha_{xy}$}
    \end{subfigure}
    \begin{subfigure}{0.45\textwidth}
        \includegraphics[width=\textwidth]{alphaz-complex-plane.pdf}
        \subcaption{$\alpha_{z}$}
    \end{subfigure}
    \caption{$\alpha_{xy}(\omega)$ and $\alpha_z(\omega)$ on the complex plane. }
    \label{fig:complex-plane}
\end{figure} 

\paragraph{}

\paragraph{Problem 4} In the $c \to \infty$ limit, $k_0 \to 0$, so all $1 / (k_0 \Lambda)^s$ terms in \eqref{eq:w-explicit} diverges,
and only the most divergent terms where $s=3$ are important, i.e. we only keep the near field terms 
in $\tensor{\vb*{G}}$, and we have 
\[
    \tensor{\vb*{W}} = \omega^2 \frac{\mu_0 k_0}{4 \pi} \left( \frac{3 \vb*{e}_z \vb*{e}_z - \tensor{\vb*{I}}}{k_0^3 \Lambda^3} \right) (\li_3(\ee^{\ii k \Lambda}) + \li_3 (\ee^{- \ii k \Lambda})).
\] 
In the $\gamma \to 0$ limit, we have 
\[
    \frac{1}{\alpha} = \frac{1}{4 \pi \epsilon_0 a^3} \frac{\epsilon_\text{r} + 2}{\epsilon_\text{r} - 1}
    = \frac{1}{4 \pi \epsilon_0 a^3} \frac{\omega_\text{p}^2 - 3 \omega^2}{\omega_\text{p}^2}. 
\]
So $\tensor{\vb*{W}} \cdot \ \vb*{u} = \vb*{u} / \alpha$ can be written as
\[
    \frac{1}{\alpha} = \frac{1}{4 \pi \epsilon_0 a^3} \frac{\omega_\text{p}^2 - 3 \omega^2}{\omega_\text{p}^2} \vb*{u} = \underbrace{\omega^2 \frac{\mu_0 }{4 \pi} \frac{1}{k_0^2}}_{= \frac{\mu_0 c^2}{4\pi} = \frac{1}{4 \pi \epsilon_0}} \left( \frac{3 \vb*{e}_z \vb*{e}_z - \tensor{\vb*{I}}}{ \Lambda^3} \right) (\li_3(\ee^{\ii k \Lambda}) + \li_3 (\ee^{- \ii k \Lambda})) \vb*{u},
\]
and finally  
\begin{equation}
    \tensor{\vb*{H}} \cdot \ \vb*{u} = \frac{\omega^2}{\omega_\text{p}^2} \vb*{u},
\end{equation}
where 
\begin{equation}
    \tensor{\vb*{H}} = \frac{1}{3} \left(1 - \frac{a^3}{\Lambda^3} (3 \vb*{e}_z \vb*{e}_z - \tensor{\vb*{I}}) (\li_3(\ee^{\ii k \Lambda}) + \li_3 (\ee^{- \ii k \Lambda})) \right) .
    \label{eq:eff-ham}
\end{equation}
By definition we know that $(\li_3(\ee^{\ii k \Lambda}) + \li_3 (\ee^{- \ii k \Lambda}))$ is a real number, so 
\eqref{eq:eff-ham} is a Hermitian matrix, and therefore qualifies as a Hamiltonian. Again, we find that 
$\tensor{\vb*{H}}$'s eigenvectors are $\vb*{e}_x$, $\vb*{e}_y$ and $\vb*{e}_z$ (the same as Problem 3), and the eigenvalues are 
\begin{equation}
    \frac{\omega_{xy}^2}{\omega_\text{p}^2} = \frac{1}{3} \left( 1 + \frac{a^3}{\Lambda^3} (\li_3(\ee^{\ii k \Lambda}) + \li_3 (\ee^{- \ii k \Lambda})) \right) ,
    \label{eq:omega-xy}
\end{equation}
and 
\begin{equation}
    \frac{\omega_{z}^2}{\omega_\text{p}^2} = \frac{1}{3} \left( 1 - \frac{2a^3}{\Lambda^3} (\li_3(\ee^{\ii k \Lambda}) + \li_3 (\ee^{- \ii k \Lambda})) \right) .
    \label{eq:omega-z}
\end{equation}
These dispersion relations are plotted as \prettyref{fig:omega}. 

\begin{figure}
    \centering
    \begin{subfigure}{0.45\textwidth}
        \includegraphics[width=\textwidth]{omegaxy.pdf}
        \subcaption{$\omega_{xy}$}
    \end{subfigure}
    \begin{subfigure}{0.45\textwidth}
        \includegraphics[width=\textwidth]{omegaz.pdf}
        \subcaption{$\omega_z$}
    \end{subfigure}
    \caption{Dispersion relations \eqref{eq:omega-xy} and \eqref{eq:omega-z}.}
    \label{fig:omega}
\end{figure}

Plotting the dispersion relations and the singularity points into \prettyref{fig:complex-plane}, we get 
\prettyref{fig:all}.

\begin{figure}
    \centering
    \begin{subfigure}{0.45\textwidth}
        \includegraphics[width=\textwidth]{alphaxy-annotated.pdf}
        \subcaption{$\alpha_{xy}$}
    \end{subfigure}
    \begin{subfigure}{0.45\textwidth}
        \includegraphics[width=\textwidth]{alphaz-annotated.pdf}
        \subcaption{$\alpha_z$}
    \end{subfigure}
    \caption{$\Im \alpha$ on the complex plane, with the dispersion relations obtained from the 
    quasi-stationary approximation and the singularity points annotated.}
    \label{fig:all}
\end{figure}

\end{document}